/*! Rappid v3.4.1 - HTML5 Diagramming Framework - TRIAL VERSION

Copyright (c) 2021 client IO

 2021-11-18 


This Source Code Form is subject to the terms of the Rappid Trial License
, v. 2.0. If a copy of the Rappid License was not distributed with this
file, You can obtain one at http://jointjs.com/license/rappid_v2.txt
 or from the Rappid archive as was distributed by client IO. See the LICENSE file.*/


!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jointjs"),require("hot-formula-parser"),require("jszip")):"function"==typeof define&&define.amd?define(["exports","jointjs","hot-formula-parser","jszip"],t):t(((e=e||self).joint=e.joint||{},e.joint.format=e.joint.format||{},e.joint.format.Visio=e.joint.format.Visio||{}),e.joint,e.formulaParser,e.JSZip)}(this,function(e,Ce,t,l){"use strict";l=l&&l.hasOwnProperty("default")?l.default:l;var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(e,t){return e(t={exports:{}},t.exports),t.exports}function i(e){return e&&e.Math==Math&&e}function v(e){try{return!!e()}catch(e){return!0}}function M(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}function a(e){return y.call(e).slice(8,-1)}function h(e){if(null==e)throw TypeError("Can't call method on "+e);return e}function u(e){return b(h(e))}function I(e){return"object"==typeof e?null!==e:"function"==typeof e}function c(e,t){if(!I(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!I(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!I(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!I(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}function f(e,t){return S.call(e,t)}function o(e){return k?C.createElement(e):{}}function _(e){if(!I(e))throw TypeError(String(e)+" is not an object");return e}function p(t,n){try{F(R,t,n)}catch(e){R[t]=n}return n}var R=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof n&&n)||function(){return this}()||Function("return this")(),V=!v(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),s={}.propertyIsEnumerable,g=Object.getOwnPropertyDescriptor,d={f:g&&!s.call({1:2},1)?function(e){var t=g(this,e);return!!t&&t.enumerable}:s},y={}.toString,m="".split,b=v(function(){return!Object("z").propertyIsEnumerable(0)})?function(e){return"String"==a(e)?m.call(e,""):Object(e)}:Object,S={}.hasOwnProperty,C=R.document,k=I(C)&&I(C.createElement),x=!V&&!v(function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}),w=Object.getOwnPropertyDescriptor,E={f:V?w:function(e,t){if(e=u(e),t=c(t,!0),x)try{return w(e,t)}catch(e){}if(f(e,t))return M(!d.f.call(e,t),e[t])}},P=Object.defineProperty,D={f:V?P:function(e,t,n){if(_(e),t=c(t,!0),_(n),x)try{return P(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},F=V?function(e,t,n){return D.f(e,t,M(1,n))}:function(e,t,n){return e[t]=n,e},T="__core-js_shared__",A=R[T]||p(T,{}),L=Function.toString;"function"!=typeof A.inspectSource&&(A.inspectSource=function(e){return L.call(e)});function O(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++W+H).toString(36)}function N(e){return J[e]||(J[e]=O(e))}var B,G,X,j=A.inspectSource,z=R.WeakMap,Y="function"==typeof z&&/native code/.test(j(z)),U=r(function(e){(e.exports=function(e,t){return A[e]||(A[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.8.3",mode:"global",copyright:"\xa9 2021 Denis Pushkarev (zloirock.ru)"})}),W=0,H=Math.random(),J=U("keys"),q={},K=R.WeakMap;if(Y){var Q=A.state||(A.state=new K),Z=Q.get,$=Q.has,ee=Q.set;B=function(e,t){return t.facade=e,ee.call(Q,e,t),t},G=function(e){return Z.call(Q,e)||{}},X=function(e){return $.call(Q,e)}}else{var te=N("state");q[te]=!0,B=function(e,t){return t.facade=e,F(e,te,t),t},G=function(e){return f(e,te)?e[te]:{}},X=function(e){return f(e,te)}}function ne(e){return"function"==typeof e?e:void 0}function re(e,t){return arguments.length<2?ne(xe[e])||ne(R[e]):xe[e]&&xe[e][t]||R[e]&&R[e][t]}function ie(e){return isNaN(e=+e)?0:(0<e?Pe:we)(e)}function ae(e){return 0<e?_e(ie(e),9007199254740991):0}function oe(e,t){var n=ie(e);return n<0?Te(n+t,0):Ae(n,t)}function se(s){return function(e,t,n){var r,i=u(e),a=ae(i.length),o=oe(n,a);if(s&&t!=t){for(;o<a;)if((r=i[o++])!=r)return!0}else for(;o<a;o++)if((s||o in i)&&i[o]===t)return s||o||0;return!s&&-1}}function le(e,t){var n,r=u(e),i=0,a=[];for(n in r)!f(q,n)&&f(r,n)&&a.push(n);for(;t.length>i;)f(r,n=t[i++])&&(~Me(a,n)||a.push(n));return a}function ue(e,t){for(var n=De(t),r=D.f,i=E.f,a=0;a<n.length;a++){var o=n[a];f(e,o)||r(e,o,i(t,o))}}function ce(e,t){var n=Ne[Oe(e)];return n==Ge||n!=Be&&("function"==typeof t?v(t):!!t)}function he(e,t){var n,r,i,a,o,s=e.target,l=e.global,u=e.stat;if(n=l?R:u?R[s]||p(s,{}):(R[s]||{}).prototype)for(r in t){if(a=t[r],i=e.noTargetGet?(o=je(n,r))&&o.value:n[r],!Xe(l?r:s+(u?".":"#")+r,e.forced)&&void 0!==i){if(typeof a==typeof i)continue;ue(a,i)}(e.sham||i&&i.sham)&&F(a,"sham",!0),ke(n,r,a,e)}}function fe(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}function pe(r,i,e){if(fe(r),void 0===i)return r;switch(e){case 0:return function(){return r.call(i)};case 1:return function(e){return r.call(i,e)};case 2:return function(e,t){return r.call(i,e,t)};case 3:return function(e,t,n){return r.call(i,e,t,n)}}return function(){return r.apply(i,arguments)}}function ge(e){return Object(h(e))}function de(e){return f(We,e)||(Ye&&f(He,e)?We[e]=He[e]:We[e]=Je("Symbol."+e)),We[e]}function ve(e,t){var n;return ze(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!ze(n.prototype)?I(n)&&null===(n=n[qe])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}function ye(p){var g=1==p,d=2==p,v=3==p,y=4==p,m=6==p,S=7==p,C=5==p||m;return function(e,t,n,r){for(var i,a,o=ge(e),s=b(o),l=pe(t,n,3),u=ae(s.length),c=0,h=r||ve,f=g?h(e,u):d||S?h(e,0):void 0;c<u;c++)if((C||c in s)&&(a=l(i=s[c],c,o),p))if(g)f[c]=a;else if(a)switch(p){case 3:return!0;case 5:return i;case 6:return c;case 2:Ke.call(f,i)}else switch(p){case 4:return!1;case 7:Ke.call(f,i)}return m?-1:v||y?y:f}}var me,Se,be={set:B,get:G,has:X,enforce:function(e){return X(e)?G(e):B(e,{})},getterFor:function(n){return function(e){var t;if(!I(e)||(t=G(e)).type!==n)throw TypeError("Incompatible receiver, "+n+" required");return t}}},ke=r(function(e){var t=be.get,l=be.enforce,u=String(String).split("String");(e.exports=function(e,t,n,r){var i,a=!!r&&!!r.unsafe,o=!!r&&!!r.enumerable,s=!!r&&!!r.noTargetGet;"function"==typeof n&&("string"!=typeof t||f(n,"name")||F(n,"name",t),(i=l(n)).source||(i.source=u.join("string"==typeof t?t:""))),e!==R?(a?!s&&e[t]&&(o=!0):delete e[t],o?e[t]=n:F(e,t,n)):o?e[t]=n:p(t,n)})(Function.prototype,"toString",function(){return"function"==typeof this&&t(this).source||j(this)})}),xe=R,we=Math.ceil,Pe=Math.floor,_e=Math.min,Te=Math.max,Ae=Math.min,Le={includes:se(!0),indexOf:se(!1)},Me=Le.indexOf,Ie=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Re=Ie.concat("length","prototype"),Ve={f:Object.getOwnPropertyNames||function(e){return le(e,Re)}},Ee={f:Object.getOwnPropertySymbols},De=re("Reflect","ownKeys")||function(e){var t=Ve.f(_(e)),n=Ee.f;return n?t.concat(n(e)):t},Fe=/#|\.prototype\./,Oe=ce.normalize=function(e){return String(e).replace(Fe,".").toLowerCase()},Ne=ce.data={},Be=ce.NATIVE="N",Ge=ce.POLYFILL="P",Xe=ce,je=E.f,ze=Array.isArray||function(e){return"Array"==a(e)},Ye=!!Object.getOwnPropertySymbols&&!v(function(){return!String(Symbol())}),Ue=Ye&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,We=U("wks"),He=R.Symbol,Je=Ue?He:He&&He.withoutSetter||O,qe=de("species"),Ke=[].push,Qe={forEach:ye(0),map:ye(1),filter:ye(2),some:ye(3),every:ye(4),find:ye(5),findIndex:ye(6),filterOut:ye(7)},Ze=re("navigator","userAgent")||"",$e=R.process,et=$e&&$e.versions,tt=et&&et.v8;tt?Se=(me=tt.split("."))[0]+me[1]:Ze&&(!(me=Ze.match(/Edge\/(\d+)/))||74<=me[1])&&(me=Ze.match(/Chrome\/(\d+)/))&&(Se=me[1]);function nt(t){return 51<=at||!v(function(){var e=[];return(e.constructor={})[ot]=function(){return{foo:1}},1!==e[t](Boolean).foo})}function rt(e){throw e}function it(e,t){if(f(lt,e))return lt[e];var n=[][e],r=!!f(t=t||{},"ACCESSORS")&&t.ACCESSORS,i=f(t,0)?t[0]:rt,a=f(t,1)?t[1]:void 0;return lt[e]=!!n&&!v(function(){if(r&&!V)return!0;var e={length:-1};r?st(e,1,{enumerable:!0,get:rt}):e[1]=1,n.call(e,i,a)})}var at=Se&&+Se,ot=de("species"),st=Object.defineProperty,lt={},ut=Qe.filter,ct=nt("filter"),ht=it("filter");he({target:"Array",proto:!0,forced:!ct||!ht},{filter:function(e,t){return ut(this,e,1<arguments.length?t:void 0)}});function ft(){}function pt(e){return"<script>"+e+"</"+St+">"}var gt,dt=Object.keys||function(e){return le(e,Ie)},vt=V?Object.defineProperties:function(e,t){_(e);for(var n,r=dt(t),i=r.length,a=0;a<i;)D.f(e,n=r[a++],t[n]);return e},yt=re("document","documentElement"),mt="prototype",St="script",Ct=N("IE_PROTO"),bt=function(){try{gt=document.domain&&new ActiveXObject("htmlfile")}catch(e){}bt=gt?function(e){e.write(pt("")),e.close();var t=e.parentWindow.Object;return e=null,t}(gt):function(){var e,t=o("iframe");return t.style.display="none",yt.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(pt("document.F=Object")),e.close(),e.F}();for(var e=Ie.length;e--;)delete bt[mt][Ie[e]];return bt()};q[Ct]=!0;var kt=Object.create||function(e,t){var n;return null!==e?(ft[mt]=_(e),n=new ft,ft[mt]=null,n[Ct]=e):n=bt(),void 0===t?n:vt(n,t)},xt=de("unscopables"),wt=Array.prototype;null==wt[xt]&&D.f(wt,xt,{configurable:!0,value:kt(null)});function Pt(e){wt[xt][e]=!0}var _t=Qe.find,Tt="find",At=!0,Lt=it(Tt);Tt in[]&&Array(1)[Tt](function(){At=!1}),he({target:"Array",proto:!0,forced:At||!Lt},{find:function(e,t){return _t(this,e,1<arguments.length?t:void 0)}}),Pt(Tt);var Mt=Qe.findIndex,It="findIndex",Rt=!0,Vt=it(It);It in[]&&Array(1)[It](function(){Rt=!1}),he({target:"Array",proto:!0,forced:Rt||!Vt},{findIndex:function(e,t){return Mt(this,e,1<arguments.length?t:void 0)}}),Pt(It);function Et(e,t){var n=[][e];return!!n&&v(function(){n.call(null,t||function(){throw 1},1)})}var Dt=Qe.forEach,Ft=Et("forEach"),Ot=it("forEach"),Nt=Ft&&Ot?[].forEach:function(e,t){return Dt(this,e,1<arguments.length?t:void 0)};he({target:"Array",proto:!0,forced:[].forEach!=Nt},{forEach:Nt});var Bt=Le.includes,Gt=it("indexOf",{ACCESSORS:!0,1:0});he({target:"Array",proto:!0,forced:!Gt},{includes:function(e,t){return Bt(this,e,1<arguments.length?t:void 0)}}),Pt("includes");var Xt=Qe.map,jt=nt("map"),zt=it("map");he({target:"Array",proto:!0,forced:!jt||!zt},{map:function(e,t){return Xt(this,e,1<arguments.length?t:void 0)}});var Yt=[],Ut=Yt.sort,Wt=v(function(){Yt.sort(void 0)}),Ht=v(function(){Yt.sort(null)}),Jt=Et("sort");he({target:"Array",proto:!0,forced:Wt||!Ht||!Jt},{sort:function(e){return void 0===e?Ut.call(ge(this)):Ut.call(ge(this),fe(e))}});function qt(e,t,n){var r=c(t);r in e?D.f(e,r,M(0,n)):e[r]=n}var Kt=nt("splice"),Qt=it("splice",{ACCESSORS:!0,0:0,1:2}),Zt=Math.max,$t=Math.min;he({target:"Array",proto:!0,forced:!Kt||!Qt},{splice:function(e,t){var n,r,i,a,o,s,l=ge(this),u=ae(l.length),c=oe(e,u),h=arguments.length;if(0===h?n=r=0:r=1===h?(n=0,u-c):(n=h-2,$t(Zt(ie(t),0),u-c)),9007199254740991<u+n-r)throw TypeError("Maximum allowed length exceeded");for(i=ve(l,r),a=0;a<r;a++)(o=c+a)in l&&qt(i,a,l[o]);if(n<(i.length=r)){for(a=c;a<u-r;a++)s=a+n,(o=a+r)in l?l[s]=l[o]:delete l[s];for(a=u;u-r+n<a;a--)delete l[a-1]}else if(r<n)for(a=u-r;c<a;a--)s=a+n-1,(o=a+r-1)in l?l[s]=l[o]:delete l[s];for(a=0;a<n;a++)l[a+c]=arguments[a+2];return l.length=u-r+n,i}});var en=Date.prototype,tn="Invalid Date",nn="toString",rn=en[nn],an=en.getTime;new Date(NaN)+""!=tn&&ke(en,nn,function(){var e=an.call(this);return e==e?rn.call(this):tn});var on=D.f,sn=Function.prototype,ln=sn.toString,un=/^\s*function ([^ (]*)/;!V||"name"in sn||on(sn,"name",{configurable:!0,get:function(){try{return ln.call(this).match(un)[1]}catch(e){return""}}});function cn(e,t,n){var r,i;return pn&&"function"==typeof(r=t.constructor)&&r!==n&&I(i=r.prototype)&&i!==n.prototype&&pn(e,i),e}function hn(n){return function(e){var t=String(h(e));return 1&n&&(t=t.replace(vn,"")),2&n&&(t=t.replace(yn,"")),t}}function fn(e){var t,n,r,i,a,o,s,l,u=c(e,!1);if("string"==typeof u&&2<u.length)if(43===(t=(u=kn(u)).charCodeAt(0))||45===t){if(88===(n=u.charCodeAt(2))||120===n)return NaN}else if(48===t){switch(u.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+u}for(o=(a=u.slice(2)).length,s=0;s<o;s++)if((l=a.charCodeAt(s))<48||i<l)return NaN;return parseInt(a,r)}return+u}var pn=Object.setPrototypeOf||("__proto__"in{}?function(){var n,r=!1,e={};try{(n=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(e,[]),r=e instanceof Array}catch(e){}return function(e,t){return _(e),function(e){if(!I(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype")}(t),r?n.call(e,t):e.__proto__=t,e}}():void 0),gn="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",dn="["+gn+"]",vn=RegExp("^"+dn+dn+"*"),yn=RegExp(dn+dn+"*$"),mn={start:hn(1),end:hn(2),trim:hn(3)},Sn=Ve.f,Cn=E.f,bn=D.f,kn=mn.trim,xn="Number",wn=R[xn],Pn=wn.prototype,_n=a(kt(Pn))==xn;if(Xe(xn,!wn(" 0o1")||!wn("0b1")||wn("+0x1"))){for(var Tn,An=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof An&&(_n?v(function(){Pn.valueOf.call(n)}):a(n)!=xn)?cn(new wn(fn(t)),n,An):fn(t)},Ln=V?Sn(wn):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),Mn=0;Ln.length>Mn;Mn++)f(wn,Tn=Ln[Mn])&&!f(An,Tn)&&bn(An,Tn,Cn(wn,Tn));(An.prototype=Pn).constructor=An,ke(R,xn,An)}var In=Math.floor;he({target:"Number",stat:!0},{isInteger:function(e){return!I(e)&&isFinite(e)&&In(e)===e}});var Rn={};Rn[de("toStringTag")]="z";var Vn="[object z]"===String(Rn),En=de("toStringTag"),Dn="Arguments"==a(function(){return arguments}()),Fn=Vn?a:function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),En))?n:Dn?a(t):"Object"==(r=a(t))&&"function"==typeof t.callee?"Arguments":r},On=Vn?{}.toString:function(){return"[object "+Fn(this)+"]"};Vn||ke(Object.prototype,"toString",On,{unsafe:!0});function Nn(){var e=_(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}var Bn="toString",Gn=RegExp.prototype,Xn=Gn[Bn],jn=v(function(){return"/a/b"!=Xn.call({source:"a",flags:"b"})}),zn=Xn.name!=Bn;(jn||zn)&&ke(RegExp.prototype,Bn,function(){var e=_(this),t=String(e.source),n=e.flags;return"/"+t+"/"+String(void 0===n&&e instanceof RegExp&&!("flags"in Gn)?Nn.call(e):n)},{unsafe:!0});function Yn(e){var t;return I(e)&&(void 0!==(t=e[Un])?!!t:"RegExp"==a(e))}var Un=de("match"),Wn=de("match");he({target:"String",proto:!0,forced:!function(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[Wn]=!1,"/./"[t](n)}catch(e){}}return!1}("includes")},{includes:function(e,t){return!!~String(h(this)).indexOf(function(e){if(Yn(e))throw TypeError("The method doesn't accept regular expressions");return e}(e),1<arguments.length?t:void 0)}});var Hn={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0};for(var Jn in Hn){var qn=R[Jn],Kn=qn&&qn.prototype;if(Kn&&Kn.forEach!==Nt)try{F(Kn,"forEach",Nt)}catch(e){Kn.forEach=Nt}}function Qn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function Zn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Qn(Object(n),!0).forEach(function(e){sr(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qn(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function $n(e){return($n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function er(){er=function(e,t){return new o(e,void 0,t)};var i=RegExp.prototype,a=new WeakMap;function o(e,t,n){var r=new RegExp(e,t);return a.set(r,n||a.get(e)),cr(r,o.prototype)}function s(n,e){var r=a.get(e);return Object.keys(r).reduce(function(e,t){return e[t]=n[r[t]],e},Object.create(null))}return lr(o,RegExp),o.prototype.exec=function(e){var t=i.exec.call(this,e);return t&&(t.groups=s(t,this)),t},o.prototype[Symbol.replace]=function(e,t){if("string"==typeof t){var n=a.get(this);return i[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,function(e,t){return"$"+n[t]}))}if("function"!=typeof t)return i[Symbol.replace].call(this,e,t);var r=this;return i[Symbol.replace].call(this,e,function(){var e=arguments;return"object"!=typeof e[e.length-1]&&(e=[].slice.call(e)).push(s(e,r)),t.apply(this,e)})},er.apply(this,arguments)}function tr(e){var t;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(t=e[Symbol.asyncIterator]),null==t&&Symbol.iterator&&(t=e[Symbol.iterator])),null==t&&(t=e["@@asyncIterator"]),null==t&&(t=e["@@iterator"]),null==t)throw new TypeError("Object is not async iterable");return t.call(e)}function nr(e,t,n,r,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function rr(s){return function(){var e=this,o=arguments;return new Promise(function(t,n){var r=s.apply(e,o);function i(e){nr(r,t,n,i,a,"next",e)}function a(e){nr(r,t,n,i,a,"throw",e)}i(void 0)})}}function ir(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ar(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function or(e,t,n){return t&&ar(e.prototype,t),n&&ar(e,n),e}function sr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lr(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cr(e,t)}function ur(e){return(ur=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cr(e,t){return(cr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function hr(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],0<=t.indexOf(n)||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function fr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pr(r){var i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=ur(r);if(i){var n=ur(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return fr(e)}(this,e)}}function gr(e,t,n){return(gr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ur(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function dr(e,t){return mr(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,i,a=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return a}(e,t)||Cr(e,t)||kr()}function vr(e){return mr(e)||Sr(e)||Cr(e)||kr()}function yr(e){return function(e){if(Array.isArray(e))return br(e)}(e)||Sr(e)||Cr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mr(e){if(Array.isArray(e))return e}function Sr(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Cr(e,t){if(e){if("string"==typeof e)return br(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?br(e,t):void 0}}function br(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function kr(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Cr(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}var wr=[].join,Pr=b!=Object,_r=Et("join",",");he({target:"Array",proto:!0,forced:Pr||!_r},{join:function(e){return wr.call(u(this),void 0===e?",":e)}});function Tr(e){if(!I(e))return!1;var t=e[Ar];return void 0!==t?!!t:ze(e)}var Ar=de("isConcatSpreadable"),Lr=9007199254740991,Mr="Maximum allowed index exceeded",Ir=51<=at||!v(function(){var e=[];return e[Ar]=!1,e.concat()[0]!==e}),Rr=nt("concat");he({target:"Array",proto:!0,forced:!Ir||!Rr},{concat:function(e){var t,n,r,i,a,o=ge(this),s=ve(o,0),l=0;for(t=-1,r=arguments.length;t<r;t++)if(Tr(a=-1===t?o:arguments[t])){if(i=ae(a.length),Lr<l+i)throw TypeError(Mr);for(n=0;n<i;n++,l++)n in a&&qt(s,l,a[n])}else{if(Lr<=l)throw TypeError(Mr);qt(s,l++,a)}return s.length=l,s}});var Vr=nt("slice"),Er=it("slice",{ACCESSORS:!0,0:0,1:2}),Dr=de("species"),Fr=[].slice,Or=Math.max;function Nr(e,t){return RegExp(e,t)}he({target:"Array",proto:!0,forced:!Vr||!Er},{slice:function(e,t){var n,r,i,a=u(this),o=ae(a.length),s=oe(e,o),l=oe(void 0===t?o:t,o);if(ze(a)&&("function"!=typeof(n=a.constructor)||n!==Array&&!ze(n.prototype)?I(n)&&null===(n=n[Dr])&&(n=void 0):n=void 0,n===Array||void 0===n))return Fr.call(a,s,l);for(r=new(void 0===n?Array:n)(Or(l-s,0)),i=0;s<l;s++,i++)s in a&&qt(r,i,a[s]);return r.length=i,r}});var Br,Gr,Xr={UNSUPPORTED_Y:v(function(){var e=Nr("a","y");return e.lastIndex=2,null!=e.exec("abcd")}),BROKEN_CARET:v(function(){var e=Nr("^r","gy");return e.lastIndex=2,null!=e.exec("str")})},jr=RegExp.prototype.exec,zr=String.prototype.replace,Yr=jr,Ur=(Br=/a/,Gr=/b*/g,jr.call(Br,"a"),jr.call(Gr,"a"),0!==Br.lastIndex||0!==Gr.lastIndex),Wr=Xr.UNSUPPORTED_Y||Xr.BROKEN_CARET,Hr=void 0!==/()??/.exec("")[1];(Ur||Hr||Wr)&&(Yr=function(e){var t,n,r,i,a=this,o=Wr&&a.sticky,s=Nn.call(a),l=a.source,u=0,c=e;return o&&(-1===(s=s.replace("y","")).indexOf("g")&&(s+="g"),c=String(e).slice(a.lastIndex),0<a.lastIndex&&(!a.multiline||a.multiline&&"\n"!==e[a.lastIndex-1])&&(l="(?: "+l+")",c=" "+c,u++),n=new RegExp("^(?:"+l+")",s)),Hr&&(n=new RegExp("^"+l+"$(?!\\s)",s)),Ur&&(t=a.lastIndex),r=jr.call(o?n:a,c),o?r?(r.input=r.input.slice(u),r[0]=r[0].slice(u),r.index=a.lastIndex,a.lastIndex+=r[0].length):a.lastIndex=0:Ur&&r&&(a.lastIndex=a.global?r.index+r[0].length:t),Hr&&r&&1<r.length&&zr.call(r[0],n,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)}),r});var Jr=Yr;he({target:"RegExp",proto:!0,forced:/./.exec!==Jr},{exec:Jr});function qr(n,e,t,r){var i=de(n),a=!v(function(){var e={};return e[i]=function(){return 7},7!=""[n](e)}),o=a&&!v(function(){var e=!1,t=/a/;return"split"===n&&((t={constructor:{}}).constructor[ei]=function(){return t},t.flags="",t[i]=/./[i]),t.exec=function(){return e=!0,null},t[i](""),!e});if(!a||!o||"replace"===n&&(!ti||!ni||ii)||"split"===n&&!ai){var s=/./[i],l=t(i,""[n],function(e,t,n,r,i){return t.exec===Jr?a&&!i?{done:!0,value:s.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}},{REPLACE_KEEPS_$0:ni,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:ii}),u=l[0],c=l[1];ke(String.prototype,n,u),ke(RegExp.prototype,i,2==e?function(e,t){return c.call(e,this,t)}:function(e){return c.call(e,this)})}r&&F(RegExp.prototype[i],"sham",!0)}function Kr(s){return function(e,t){var n,r,i=String(h(e)),a=ie(t),o=i.length;return a<0||o<=a?s?"":void 0:(n=i.charCodeAt(a))<55296||56319<n||a+1===o||(r=i.charCodeAt(a+1))<56320||57343<r?s?i.charAt(a):n:s?i.slice(a,a+2):r-56320+(n-55296<<10)+65536}}function Qr(e,t,n){return t+(n?si(e,t).length:1)}function Zr(a,o,s,l,u,e){var c=s+a.length,h=l.length,t=hi;return void 0!==u&&(u=ge(u),t=ci),ui.call(e,t,function(e,t){var n;switch(t.charAt(0)){case"$":return"$";case"&":return a;case"`":return o.slice(0,s);case"'":return o.slice(c);case"<":n=u[t.slice(1,-1)];break;default:var r=+t;if(0==r)return e;if(h<r){var i=li(r/10);return 0===i?e:i<=h?void 0===l[i-1]?t.charAt(1):l[i-1]+t.charAt(1):e}n=l[r-1]}return void 0===n?"":n})}function $r(e,t){var n=e.exec;if("function"==typeof n){var r=n.call(e,t);if("object"!=typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==a(e))throw TypeError("RegExp#exec called on incompatible receiver");return Jr.call(e,t)}var ei=de("species"),ti=!v(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),ni="$0"==="a".replace(/./,"$0"),ri=de("replace"),ii=!!/./[ri]&&""===/./[ri]("a","$0"),ai=!v(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}),oi={codeAt:Kr(!1),charAt:Kr(!0)},si=oi.charAt,li=Math.floor,ui="".replace,ci=/\$([$&'`]|\d\d?|<[^>]*>)/g,hi=/\$([$&'`]|\d\d?)/g,fi=Math.max,pi=Math.min;qr("replace",2,function(i,b,k,e){var x=e.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,w=e.REPLACE_KEEPS_$0,P=x?"$":"$0";return[function(e,t){var n=h(this),r=null==e?void 0:e[i];return void 0!==r?r.call(e,n,t):b.call(String(n),e,t)},function(e,t){if(!x&&w||"string"==typeof t&&-1===t.indexOf(P)){var n=k(b,e,this,t);if(n.done)return n.value}var r=_(e),i=String(this),a="function"==typeof t;a||(t=String(t));var o=r.global;if(o){var s=r.unicode;r.lastIndex=0}for(var l=[];;){var u=$r(r,i);if(null===u)break;if(l.push(u),!o)break;""===String(u[0])&&(r.lastIndex=Qr(i,ae(r.lastIndex),s))}for(var c,h="",f=0,p=0;p<l.length;p++){u=l[p];for(var g=String(u[0]),d=fi(pi(ie(u.index),i.length),0),v=[],y=1;y<u.length;y++)v.push(void 0===(c=u[y])?c:String(c));var m=u.groups;if(a){var S=[g].concat(v,d,i);void 0!==m&&S.push(m);var C=String(t.apply(void 0,S))}else C=Zr(g,i,d,v,m,t);f<=d&&(h+=i.slice(f,d)+C,f=d+g.length)}return h+i.slice(f)}]});function gi(e,t){var n,r=_(e).constructor;return void 0===r||null==(n=_(r)[di])?t:fe(n)}var di=de("species"),vi=[].push,yi=Math.min,mi=4294967295,Si=!v(function(){return!RegExp(mi,"y")});function Ci(e,t){var n=1<arguments.length&&void 0!==t?t:0;if("number"!=typeof e)throw"Not a number.";if(0===n)return Math.round(e);var r=Math.pow(10,n);return Math.round(e*r)/r}function bi(e,t,n,r,i){var a=4<arguments.length&&void 0!==i?i:.1;!function(e,t,n){for(var r=n.length,i=n[r-1];r<t.length+e+1;r++)n[r]=i}(e,t,n);for(var o=[],s=0;s<=1;s+=a){var l=dr(ki(s,e,t,n,r),2),u=l[0],c=l[1];isNaN(u)||isNaN(c)||o.push(Ci(u,2),Ci(c,2))}return o}function ki(e,t,n,r,i){var a,o,s,l,u=n.length,c=n[0].length;if(t<1)throw new Error("degree must be at least 1 (linear)");if(u-1<t)throw new Error("degree must be less than or equal to point count - 1");if(!i)for(i=[],a=0;a<u;a++)i[a]=1;if(r){if(r.length!==u+t+1)throw new Error("bad knot vector length")}else for(r=[],a=0;a<u+t+1;a++)r[a]=a;var h=[t,r.length-1-t],f=r[h[0]],p=r[h[1]];if((e=e*(p-f)+f)<f||p<e)throw new Error("out of bounds");for(s=h[0];s<h[1]&&!(e>=r[s]&&e<=r[s+1]);s++);var g,d=[];for(a=0;a<u;a++){for(d[a]=[],o=0;o<c;o++)d[a][o]=n[a][o]*i[a];d[a][c]=i[a]}for(l=1;l<=t+1;l++)for(a=s;s-t-1+l<a;a--)for(g=(e-r[a])/(r[a+t+1-l]-r[a]),o=0;o<c+1;o++)d[a][o]=(1-g)*d[a-1][o]+g*d[a][o];var v=[];for(a=0;a<c;a++)v[a]=d[s][a]/d[s][c];return v}qr("split",2,function(i,v,y){var m;return m="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||1<".".split(/()()/).length||"".split(/.?/).length?function(e,t){var n=String(h(this)),r=void 0===t?mi:t>>>0;if(0==r)return[];if(void 0===e)return[n];if(!Yn(e))return v.call(n,e,r);for(var i,a,o,s=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),u=0,c=new RegExp(e.source,l+"g");(i=Jr.call(c,n))&&!(u<(a=c.lastIndex)&&(s.push(n.slice(u,i.index)),1<i.length&&i.index<n.length&&vi.apply(s,i.slice(1)),o=i[0].length,u=a,s.length>=r));)c.lastIndex===i.index&&c.lastIndex++;return u===n.length?!o&&c.test("")||s.push(""):s.push(n.slice(u)),s.length>r?s.slice(0,r):s}:"0".split(void 0,0).length?function(e,t){return void 0===e&&0===t?[]:v.call(this,e,t)}:v,[function(e,t){var n=h(this),r=null==e?void 0:e[i];return void 0!==r?r.call(e,n,t):m.call(String(n),e,t)},function(e,t){var n=y(m,e,this,t,m!==v);if(n.done)return n.value;var r=_(e),i=String(this),a=gi(r,RegExp),o=r.unicode,s=(r.ignoreCase?"i":"")+(r.multiline?"m":"")+(r.unicode?"u":"")+(Si?"y":"g"),l=new a(Si?r:"^(?:"+r.source+")",s),u=void 0===t?mi:t>>>0;if(0==u)return[];if(0===i.length)return null===$r(l,i)?[i]:[];for(var c=0,h=0,f=[];h<i.length;){l.lastIndex=Si?h:0;var p,g=$r(l,Si?i:i.slice(h));if(null===g||(p=yi(ae(l.lastIndex+(Si?0:h)),i.length))===c)h=Qr(i,h,o);else{if(f.push(i.slice(c,h)),f.length===u)return f;for(var d=1;d<=g.length-1;d++)if(f.push(g[d]),f.length===u)return f;h=c=p}}return f.push(i.slice(c)),f}]},!Si);var xi={Main:"Main",Relationships:"Relationships",DrawingML:"DrawingML",Theme:"Theme"},wi={Main:"http://schemas.microsoft.com/office/visio/2012/main",Relationships:"http://schemas.openxmlformats.org/package/2006/relationships",ContentTypes:"http://schemas.openxmlformats.org/package/2006/content-types",DocumentRelationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",VisioMasterRelationship:"http://schemas.microsoft.com/visio/2010/relationships/master",DocumentImageRelationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CustomProperties:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",DocPropsVTypes:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",DrawingML:"http://schemas.openxmlformats.org/drawingml/2006/main",Theme:"http://schemas.microsoft.com/office/visio/2012/theme"},Pi={Cell:"Cell",Row:"Row",Master:"Master",Section:"Section",Shape:"Shape",ShapeText:"ShapeText",PageSheet:"PageSheet",Page:"Page",Icon:"Icon",Image:"Image",Document:"Document",StyleSheet:"StyleSheet",ForeignData:"ForeignData",DocumentSettings:"DocumentSettings",DocumentSheet:"DocumentSheet",SchemeClr:"SchemeClr",Connect:"Connect",FaceName:"FaceName"},_i={Name:"@N",Value:"@V",Units:"@U",Formula:"@F"},Ti={name:_i.Name,value:_i.Value,units:_i.Units,formula:_i.Formula},Ai={PageSheet:"PageSheet",Rel:"Rel",Icon:"Icon",Id:"@ID",UniqueId:"@UniqueID",MasterType:"@MasterType",BaseId:"@BaseID",NameU:"@NameU",IsCustomNameU:"@IsCustomNameU",Name:"@Name",IsCustomName:"@IsCustomName",Prompt:"@Prompt",Hidden:"@Hidden",IconSize:"@IconSize",AlignName:"@AlignName",MatchByName:"@MatchByName",IconUpdate:"@IconUpdate",PatternFlags:"@PatternFlags"},Li={Relationship:"Relationship",Id:"@Id",Type:"@Type",Target:"@Target"},Mi={Document:"Document",Master:"Master",Masters:"Masters",Page:"Page",Pages:"Pages",Windows:"Windows",Theme:"Theme",Image:"Image",Solutions:"Solutions",coreProperties:"coreProperties",thumbnail:"thumbnail",document:"document",customProperties:"customProperties",extendedProperties:"extendedProperties"},Ii={"http://schemas.microsoft.com/visio/2010/relationships/windows":Mi.Windows,"http://schemas.microsoft.com/visio/2010/relationships/pages":Mi.Pages,"http://schemas.microsoft.com/visio/2010/relationships/page":Mi.Page,"http://schemas.microsoft.com/visio/2010/relationships/master":Mi.Master,"http://schemas.microsoft.com/visio/2010/relationships/masters":Mi.Masters,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme":Mi.Theme,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":Mi.Image,"http://schemas.microsoft.com/visio/2010/relationships/solutions":Mi.Solutions,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties":"coreProperties","http://schemas.openxmlformats.org/package/2006/relationships/metadata/thumbnail":"thumbnail","http://schemas.microsoft.com/visio/2010/relationships/document":"document","http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties":"customProperties","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties":"extendedProperties"},Ri={Name:"@N",Id:"@IX",Row:"Row"},Vi="@N",Ei="@IX",Di={Id:"@ID",Shapes:"Shapes",Section:"Section",Cell:"Cell",Text:"Text",Connect:"Connect",Connects:"Connects",MasterShapeId:"@MasterShape",MasterId:"@Master",Type:"@Type"},Fi={Shape:"Shape"},Oi={Id:"@ID",Cell:"Cell",Row:"Row",Section:"Section",Text:"Text",Rel:"Rel",PageSheet:"PageSheet",Icon:"Icon",ForeignData:"ForeignData",Type:"@Type",xmlns:"@xmlns",xmlnsR:"@xmlns:r",xmlSpace:"@xml:space"},Ni={DocumentSettings:"DocumentSettings",Colors:"Colors",FaceNames:"FaceNames",StyleSheets:"StyleSheets",DocumentSheet:"DocumentSheet",ColorEntry:"ColorEntry",Ix:"@IX",Rgb:"@RGB"},Bi={CharacterProperties:"cp",Content:"keyValue"},Gi={Content:"keyValue"},Xi={RelId:"@r:id"},ji={AC:"AC",AD:"AD",BOOL:"BOOL",C:"C",C_D:"C_D",CM:"CM",COLOR:"COLOR",CY:"CY",D:"D",DA:"DA",DATE:"DATE",DE:"DE",DEG:"DEG",DL:"DL",DP:"DP",DT:"DT",ED:"ED",EH:"EH",EM:"EM",ES:"ES",EW:"EW",F_I:"F_I",FT:"FT",HA:"HA",IN:"IN",IN_F:"IN_F",KM:"KM",M:"M",MI:"MI",MI_F:"MI_F",MM:"MM",NM:"NM",PER:"PER",P_PT:"P_PT",PT:"PT",P:"P",PNT:"PNT",RAD:"RAD",STR:"STR",YD:"YD"},zi={A:"A",Action:"Action",Active:"Active",AddMarkup:"AddMarkup",Address:"Address",AlignBottom:"AlignBottom",AlignCenter:"AlignCenter",AlignLeft:"AlignLeft",Alignment:"Alignment",Alignment0:"Alignment0",AlignMiddle:"AlignMiddle",AlignRight:"AlignRight",AlignTop:"AlignTop",Angle:"Angle",AsianFont:"AsianFont",AutoGen:"AutoGen",AvenueSizeX:"AvenueSizeX",AvenueSizeY:"AvenueSizeY",AvoidPageBreaks:"AvoidPageBreaks",B:"B",BeginArrow:"BeginArrow",BeginArrowSize:"BeginArrowSize",BeginGroup:"BeginGroup",BeginX:"BeginX",BeginY:"BeginY",BegTrigger:"BegTrigger",BevelBottomHeight:"BevelBottomHeight",BevelBottomType:"BevelBottomType",BevelBottomWidth:"BevelBottomWidth",BevelContourColor:"BevelContourColor",BevelContourSize:"BevelContourSize",BevelDepthColor:"BevelDepthColor",BevelDepthSize:"BevelDepthSize",BevelLightingAngle:"BevelLightingAngle",BevelLightingType:"BevelLightingType",BevelMaterialType:"BevelMaterialType",BevelTopHeight:"BevelTopHeight",BevelTopType:"BevelTopType",BevelTopWidth:"BevelTopWidth",BlockSizeX:"BlockSizeX",BlockSizeY:"BlockSizeY",Blur:"Blur",BottomMargin:"BottomMargin",Brightness:"Brightness",Bullet:"Bullet",BulletFont:"BulletFont",BulletFontSize:"BulletFontSize",BulletStr:"BulletStr",ButtonFace:"ButtonFace",C:"C",Calendar:"Calendar",CanGlue:"CanGlue",Case:"Case",CenterX:"CenterX",CenterY:"CenterY",Checked:"Checked",ClippingPath:"ClippingPath",Color:"Color",ColorSchemeIndex:"ColorSchemeIndex",ColorTrans:"ColorTrans",Comment:"Comment",ComplexScriptFont:"ComplexScriptFont",ComplexScriptSize:"ComplexScriptSize",CompoundType:"CompoundType",ConFixedCode:"ConFixedCode",ConLineJumpCode:"ConLineJumpCode",ConLineJumpDirX:"ConLineJumpDirX",ConLineJumpDirY:"ConLineJumpDirY",ConLineJumpStyle:"ConLineJumpStyle",ConLineRouteExt:"ConLineRouteExt",ConnectorSchemeIndex:"ConnectorSchemeIndex",Contrast:"Contrast",Copyright:"Copyright",CtrlAsInput:"CtrlAsInput",CurrentIndex:"CurrentIndex",D:"D",DataLinked:"DataLinked",DblUnderline:"DblUnderline",Default:"Default",DefaultTabStop:"DefaultTabStop",Denoise:"Denoise",Description:"Description",DirX:"DirX",DirY:"DirY",Disabled:"Disabled",DisplayLevel:"DisplayLevel",DisplayMode:"DisplayMode",DistanceFromGround:"DistanceFromGround",DocLangID:"DocLangID",DocLockDuplicatePage:"DocLockDuplicatePage",DocLockReplace:"DocLockReplace",DontMoveChildren:"DontMoveChildren",DoubleStrikethrough:"DoubleStrikethrough",DrawingResizeType:"DrawingResizeType",DrawingScale:"DrawingScale",DrawingScaleType:"DrawingScaleType",DrawingSizeType:"DrawingSizeType",DropOnPageScale:"DropOnPageScale",DynamicsOff:"DynamicsOff",DynFeedback:"DynFeedback",E:"E",EffectSchemeIndex:"EffectSchemeIndex",EmbellishmentIndex:"EmbellishmentIndex",EnableFillProps:"EnableFillProps",EnableGrid:"EnableGrid",EnableLineProps:"EnableLineProps",EnableTextProps:"EnableTextProps",EndArrow:"EndArrow",EndArrowSize:"EndArrowSize",EndTrigger:"EndTrigger",EndX:"EndX",EndY:"EndY",EventDblClick:"EventDblClick",EventDrop:"EventDrop",EventMultiDrop:"EventMultiDrop",EventXFMod:"EventXFMod",ExtraInfo:"ExtraInfo",FillBkgnd:"FillBkgnd",FillBkgndTrans:"FillBkgndTrans",FillForegnd:"FillForegnd",FillForegndTrans:"FillForegndTrans",FillGradientAngle:"FillGradientAngle",FillGradientDir:"FillGradientDir",FillGradientEnabled:"FillGradientEnabled",FillPattern:"FillPattern",Flags:"Flags",FlipX:"FlipX",FlipY:"FlipY",FlyoutChild:"FlyoutChild",Font:"Font",FontScale:"FontScale",FontSchemeIndex:"FontSchemeIndex",Format:"Format",Frame:"Frame",Gamma:"Gamma",GlowColor:"GlowColor",GlowColorTrans:"GlowColorTrans",GlowSize:"GlowSize",Glue:"Glue",GlueType:"GlueType",GradientStopColor:"GradientStopColor",GradientStopColorTrans:"GradientStopColorTrans",GradientStopPosition:"GradientStopPosition",Height:"Height",HelpTopic:"HelpTopic",HideForApply:"HideForApply",HideText:"HideText",HorzAlign:"HorzAlign",ImgHeight:"ImgHeight",ImgOffsetX:"ImgOffsetX",ImgOffsetY:"ImgOffsetY",ImgWidth:"ImgWidth",IndFirst:"IndFirst",IndLeft:"IndLeft",IndRight:"IndRight",InhibitSnap:"InhibitSnap",Initials:"Initials",Invisible:"Invisible",IsDropSource:"IsDropSource",IsDropTarget:"IsDropTarget",IsSnapTarget:"IsSnapTarget",IsTextEditTarget:"IsTextEditTarget",KeepTextFlat:"KeepTextFlat",Label:"Label",LangID:"LangID",LayerMember:"LayerMember",LeftMargin:"LeftMargin",Letterspace:"Letterspace",LineAdjustFrom:"LineAdjustFrom",LineAdjustTo:"LineAdjustTo",LineCap:"LineCap",LineColor:"LineColor",LineColorTrans:"LineColorTrans",LineGradientAngle:"LineGradientAngle",LineGradientDir:"LineGradientDir",LineGradientEnabled:"LineGradientEnabled",LineJumpCode:"LineJumpCode",LineJumpFactorX:"LineJumpFactorX",LineJumpFactorY:"LineJumpFactorY",LineJumpStyle:"LineJumpStyle",LinePattern:"LinePattern",LineRouteExt:"LineRouteExt",LineToLineX:"LineToLineX",LineToLineY:"LineToLineY",LineToNodeX:"LineToNodeX",LineToNodeY:"LineToNodeY",LineWeight:"LineWeight",LocalizeMerge:"LocalizeMerge",Lock:"Lock",LockAspect:"LockAspect",LockBegin:"LockBegin",LockCalcWH:"LockCalcWH",LockCrop:"LockCrop",LockCustProp:"LockCustProp",LockDelete:"LockDelete",LockEnd:"LockEnd",LockFormat:"LockFormat",LockFromGroupFormat:"LockFromGroupFormat",LockGroup:"LockGroup",LockHeight:"LockHeight",LockMoveX:"LockMoveX",LockMoveY:"LockMoveY",LockPreview:"LockPreview",LockReplace:"LockReplace",LockRotate:"LockRotate",LockSelect:"LockSelect",LockTextEdit:"LockTextEdit",LockThemeColors:"LockThemeColors",LockThemeConnectors:"LockThemeConnectors",LockThemeEffects:"LockThemeEffects",LockThemeFonts:"LockThemeFonts",LockThemeIndex:"LockThemeIndex",LockVariation:"LockVariation",LockVtxEdit:"LockVtxEdit",LockWidth:"LockWidth",LocPinX:"LocPinX",LocPinY:"LocPinY",Menu:"Menu",Name:"Name",NameUniv:"NameUniv",NewWindow:"NewWindow",NoAlignBox:"NoAlignBox",NoCoauth:"NoCoauth",NoCtlHandles:"NoCtlHandles",NoFill:"NoFill",NoLine:"NoLine",NoLiveDynamics:"NoLiveDynamics",NonPrinting:"NonPrinting",NoObjHandles:"NoObjHandles",NoProofing:"NoProofing",NoQuickDrag:"NoQuickDrag",NoShow:"NoShow",NoSnap:"NoSnap",ObjectKind:"ObjectKind",ObjType:"ObjType",OnPage:"OnPage",OutputFormat:"OutputFormat",Overline:"Overline",PageBottomMargin:"PageBottomMargin",PageHeight:"PageHeight",PageLeftMargin:"PageLeftMargin",PageLineJumpDirX:"PageLineJumpDirX",PageLineJumpDirY:"PageLineJumpDirY",PageLockDuplicate:"PageLockDuplicate",PageLockReplace:"PageLockReplace",PageRightMargin:"PageRightMargin",PageScale:"PageScale",PageShapeSplit:"PageShapeSplit",PagesX:"PagesX",PagesY:"PagesY",PageTopMargin:"PageTopMargin",PageWidth:"PageWidth",PaperKind:"PaperKind",PaperSource:"PaperSource",Perspective:"Perspective",PinX:"PinX",PinY:"PinY",PlaceDepth:"PlaceDepth",PlaceFlip:"PlaceFlip",PlaceStyle:"PlaceStyle",PlowCode:"PlowCode",Pos:"Pos",Position:"Position",Position0:"Position0",PreviewQuality:"PreviewQuality",PreviewScope:"PreviewScope",Print:"Print",PrintGrid:"PrintGrid",PrintPageOrientation:"PrintPageOrientation",Prompt:"Prompt",QuickStyleEffectsMatrix:"QuickStyleEffectsMatrix",QuickStyleFillColor:"QuickStyleFillColor",QuickStyleFillMatrix:"QuickStyleFillMatrix",QuickStyleFontColor:"QuickStyleFontColor",QuickStyleFontMatrix:"QuickStyleFontMatrix",QuickStyleLineColor:"QuickStyleLineColor",QuickStyleLineMatrix:"QuickStyleLineMatrix",QuickStyleShadowColor:"QuickStyleShadowColor",QuickStyleType:"QuickStyleType",QuickStyleVariation:"QuickStyleVariation",ReadOnly:"ReadOnly",ReflectionBlur:"ReflectionBlur",ReflectionDist:"ReflectionDist",ReflectionSize:"ReflectionSize",ReflectionTrans:"ReflectionTrans",Relationships:"Relationships",ReplaceCopyCells:"ReplaceCopyCells",ReplaceLockFormat:"ReplaceLockFormat",ReplaceLockShapeData:"ReplaceLockShapeData",ReplaceLockText:"ReplaceLockText",ResizeMode:"ResizeMode",ResizePage:"ResizePage",ReviewerID:"ReviewerID",RightMargin:"RightMargin",RotateGradientWithShape:"RotateGradientWithShape",RotationType:"RotationType",RotationXAngle:"RotationXAngle",RotationYAngle:"RotationYAngle",RotationZAngle:"RotationZAngle",Rounding:"Rounding",RouteStyle:"RouteStyle",ScaleX:"ScaleX",ScaleY:"ScaleY",SelectMode:"SelectMode",ShapeFixedCode:"ShapeFixedCode",ShapeKeywords:"ShapeKeywords",ShapePermeablePlace:"ShapePermeablePlace",ShapePermeableX:"ShapePermeableX",ShapePermeableY:"ShapePermeableY",ShapePlaceFlip:"ShapePlaceFlip",ShapePlaceStyle:"ShapePlaceStyle",ShapePlowCode:"ShapePlowCode",ShapeRouteStyle:"ShapeRouteStyle",ShapeShdwBlur:"ShapeShdwBlur",ShapeShdwObliqueAngle:"ShapeShdwObliqueAngle",ShapeShdwOffsetX:"ShapeShdwOffsetX",ShapeShdwOffsetY:"ShapeShdwOffsetY",ShapeShdwScaleFactor:"ShapeShdwScaleFactor",ShapeShdwShow:"ShapeShdwShow",ShapeShdwType:"ShapeShdwType",ShapeSplit:"ShapeSplit",ShapeSplittable:"ShapeSplittable",Sharpen:"Sharpen",ShdwBkgnd:"ShdwBkgnd",ShdwBkgndTrans:"ShdwBkgndTrans",ShdwForegnd:"ShdwForegnd",ShdwForegndTrans:"ShdwForegndTrans",ShdwObliqueAngle:"ShdwObliqueAngle",ShdwOffsetX:"ShdwOffsetX",ShdwOffsetY:"ShdwOffsetY",ShdwPattern:"ShdwPattern",ShdwScaleFactor:"ShdwScaleFactor",ShdwType:"ShdwType",Size:"Size",SketchAmount:"SketchAmount",SketchEnabled:"SketchEnabled",SketchFillChange:"SketchFillChange",SketchLineChange:"SketchLineChange",SketchLineWeight:"SketchLineWeight",SketchSeed:"SketchSeed",Snap:"Snap",SoftEdgesSize:"SoftEdgesSize",SortKey:"SortKey",SpAfter:"SpAfter",SpBefore:"SpBefore",SpLine:"SpLine",Status:"Status",Strikethru:"Strikethru",Style:"Style",SubAddress:"SubAddress",TagName:"TagName",TextBkgnd:"TextBkgnd",TextBkgndTrans:"TextBkgndTrans",TextDirection:"TextDirection",TextPosAfterBullet:"TextPosAfterBullet",TheData:"TheData",ThemeIndex:"ThemeIndex",TheText:"TheText",TopMargin:"TopMargin",Transparency:"Transparency",TxtAngle:"TxtAngle",TxtHeight:"TxtHeight",TxtLocPinX:"TxtLocPinX",TxtLocPinY:"TxtLocPinY",TxtPinX:"TxtPinX",TxtPinY:"TxtPinY",TxtWidth:"TxtWidth",Type:"Type",UICat:"UICat",UICod:"UICod",UIFmt:"UIFmt",UIVisibility:"UIVisibility",UpdateAlignBox:"UpdateAlignBox",UseGroupGradient:"UseGroupGradient",Value:"Value",VariationColorIndex:"VariationColorIndex",VariationStyleIndex:"VariationStyleIndex",Verify:"Verify",VerticalAlign:"VerticalAlign",ViewMarkup:"ViewMarkup",Visible:"Visible",WalkPreference:"WalkPreference",Width:"Width",X:"X",XCon:"XCon",XDyn:"XDyn",XGridDensity:"XGridDensity",XGridOrigin:"XGridOrigin",XGridSpacing:"XGridSpacing",XJustify:"XJustify",XRulerDensity:"XRulerDensity",XRulerOrigin:"XRulerOrigin",Y:"Y",YCon:"YCon",YDyn:"YDyn",YGridDensity:"YGridDensity",YGridOrigin:"YGridOrigin",YGridSpacing:"YGridSpacing",YJustify:"YJustify",YRulerDensity:"YRulerDensity",YRulerOrigin:"YRulerOrigin"},Yi={Shape:"Shape",Group:"Group",Foreign:"Foreign",Guide:"Guide",MasterShape1:"MasterShape1",MasterShape2:"MasterShape2",Dummy:"Dummy",LinkLabel:"LinkLabel"},Ui={Actions:"Actions",ActionTag:"ActionTag",Character:"Character",Connection:"Connection",Control:"Control",Field:"Field",FillGradient:"FillGradient",Geometry:"Geometry",Hyperlink:"Hyperlink",Layer:"Layer",LineGradient:"LineGradient",Paragraph:"Paragraph",User:"User",Property:"Property",Scratch:"Scratch",Tabs:"Tabs"},Wi={Type:"@T",Name:"@N",UniqueIndex:"@IX",Deleted:"@Del"},Hi={Indexed:"Indexed",Named:"Named"},Ji={ArcTo:"ArcTo",Ellipse:"Ellipse",EllipticalArcTo:"EllipticalArcTo",InfiniteLine:"InfiniteLine",LineTo:"LineTo",MoveTo:"MoveTo",NURBSTo:"NURBSTo",PolylineTo:"PolylineTo",RelCubBezTo:"RelCubBezTo",RelEllipticalArcTo:"RelEllipticalArcTo",RelLineTo:"RelLineTo",RelMoveTo:"RelMoveTo",RelQuadBezTo:"RelQuadBezTo",SplineStart:"SplineStart",SplineKnot:"SplineKnot"},qi={ShapeSimple:"ShapeSimple",ShapeGroupItem:"ShapeGroupItem",ShapeMaster:"ShapeMaster",ShapeGroup:"ShapeGroup",ShapeForeign:"ShapeForeign",ShapeGuide:"ShapeGuide",GeneralMaster:"GeneralMaster",ShapeDeleteOverride:"ShapeDeleteOverride"},Ki={archive:"archive",xmlPath:"xmlPath",shapeId:"shapeId",source:"source",target:"target",_rel:"_rel",alignName:"alignName",baseID:"baseID",base64:"base64",background:"background",backPage:"backPage",beginX:"beginX",beginY:"beginY",cells:"cells",colors:"colors",connects:"connects",deleted:"deleted",defaultLineStyle:"defaultLineStyle",defaultTextStyle:"defaultTextStyle",defaultFillStyle:"defaultFillStyle",defaultGuideStyle:"defaultGuideStyle",documentSheet:"documentSheet",documentSettings:"documentSettings",dynamicGridEnabled:"dynamicGridEnabled",endX:"endX",endY:"endY",faceNames:"faceNames",fillStyle:"fillStyle",foreignData:"foreignData",foreignShapes:"foreignShapes",fromSheet:"fromSheet",fromCell:"fromCell",fromPart:"fromPart",glueSettings:"glueSettings",hidden:"hidden",icon:"icon",iconSize:"iconSize",iconUpdate:"iconUpdate",id:"id",index:"index",isCustomNameU:"isCustomNameU",isCustomName:"isCustomName",lineStyle:"lineStyle",master:"master",masterId:"masterId",masterShapeId:"masterShapeId",masterShape:"masterShape",masterType:"masterType",matchByName:"matchByName",name:"name",nameU:"nameU",n:"n",originalId:"originalId",pages:"pages",pageSheet:"pageSheet",patternFlags:"patternFlags",prompt:"prompt",protectStyles:"protectStyles",protectShapes:"protectShapes",protectMasters:"protectMasters",protectBkgnds:"protectBkgnds",rels:"rels",relations:"relations",relMasterShape:"relMasterShape",rows:"rows",shapes:"shapes",shape:"shape",sections:"sections",snapSettings:"snapSettings",snapExtensions:"snapExtensions",snapAngles:"snapAngles",styleSheets:"styleSheets",text:"text",textStyle:"textStyle",topPage:"topPage",toSheet:"toSheet",toCell:"toCell",toPart:"toPart",type:"type",uniqueId:"uniqueId",val:"val",viewScale:"viewScale",viewCenterX:"viewCenterX",viewCenterY:"viewCenterY",xmlns:"xmlns","xmlns:r":"xmlns:r","xml:space":"xml:space",jxon:"jxon"},Qi={ignore:"ignore",number:"number",booleanStrict:"booleanStrict",booleanTriState:"booleanTriState",color:"color",asIs:"asIs",byte:"byte",date:"date",percentage:"percentage",internalUnitsToPixels:"internalUnitsToPixels",internalUnitsToDegrees:"internalUnitsToDegrees",resolveByPath:"resolveByPath"},Zi="Section_Type",$i="Row_Type",ea="PtgNum",ta="PtgByte",na="PtgBool",ra="PtgString",ia="PtgColorRGB",aa="PtgShort",oa="PtgDate",sa="PtgInt",la="PtgUnsShort",ua="PtgNumI",ca="vLanguageString",ha="vFont",fa="vAny",pa="vAngle",ga="vScalar",da="vLength",va="vColor",ya="vFormatString",ma="formulaExpression",Sa={AccentColor:"AccentColor",AccentColor2:"AccentColor2",AccentColor3:"AccentColor3",AccentColor4:"AccentColor4",AccentColor5:"AccentColor5",AccentColor6:"AccentColor6",AsianFont:"AsianFont",BackgroundColor:"BackgroundColor",BevelTopType:"BevelTopType",BevelTopWidth:"BevelTopWidth",BevelTopHeight:"BevelTopHeight",BevelMaterial:"BevelMaterial",BevelLighting:"BevelLighting",BevelLightingAngle:"BevelLightingAngle",BevelContourColor:"BevelContourColor",BevelContourSize:"BevelContourSize",ComplexFont:"ComplexFont",ConnectorColor:"ConnectorColor",ConnectorPattern:"ConnectorPattern",ConnectorWeight:"ConnectorWeight",ConnectorTransparency:"ConnectorTransparency",ConnectorRounding:"ConnectorRounding",ConnectorBegin:"ConnectorBegin",ConnectorEnd:"ConnectorEnd",ConnectorBeginSize:"ConnectorBeginSize",ConnectorEndSize:"ConnectorEndSize",Dark:"Dark",FillColor:"FillColor",FillColor2:"FillColor2",FillGradientEnabled:"FillGradientEnabled",FillGradientDir:"FillGradientDir",FillGradientAngle:"FillGradientAngle",FillPattern:"FillPattern",FillTransparency:"FillTransparency",GlowSize:"GlowSize",GlowColor:"GlowColor",GlowTransparency:"GlowTransparency",LatinFont:"LatinFont",Light:"Light",LineCap:"LineCap",LineColor:"LineColor",LineColorTrans:"LineColorTrans",LineCompoundtype:"LineCompoundtype",LineGradientEnabled:"LineGradientEnabled",LineGradientDir:"LineGradientDir",LineGradientAngle:"LineGradientAngle",LinePattern:"LinePattern",LineWeight:"LineWeight",LineBegin:"LineBegin",LineEnd:"LineEnd",LineBeginSize:"LineBeginSize",LineEndSize:"LineEndSize",LineRounding:"LineRounding",RotateGradientWithShape:"RotateGradientWithShape",ReflectionBlur:"ReflectionBlur",ReflectionDist:"ReflectionDist",ReflectionSize:"ReflectionSize",ReflectionTrans:"ReflectionTrans",ShadowType:"ShadowType",ShadowColor:"ShadowColor",ShadowTransparency:"ShadowTransparency",ShadowMagnification:"ShadowMagnification",ShadowBlur:"ShadowBlur",ShadowXOffset:"ShadowXOffset",ShadowYOffset:"ShadowYOffset",ShadowDirection:"ShadowDirection",ShadowPattern:"ShadowPattern",SoftEdgesSize:"SoftEdgesSize",SketchAmount:"SketchAmount",SketchEnabled:"SketchEnabled",SketchFillChange:"SketchFillChange",SketchLineChange:"SketchLineChange",SketchLineWeight:"SketchLineWeight",TextColor:"TextColor",TextStyle:"TextStyle",UseGroupGradient:"UseGroupGradient",VariantColor1:"VariantColor1",VariantColor2:"VariantColor2",VariantColor3:"VariantColor3",VariantColor4:"VariantColor4",VariantColor5:"VariantColor5",VariantColor6:"VariantColor6",VariantColor7:"VariantColor7"},Ca={Actions:Hi.Named,Character:Hi.Indexed,Connection:Hi.Indexed,Control:Hi.Named,Field:Hi.Indexed,FillGradient:Hi.Indexed,Geometry:Hi.Indexed,Hyperlink:Hi.Named,Layer:Hi.Indexed,LineGradient:Hi.Indexed,Paragraph:Hi.Indexed,Property:Hi.Named,Reviewer:Hi.Indexed,Scratch:Hi.Indexed,ActionTag:Hi.Named,Tabs:Hi.Indexed,User:Hi.Named};he({target:"Number",stat:!0},{isNaN:function(e){return e!=e}});var ba=mn.trim,ka=R.parseFloat,xa=1/ka(gn+"-0")!=-1/0?function(e){var t=ba(String(e)),n=ka(t);return 0===n&&"-"==t.charAt(0)?-0:n}:ka;he({target:"Number",stat:!0,forced:Number.parseFloat!=xa},{parseFloat:xa});var wa={CONSOLE:1,TOOLTIPS:4,TEXT_FRAMES:4,level:0,log:function(){var e;wa.level&wa.CONSOLE&&(e=console).log.apply(e,arguments)}};var Pa=v(function(){dt(1)});function _a(e){"string"!=typeof e&&wa.log("Value to convert is not a string.",e)}function Ta(e){return _a(e),Number(e)}function Aa(e){return _a(e),Number(e)}function La(e,t){var n=(1<arguments.length&&void 0!==t?t:{}).triState;return(void 0===n||n)&&void 0===e?(wa.log("boolean as a null"),null):Ma(e)}function Ma(e){return"0"!==e&&"1"!==e&&wa.log("Can't convert string to boolean",e),"1"===e}function Ia(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:ji.IN;switch(void 0!==e&&t||wa.log("Value and target unit type are required to convert to a pixel value."),t){case ji.IN:case ji.IN_F:case ji.DL:case ji.DP:return Ra(e);case ji.MM:return Va(e);case ji.CM:return function(e){return Va(10*e)}(e);case ji.DT:case ji.PT:return function(e){return Ra(e/72)}(e);default:return wa.log('Unsupported numeric unit type "'.concat(Fa(t),'" ("').concat(t,'")')),e}}function Ra(e){return 96*e}function Va(e){return 3.7795275591*e}function Ea(e){return e/3.7795275591}function Da(e){return e/96}function Fa(e){var t;if(!ji.hasOwnProperty(e))throw'Unknown unit type "'.concat(e,'".');return(sr(t={},ji.AC,"Acres"),sr(t,ji.DEG,"Degrees"),sr(t,ji.DA,"Radians"),sr(t,ji.AD,"Degrees-minutes-seconds"),sr(t,ji.RAD,"Radians"),sr(t,ji.BOOL,"Boolean"),sr(t,ji.COLOR,"RGB color value"),sr(t,ji.CY,"Currency"),sr(t,ji.DATE,"Days"),sr(t,ji.ED,"Days"),sr(t,ji.EH,"Hours"),sr(t,ji.EM,"Minutes"),sr(t,ji.ES,"Seconds"),sr(t,ji.EW,"Weeks"),sr(t,ji.HA,"Hectare"),sr(t,ji.CM,"Centimeters"),sr(t,ji.DL,"Inches"),sr(t,ji.FT,"Feet"),sr(t,ji.F_I,"Feet and inches"),sr(t,ji.IN,"Inches"),sr(t,ji.IN_F,"Inches"),sr(t,ji.KM,"Kilometers"),sr(t,ji.M,"Meters"),sr(t,ji.MI,"Miles"),sr(t,ji.MI_F,"Miles"),sr(t,ji.MM,"Millimeters"),sr(t,ji.NM,"Nautical miles"),sr(t,ji.PER,"Percentage"),sr(t,ji.YD,"Yards"),sr(t,ji.DP,"Inches"),sr(t,ji.PNT,"Coordinates of a two-dimensional point"),sr(t,ji.STR,"String"),sr(t,ji.DE,"Days"),sr(t,ji.C_D,"Ciceros and didots"),sr(t,ji.C,"Ciceros"),sr(t,ji.D,"Didots"),sr(t,ji.DT,"Points"),sr(t,ji.P,"Picas"),sr(t,ji.P_PT,"Picas and points"),sr(t,ji.PT,"Points"),t)[e]}he({target:"Object",stat:!0,forced:Pa},{keys:function(e){return dt(ge(e))}});var Oa=Math.sqrt,Na=Math.cos,Ba=Math.sin,Ga=Math.atan2,Xa=Math.abs,ja=0,za=0,Ya=null;function Ua(e,t,n){switch(e){case Ji.MoveTo:return Wa(t);case Ji.LineTo:return function(e){var t=e.x,n=void 0===t?ja:t,r=e.y,i=void 0===r?za:r;return za=i," L ".concat(Ci(ja=n)," ").concat(Ci(i))}(t);case Ji.ArcTo:return function(e){var t=e.x,n=e.y,r=e.a;if(0===r)return" L ".concat(t," ").concat(n);var i=za,a=Xa(t-ja),o=Xa(n-i),s=Xa(Ci(.5*r+(a*a+o*o)/(8*r),2)),l=s,u=Xa(s);t=Ci(t,2),n=Ci(n,2);var c=0<(r=Ci(r,2))?1:0,h=u<Xa(r)?1:0;return ja=t,za=n," A ".concat(s," ").concat(l," 0 ").concat(h," ").concat(c," ").concat(t," ").concat(n)}(t);case Ji.EllipticalArcTo:return Ha(t);case Ji.Ellipse:return function(e){var t=e.x,n=e.y,r=e.a,i=e.b,a=e.c,o=e.d,s=Xa(r-t),l=Xa(i-n),u=Oa(s*s+l*l),c=Xa(a-t),h=Xa(o-n),f=Oa(c*c+h*h);return" M ".concat(t-u," ").concat(n," A ").concat(u," ").concat(f," 0 1 0 ").concat(t+u," ").concat(n," A ").concat(u," ").concat(f," 0 1 0 ").concat(t-u," ").concat(n)}(t);case Ji.InfiniteLine:return function(e){var t=e.x,n=e.y,r=e.a,i=e.b;return" L ".concat(t," ").concat(n," ").concat(r," ").concat(i)}(t);case Ji.SplineStart:!function(e){var t=e.x,n=void 0===t?ja:t,r=e.y,i=void 0===r?za:r;n=Ci(n,2),i=Ci(i,2),Ya={points:[[ja,za],[n,i]],knots:[e.b,e.a,e.c],degree:e.d},ja=n,za=i}(t);break;case Ji.SplineKnot:!function(e){var t=e.x,n=void 0===t?ja:t,r=e.y,i=void 0===r?za:r,a=e.a;if(ja=n=Ci(n,2),za=i=Ci(i,2),Ya){var o=Ya,s=o.points,l=o.knots;s.push([n,i]),l.splice(l.length-1,0,a)}}(t);break;case Ji.RelMoveTo:return function(e,t){var n=t.width,r=t.height,i=e.x,a=void 0===i?ja:i,o=e.y,s=void 0===o?za:o;return za=s*=r," M ".concat(Ci(ja=a*=n)," ").concat(Ci(s))}(t,n);case Ji.RelLineTo:return function(e,t){var n=t.width,r=t.height,i=e.x,a=void 0===i?ja:i,o=e.y,s=void 0===o?za:o;return za=s*=r," L ".concat(Ci(ja=a*=n)," ").concat(Ci(s))}(t,n);case Ji.RelCubBezTo:return function(e,t){var n=t.width,r=t.height,i=e.x*n,a=e.y*r,o=e.a*n,s=e.b*r,l=e.c*n,u=e.d*r;return ja=i,za=a," C ".concat(Ci(o)," ").concat(Ci(s)," ").concat(Ci(l)," ").concat(Ci(u)," ").concat(Ci(i)," ").concat(Ci(a))}(t,n);case Ji.RelQuadBezTo:return function(e,t){var n=t.width,r=t.height,i=e.x*n,a=e.y*r,o=e.a*n,s=e.b*r;return ja=i,za=a," Q ".concat(Ci(o)," ").concat(Ci(s)," ").concat(Ci(i)," ").concat(Ci(a))}(t,n);case Ji.RelEllipticalArcTo:return function(e,t){var n=t.width,r=t.height,i=e.x,a=e.y,o=e.a,s=e.b,l=e.c,u=e.d;return Ha({x:i*n,y:a*r,a:o*n,b:s*n,c:l,d:u})}(t,n);case Ji.PolylineTo:return function(e,t){var n=e.x,r=e.y,i=e.a,a=t.width,o=t.height,s=vr(qa(i)),l=s[0],u=s[1],c=s.slice(2).map(function(e,t){return Ci(t%2==0?0===l?e*a:Ra(e):0===u?e*o:Ra(e),2)});return c.push(n,r),ja=n,za=r,"L ".concat(c.join(" "))}(t,n);case Ji.NURBSTo:return function(e,t){var n,r,i,a,o=e.x,s=e.y,l=e.a,u=e.b,c=e.c,h=e.d,f=e.e,p=t.width,g=t.height,d=[[ja,za]],v=[c],y=[h],m=vr(qa(f)),S=m[0],C=m[1],b=m[2],k=m[3],x=m.slice(4);for(;0<x.length;){var w=vr(x);n=w[0],r=w[1],i=w[2],a=w[3],x=w.slice(4),0===b?n*=p:n=Ra(n),0===k?r*=g:r=Ra(r),d.push([n,r]),v.push(i),y.push(a)}v.push(l,S),d.push([o,s]),y.push(u),ja=o,za=s;var P=bi(C,d,v,y).join(" ");return 0===P.length?"":" L ".concat(P)}(t,n)}return""}function Wa(e){var t=e.x,n=void 0===t?ja:t,r=e.y,i=void 0===r?za:r;return za=i," M ".concat(Ci(ja=n)," ").concat(Ci(i))}function Ha(e){var t=e.x,n=void 0===t?ja:t,r=e.y,i=void 0===r?za:r,a=e.a,o=void 0===a?0:a,s=e.b,l=void 0===s?0:s,u=e.c,c=void 0===u?0:u,h=e.d,f=void 0===h?0:h,p=ja,g=za,d=n,v=i,y=-c;ja=n,za=i;var m=Ce.g.toRad(y),S=Oa(p*p+g*g)*Na(Ga(g,p)-m),C=Oa(p*p+g*g)*Ba(Ga(g,p)-m),b=Oa(d*d+v*v)*Na(Ga(v,d)-m),k=Oa(d*d+v*v)*Ba(Ga(v,d)-m),x=Oa(o*o+l*l)*Na(Ga(l,o)-m),w=Oa(o*o+l*l)*Ba(Ga(l,o)-m),P=(S-b)*(k-w)-(b-x)*(C-k),_=(b-x)*(C-k)-(S-b)*(k-w);if(0==_||0==_)return" L ".concat(d," ").concat(v);var T=((S-b)*(S+b)*(k-w)-(b-x)*(b+x)*(C-k)+f*f*(C-k)*(k-w)*(C-w))/(2*P),A=((S-b)*(b-x)*(S-x)/(f*f)+(b-x)*(C-k)*(C+k)-(S-b)*(k-w)*(k+w))/(2*_),L=S-T,M=C-A,I=Oa(L*L+M*M*f*f),R=I/f,V=0<(d-p)*(l-g)-(v-g)*(o-p)?0:1,E=0;return function(e,t,n,r,i,a,o,s){var l=(i-=n)*(s-=r)-(o-=n)*(a-=r),u=(e*(a-s)+t*(o-i)+i*s-o*a)/l,c=(e*s-t*o)/l,h=(t*i-e*a)/l;if(0<u&&u<1&&0<c&&c<1&&0<h&&h<1)return!0;return!1}(T,A,S,C,b,k,x,w)&&function(e,t,n,r,i,a,o,s){n-=e,r-=t,a-=t,i=o-e,s-=t,t=e=0;var l=Ce.g.toDeg(Ga(r,n)-Ga(t,e)),u=Ce.g.toDeg(Ga(a,i)-Ga(t,e)),c=Ce.g.toDeg(Ga(s,o)-Ga(t,e));if(l=Ce.g.normalizeAngle(l-c),u=Ce.g.normalizeAngle(u-c),(0<l&&u<0||l<0&&0<u)&&180<Xa(l-u))return!0;return!1}(T,A,S,C,b,k,x,w)&&(E=1)," A ".concat(Ci(I,2)," ").concat(Ci(R,2)," ").concat(y," ").concat(E," ").concat(V," ").concat(Ci(n,2)," ").concat(Ci(i,2))}function Ja(e,t,n){return" L ".concat(bi(n,e,t).join(" "))}function qa(e){return e.replace(/[A-Z]|\(|\)/g,"").split(/\s*,\s*/).map(function(e){return Number(e)})}function Ka(e){return Array.isArray(e)?e:[e]}function Qa(e,t){var n=t.width,r=t.height;return Ka(e).map(function(e){return function(e,t){var n=t.width,r=t.height;return function(e,t){var u={width:t.width,height:t.height},c="";return ja=za=0,Ya=null,e.forEach(function(e,t,n){var r=e.name,i=e.cells;if(0===t&&r!==Ji.MoveTo&&(c+=Wa({x:0,y:0})),Ya){var a=Ya,o=a.points,s=a.knots,l=a.degree;if(n.length===t+1)return Ua(r,i,u),void(c+=Ja(o,s,l));r!==Ji.SplineKnot&&(c+=Ja(o,s,l),Ya=null)}c+=Ua(r,i,u)}),c}(e.rows.map(function(e){return{name:e.type,cells:e.cells}}),{width:n,height:r})}(e,{width:n,height:r})}).join(" ")}he({target:"Array",stat:!0},{isArray:ze});var Za=Object.assign,$a=Object.defineProperty,eo=!Za||v(function(){if(V&&1!==Za({b:1},Za($a({},"a",{enumerable:!0,get:function(){$a(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=Za({},e)[n]||dt(Za({},t)).join("")!=r})?function(e,t){for(var n=ge(e),r=arguments.length,i=1,a=Ee.f,o=d.f;i<r;)for(var s,l=b(arguments[i++]),u=a?dt(l).concat(a(l)):dt(l),c=u.length,h=0;h<c;)s=u[h++],V&&!o.call(l,s)||(n[s]=l[s]);return n}:Za;he({target:"Object",stat:!0,forced:Object.assign!==eo},{assign:eo});var to,no,ro,io={},ao=!v(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),oo=N("IE_PROTO"),so=Object.prototype,lo=ao?Object.getPrototypeOf:function(e){return e=ge(e),f(e,oo)?e[oo]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?so:null},uo=de("iterator"),co=!1;[].keys&&("next"in(ro=[].keys())?(no=lo(lo(ro)))!==Object.prototype&&(to=no):co=!0),null!=to&&!v(function(){var e={};return to[uo].call(e)!==e})||(to={}),f(to,uo)||F(to,uo,function(){return this});function ho(e,t,n){e&&!f(e=n?e:e.prototype,mo)&&yo(e,mo,{configurable:!0,value:t})}function fo(){return this}function po(){return this}function go(e,t,n,r,i,a,o){function s(e){if(e===i&&d)return d;if(!bo&&e in p)return p[e];switch(e){case"keys":case xo:case wo:return function(){return new n(this,e)}}return function(){return new n(this)}}!function(e,t,n){var r=t+" Iterator";e.prototype=kt(So,{next:M(1,n)}),ho(e,r,!1),io[r]=fo}(n,t,r);var l,u,c,h=t+" Iterator",f=!1,p=e.prototype,g=p[ko]||p["@@iterator"]||i&&p[i],d=!bo&&g||s(i),v="Array"==t&&p.entries||g;if(v&&(l=lo(v.call(new e)),Co!==Object.prototype&&l.next&&(lo(l)!==Co&&(pn?pn(l,Co):"function"!=typeof l[ko]&&F(l,ko,po)),ho(l,h,!0))),i==xo&&g&&g.name!==xo&&(f=!0,d=function(){return g.call(this)}),p[ko]!==d&&F(p,ko,d),io[t]=d,i)if(u={values:s(xo),keys:a?d:s("keys"),entries:s(wo)},o)for(c in u)!bo&&!f&&c in p||ke(p,c,u[c]);else he({target:t,proto:!0,forced:bo||f},u);return u}var vo={IteratorPrototype:to,BUGGY_SAFARI_ITERATORS:co},yo=D.f,mo=de("toStringTag"),So=vo.IteratorPrototype,Co=vo.IteratorPrototype,bo=vo.BUGGY_SAFARI_ITERATORS,ko=de("iterator"),xo="values",wo="entries",Po="Array Iterator",_o=be.set,To=be.getterFor(Po),Ao=go(Array,"Array",function(e,t){_o(this,{type:Po,target:u(e),index:0,kind:t})},function(){var e=To(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?{value:e.target=void 0,done:!0}:"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}},"values");io.Arguments=io.Array,Pt("keys"),Pt("values"),Pt("entries");var Lo=Qe.some,Mo=Et("some"),Io=it("some");he({target:"Array",proto:!0,forced:!Mo||!Io},{some:function(e,t){return Lo(this,e,1<arguments.length?t:void 0)}});function Ro(s){return function(e){for(var t,n=u(e),r=dt(n),i=r.length,a=0,o=[];a<i;)t=r[a++],V&&!Vo.call(n,t)||o.push(s?[t,n[t]]:n[t]);return o}}var Vo=d.f,Eo={entries:Ro(!0),values:Ro(!1)}.entries;he({target:"Object",stat:!0},{entries:function(e){return Eo(e)}});function Do(e){return void 0!==e&&(io.Array===e||Yo[zo]===e)}function Fo(e){if(null!=e)return e[Uo]||e["@@iterator"]||io[Fn(e)]}function Oo(e){var t=e.return;if(void 0!==t)return _(t.call(e)).value}function No(e,t){this.stopped=e,this.result=t}function Bo(e,t,n){function r(e){return a&&Oo(a),new No(!0,e)}function i(e){return p?(_(e),d?v(e[0],e[1],r):v(e[0],e[1])):d?v(e,r):v(e)}var a,o,s,l,u,c,h,f=n&&n.that,p=!(!n||!n.AS_ENTRIES),g=!(!n||!n.IS_ITERATOR),d=!(!n||!n.INTERRUPTED),v=pe(t,f,1+p+d);if(g)a=e;else{if("function"!=typeof(o=Fo(e)))throw TypeError("Target is not iterable");if(Do(o)){for(s=0,l=ae(e.length);s<l;s++)if((u=i(e[s]))&&u instanceof No)return u;return new No(!1)}a=o.call(e)}for(c=a.next;!(h=c.call(a)).done;){try{u=i(h.value)}catch(e){throw Oo(a),e}if("object"==typeof u&&u&&u instanceof No)return u}return new No(!1)}function Go(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}var Xo=!v(function(){return Object.isExtensible(Object.preventExtensions({}))}),jo=r(function(e){function n(e){t(e,r,{value:{objectID:"O"+ ++i,weakData:{}}})}var t=D.f,r=O("meta"),i=0,a=Object.isExtensible||function(){return!0},o=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!I(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!f(e,r)){if(!a(e))return"F";if(!t)return"E";n(e)}return e[r].objectID},getWeakData:function(e,t){if(!f(e,r)){if(!a(e))return!0;if(!t)return!1;n(e)}return e[r].weakData},onFreeze:function(e){return Xo&&o.REQUIRED&&a(e)&&!f(e,r)&&n(e),e}};q[r]=!0}),zo=(jo.REQUIRED,jo.fastKey,jo.getWeakData,jo.onFreeze,de("iterator")),Yo=Array.prototype,Uo=de("iterator"),Wo=de("iterator"),Ho=!1;try{var Jo=0,qo={next:function(){return{done:!!Jo++}},return:function(){Ho=!0}};qo[Wo]=function(){return this},Array.from(qo,function(){throw 2})}catch(e){}function Ko(e,t){if(!t&&!Ho)return!1;var n=!1;try{var r={};r[Wo]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n}function Qo(r,e,t){function n(e){var n=l[e];ke(l,e,"add"==e?function(e){return n.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(a&&!I(e))&&n.call(this,0===e?0:e)}:"get"==e?function(e){return a&&!I(e)?void 0:n.call(this,0===e?0:e)}:"has"==e?function(e){return!(a&&!I(e))&&n.call(this,0===e?0:e)}:function(e,t){return n.call(this,0===e?0:e,t),this})}var i=-1!==r.indexOf("Map"),a=-1!==r.indexOf("Weak"),o=i?"set":"add",s=R[r],l=s&&s.prototype,u=s,c={};if(Xe(r,"function"!=typeof s||!(a||l.forEach&&!v(function(){(new s).entries().next()}))))u=t.getConstructor(e,r,i,o),jo.REQUIRED=!0;else if(Xe(r,!0)){var h=new u,f=h[o](a?{}:-0,1)!=h,p=v(function(){h.has(1)}),g=Ko(function(e){new s(e)}),d=!a&&v(function(){for(var e=new s,t=5;t--;)e[o](t,t);return!e.has(-0)});g||(((u=e(function(e,t){Go(e,u,r);var n=cn(new s,e,u);return null!=t&&Bo(t,n[o],{that:n,AS_ENTRIES:i}),n})).prototype=l).constructor=u),(p||d)&&(n("delete"),n("has"),i&&n("get")),(d||f)&&n(o),a&&l.clear&&delete l.clear}return c[r]=u,he({global:!0,forced:u!=s},c),ho(u,r),a||t.setStrong(u,r,i),u}function Zo(e,t,n){for(var r in t)ke(e,r,t[r],n);return e}function $o(e){var t=re(e),n=D.f;V&&t&&!t[es]&&n(t,es,{configurable:!0,get:function(){return this}})}var es=de("species"),ts=D.f,ns=jo.fastKey,rs=be.set,is=be.getterFor,as={getConstructor:function(e,n,r,i){function a(e,t,n){var r,i,a=s(e),o=l(e,t);return o?o.value=n:(a.last=o={index:i=ns(t,!0),key:t,value:n,previous:r=a.last,next:void 0,removed:!1},a.first||(a.first=o),r&&(r.next=o),V?a.size++:e.size++,"F"!==i&&(a.index[i]=o)),e}var o=e(function(e,t){Go(e,o,n),rs(e,{type:n,index:kt(null),first:void 0,last:void 0,size:0}),V||(e.size=0),null!=t&&Bo(t,e[i],{that:e,AS_ENTRIES:r})}),s=is(n),l=function(e,t){var n,r=s(e),i=ns(t);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==t)return n};return Zo(o.prototype,{clear:function(){for(var e=s(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,V?e.size=0:this.size=0},delete:function(e){var t=s(this),n=l(this,e);if(n){var r=n.next,i=n.previous;delete t.index[n.index],n.removed=!0,i&&(i.next=r),r&&(r.previous=i),t.first==n&&(t.first=r),t.last==n&&(t.last=i),V?t.size--:this.size--}return!!n},forEach:function(e,t){for(var n,r=s(this),i=pe(e,1<arguments.length?t:void 0,3);n=n?n.next:r.first;)for(i(n.value,n.key,this);n&&n.removed;)n=n.previous},has:function(e){return!!l(this,e)}}),Zo(o.prototype,r?{get:function(e){var t=l(this,e);return t&&t.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),V&&ts(o.prototype,"size",{get:function(){return s(this).size}}),o},setStrong:function(e,t,n){var r=t+" Iterator",i=is(t),a=is(r);go(e,t,function(e,t){rs(this,{type:r,target:e,state:i(e),kind:t,last:void 0})},function(){for(var e=a(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:{value:e.target=void 0,done:!0}},n?"entries":"values",!n,!0),$o(t)}},os=(Qo("Set",function(t){return function(e){return t(this,arguments.length?e:void 0)}},as),oi.charAt),ss="String Iterator",ls=be.set,us=be.getterFor(ss);go(String,"String",function(e){ls(this,{type:ss,string:String(e),index:0})},function(){var e,t=us(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=os(n,r),t.index+=e.length,{value:e,done:!1})});var cs=de("iterator"),hs=de("toStringTag"),fs=Ao.values;for(var ps in Hn){var gs=R[ps],ds=gs&&gs.prototype;if(ds){if(ds[cs]!==fs)try{F(ds,cs,fs)}catch(e){ds[cs]=fs}if(ds[hs]||F(ds,hs,ps),Hn[ps])for(var vs in Ao)if(ds[vs]!==Ao[vs])try{F(ds,vs,Ao[vs])}catch(e){ds[vs]=Ao[vs]}}}var ys=function(){function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set;ir(this,r),this.assertArchiveDefined(e);var n=Zn(Zn({},this.getDefaultAttributes()),e);t.add(Ki.archive),this._prefixList=t,this.setAttributes(n)}return or(r,[{key:"getDefaultAttributes",value:function(){return{archive:null}}},{key:"prefixList",get:function(){return this._prefixList}},{key:"setAttribute",value:function(e,t){this.prefixList.has(e)&&(e="_".concat(e)),this[e]=t}},{key:"setAttributes",value:function(e){var i=this;Object.entries(e).forEach(function(e){var t=dr(e,2),n=t[0],r=t[1];return i.setAttribute(n,r)}),"structurePath"in e&&this.setOwner(e.structurePath)}},{key:"setOwner",value:function(e){1!==e.length?ms(e,Pi.StyleSheet)?this.owner="Document-Stylesheet":ms(e,Pi.DocumentSheet)?this.owner="Document-DocumentSheet":ms(e,Pi.PageSheet)?ms(e,Pi.Page)?this.owner="Page-PageSheet":ms(e,Pi.Master)?this.owner="Master-PageSheet":wa.log("Unknown PageSheet owner"):ms(e,Pi.Shape)?ms(e,Pi.Page)?this.owner="Page-Shape":ms(e,Pi.Master)?this.owner="Master-Shape":wa.log("Unknown Shape owner"):window.tests:this.owner=e[0].jxonType}},{key:"parent",get:function(){return this._parent},set:function(e){this._parent=e}},{key:"archive",get:function(){return this._archive}},{key:"assertArchiveDefined",value:function(e){e.hasOwnProperty("archive")&&e.archive||wa.log("Missing archive reference in constructor",this)}}]),r}();function ms(e,t){return e.some(function(e){return e.jxonType===t})}function Ss(e){return"string"!=typeof e?"":e.charAt(0).toLowerCase()+e.slice(1)}var Cs=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};ir(this,t),this._name=e.name,this._value=e.value,this._formula=e.formula,this._units=e.units,this._cells=e.cells}return or(t,[{key:"name",get:function(){return this._name}},{key:"value",get:function(){return this._value}},{key:"formula",get:function(){return this._formula}},{key:"units",get:function(){return this._units}},{key:"eval",value:function(){return this._cells[Ss(this.name)]}}]),t}(),bs=function(){lr(t,ys);var e=pr(t);function t(){return ir(this,t),e.apply(this,arguments)}return or(t,[{key:"getOwnCellNames",value:function(){var e=this.cells;return e?e.getOwnNames():[]}},{key:"getCell",value:function(e){var t=this.cells;if(!t)return wa.log("Visio object does not contain cells."),null;var n=t.get(e);return n?new Cs(Zn(Zn({},n),{},{cells:t})):null}},{key:"setCell",value:function(e,t){var n=this.cells,r=this.jxon;n?n.set(e,t,r):wa.log("Visio object does not contain cells.")}},{key:"removeCell",value:function(e){var t=this.cells,n=this.jxon;t&&t.get(e)&&t.remove(e,n)}}]),t}(),ks=Qe.every,xs=Et("every"),ws=it("every");he({target:"Array",proto:!0,forced:!xs||!ws},{every:function(e,t){return ks(this,e,1<arguments.length?t:void 0)}});function Ps(u){return function(e,t,n,r){fe(t);var i=ge(e),a=b(i),o=ae(i.length),s=u?o-1:0,l=u?-1:1;if(n<2)for(;;){if(s in a){r=a[s],s+=l;break}if(s+=l,u?s<0:o<=s)throw TypeError("Reduce of empty array with no initial value")}for(;u?0<=s:s<o;s+=l)s in a&&(r=t(r,a[s],s,i));return r}}var _s={left:Ps(!1),right:Ps(!0)},Ts="process"==a(R.process),As=_s.left,Ls=Et("reduce"),Ms=it("reduce",{1:0});function Is(e,t){var n=function(e,t){if(["pageBottomMargin","pageLeftMargin","pageRightMargin","pageTopMargin"].includes(t.name))return Qi.internalUnitsToPixels;return null}(0,t);if(null!==n)return n;if(t.units===ji.PER)return Qi.percentage;switch(e){case ga:case ea:case ta:case aa:case la:case sa:case ua:return Qi.number;case da:return Qi.internalUnitsToPixels;case oa:return Qi.date;case pa:return Qi.internalUnitsToDegrees;case na:return Qi.booleanStrict;case ia:case va:return Qi.color;case fa:"STR"!==t.units&&"value"!==t.name&&wa.log("resolve VisioValueType.vAny",t);case ha:case ca:case ya:case ra:case ma:return Qi.asIs}wa.log("unresolved cell type")}he({target:"Array",proto:!0,forced:!Ls||!Ms||!Ts&&79<at&&at<83},{reduce:function(e,t){return As(this,e,arguments.length,1<arguments.length?t:void 0)}});var Rs={evaluateFormulas:!1};function Vs(e){return e===Sa.Light?"#ffffff":e===Sa.Dark?"#000000":e===Sa.AccentColor?"#c05046":e===Sa.AccentColor2?"#9dbb61":e===Sa.AccentColor3?"#ab9ac0":e===Sa.AccentColor4?"#4bacc6":e===Sa.AccentColor5?"#f59d56":e===Sa.AccentColor6?"#ffc000":e===Sa.VariantColor1?"#c05046":e===Sa.VariantColor2?"#9dbb61":e===Sa.VariantColor3?"#ab9ac0":e===Sa.VariantColor4?"#4bacc6":e===Sa.VariantColor5?"#f59d56":e===Sa.VariantColor6?"#ffc000":e===Sa.VariantColor7?"#000000":void wa.log("Unknown themeVal")}function Es(e,t){return Ki.hasOwnProperty(e)||wa.log("Unknown VisioAttribute.".concat(e)),null===t?null:[Ki.id,Ki.masterId,Ki.masterShapeId,Ki.fromSheet,Ki.fromPart,Ki.toSheet,Ki.toPart,Ki.index].includes(e)?Aa(t):[Ki.patternFlags,Ki.masterType,Ki.alignName,Ki.iconSize,Ki.topPage,Ki.defaultTextStyle,Ki.defaultLineStyle,Ki.defaultFillStyle,Ki.defaultGuideStyle,Ki.glueSettings,Ki.snapSettings,Ki.snapExtensions,Ki.fillStyle,Ki.lineStyle,Ki.textStyle,Ki.backPage].includes(e)?Ta(t):[Ki.isCustomNameU,Ki.isCustomName,Ki.hidden,Ki.iconUpdate,Ki.matchByName,Ki.protectStyles,Ki.protectShapes,Ki.protectMasters,Ki.protectBkgnds,Ki.dynamicGridEnabled,Ki.deleted,Ki.background].includes(e)?La(t):t}function Ds(e,o,t){return t||wa.log("Structure path not set.",{jxon:e,jxonType:o}),Pi.hasOwnProperty(o)||wa.log('Unknown "VisioJXONType.'.concat(o,'"')),Object.entries(e).filter(function(e){var t=dr(e,2),n=t[0];t[1];return"@"===n[0]}).filter(function(e){var t=dr(e,2),n=t[0];t[1];return![Oi.xmlns,Oi.xmlnsR,Oi.xmlSpace].includes(n)}).reduce(function(e,t){var n=dr(t,2),r=n[0],i=n[1],a=Fs(r.substring(1),o);return e[a]=Es(a,i),e},{})}function Fs(e,t){if("IX"===e)return"index";if("ID"===e)return"id";if("UniqueID"===e)return"uniqueId";if("OriginalID"===e)return"originalId";if(e===Wi.Deleted.substring(1))return Ki.deleted;if(t===Pi.ShapeText&&e===Bi.Content)return"content";if(t===Pi.Section&&e===Ri.Name.substring(1))return"type";if(t===Pi.Row){if(e===Wi.Type.substring(1))return"type";if(e===Wi.Name.substring(1))return"name"}if(t===Pi.Shape){if(e===Di.MasterShapeId.substring(1))return Ki.masterShapeId;if(e===Di.MasterId.substring(1))return Ki.masterId}return Ss(e)}function Os(e,t,n,r){var i=3<arguments.length&&void 0!==r?r:{},a=i.typeOverride,o=void 0===a?null:a,s=i.structurePathEnrichObject,l=void 0===s?null:s;n&&t||wa.log("Missing required attributes.");var u={jxonType:e,xsdType:function(e){return"".concat(e,"_Type")}(e)},c=Ds(t,e,n);return[Ki.id,Ki.name,Ki.masterId,Ki.masterShapeId,Ki.type,Ki.index].forEach(function(e){c.hasOwnProperty(e)&&(u[e]=c[e])}),o&&(u.type=o),l&&(u=Zn(Zn({},u),l)),u}var Ns=[].slice,Bs={},Gs=Function.bind||function(t){var n=fe(this),r=Ns.call(arguments,1),i=function(){var e=r.concat(Ns.call(arguments));return this instanceof i?function(e,t,n){if(!(t in Bs)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";Bs[t]=Function("C,a","return new C("+r.join(",")+")")}return Bs[t](e,n)}(n,e.length,e):n.apply(t,e)};return I(n.prototype)&&(i.prototype=n.prototype),i};he({target:"Function",proto:!0},{bind:Gs});var Xs=mn.trim,js=R.parseInt,zs=/^[+-]?0[Xx]/,Ys=8!==js(gn+"08")||22!==js(gn+"0x16")?function(e,t){var n=Xs(String(e));return js(n,t>>>0||(zs.test(n)?16:10))}:js;he({global:!0,forced:parseInt!=Ys},{parseInt:Ys});function Us(e){return v(function(){return!!gn[e]()||"\u200b\x85\u180e"!="\u200b\x85\u180e"[e]()||gn[e].name!==e})}var Ws,Hs=mn.end,Js=Us("trimEnd"),qs=Js?function(){return Hs(this)}:"".trimEnd;function Ks(e,t,n){if(0<=e)return e;var r=Da(-e);return function(e,t){var r=t.size;return e.forEach(function(e){var t=e.characterProperties;if(t){var n=t.values.size;void 0!==t.values.size&&(r=Math.max(r,n))}}),r}(t,n)*r}function Qs(e,t){var r,g,d,n=t||{},v=n.attributes,y=n.annotations,m=null==n.maxWidth?1e6:n.maxWidth,i=!!n.overflowAllowed,a=e.split("\n"),o=a.length,s=0,S=0,l="",C=0,b=Ce.util.merge([],y);a.forEach(function(e){r=0,g=[],d=[];for(var t=P(e);t;)_(t),t=P(e);d.length&&L(),s<o-1&&T("\n"),s+=1});var u=l.split("\n"),c=u.length;if(i&&1===o&&2===u.length){var h=u[0],f=u[1],p=Ce.util.merge([],b),k=Ce.V.findAnnotationsBetweenIndexes(p,0,h.length),x=Ce.V.shiftAnnotations(Ce.V.findAnnotationsBetweenIndexes(p,h.length,h.length+f.length),h.length,-h.length-1),w=this.measureText(h,v,k).width;if(this.measureText(f,v,x).width<Math.min(.4*w,100))return{numLines:c,text:e,annotations:y}}return{numLines:c,text:l,annotations:b};function P(e){for(var t={type:null,startIndex:r,endIndex:r,text:""};r<e.length;){var n=e[r];if(void 0,/\s/,/\s/.test(n))switch(t.type){case null:case"whitespace":t.type="whitespace",t.text+=n,t.endIndex+=1;break;default:return t}else switch(t.type){case"whitespace":return t;default:t.type="word",t.text+=n,t.endIndex+=1}r+=1}return t.startIndex===t.endIndex?null:t}function _(e){var t=!!g.length,n=!!d.length,r=!t&&!n,i="";t&&(i=g[g.length-1].cumulativeText),n&&(i=d[d.length-1].cumulativeText);var a=i+e.text,o=S-i.length,s=S+e.text.length,l=Ce.V.findAnnotationsBetweenIndexes(y,o,s),u=C-i.length,c=Ce.util.toArray(l).reduce(function(e,t){return e.push({start:t.start-u,end:t.end-u,attrs:t.attrs}),e},[]),h=Zs(a,v,c).width,f="whitespace"===e.type;if(!n&&(h<=m||f))return T(e.text),void A(e,a);var p="piece"===e.type;if(r)return T(e.text),void A(e,a);p&&0<e.pieceIndex&&T("-",!0),t&&function(){var e=g[g.length-1];"whitespace"===e.type&&function(e){Ce.V.shiftAnnotations(b,S,-e.length),C-=e.length}(e.text);T("\n",!0),g=[]}(),n&&L(),_(e)}function T(e,t){l+=e,t&&Ce.V.shiftAnnotations(b,S,e.length),C+=e.length}function A(e,t){g.push({token:e,cumulativeText:t}),S+=e.text.length}function L(){var t="";d.forEach(function(e){t+=e.token.text,T(e.token.text),A(e.token,t),S-=e.token.text.length}),d=[]}}function Zs(e,t,n,r){var i=t||{},a=r||{heightCompensation:!1};if(!Ws){var o=Ce.V("svg");document.body.appendChild(o.node),(Ws=Ce.V("text")).attr("visibility","hidden"),o.append(Ws)}Ws.attr({"font-weight":i["font-weight"],"font-size":i["font-size"],"font-family":i["font-family"],"letter-spacing":i["letter-spacing"],style:"font-kerning: none"}),Ws.text(e,{lineHeight:Ce.util.isEmpty(n)?i["line-height"]||"1em":"auto",replaceNewLine:"\u2002",annotations:n}),Ws.node.removeAttribute("display");var s=Ws.bbox(!0);return a.heightCompensation&&(s.height-=s.y),s.y=0,s.x=0,s}function $s(e){var f,p=[],g=null,d=null,v=[],y=0,t=e.text,n=e.sections.get("Paragraph")[0].rows[0].cells,r=n.spLine,i=n.horzAlign;t.forEach(function(e){if(e.paragraphProperties){var t=e.paragraphProperties.values;void 0!==t.spLine&&(r=t.spLine),void 0!==t.horzAlign&&(i=t.horzAlign)}});var m=e.sections.get("Character")[0].rows[0].cells,a=Ks(r,t,m);return t.forEach(function(e){var t=e.content;f=y;var n=t.length;y=f+n;var r=m.uppercase,i=m.font,a=m.color,o=m.style,s=m.size,l=m.letterspace;if(e.characterProperties){var u=e.characterProperties.values;void 0!==u.uppercase&&(r=u.uppercase),void 0!==u.font&&(i=u.font),void 0!==u.color&&(a=u.color),void 0!==u.style&&(o=u.style),void 0!==u.size&&(s=u.size),void 0!==u.letterspace&&(l=u.letterspace)}var c={};1===r&&(t=t.toUpperCase()),2===r&&(t=function(e){return"string"!=typeof e?"":e.charAt(0).toUpperCase()+e.slice(1)}(t),c["text-transform"]="capitalize"),l&&0!==l&&(c["letter-spacing"]=l),i&&(g=g||i,c["font-family"]=i),void 0!==s&&(d=d||s,c["font-size"]=s,c["font-size"]<1&&(c["font-size"]=12)),void 0!==a&&(c.fill=a),void 0!==o&&(4&o&&(c["text-decoration"]="underline"),2&o&&(c["font-style"]="italic"),1&o&&(c["font-weight"]="bold")),p.push(t);var h={start:f,end:y,attrs:c};v.push(h)}),{mergedText:p.join("").trimEnd(),annotations:v,lineHeight:a,firstFont:g,firstFontSize:d,horzAlign:i}}function el(e,t){var n=t.maxWidth,r=$s(e),i=r.mergedText,a=r.annotations;return Zs(Qs(i,{annotations:a,maxWidth:n}).text,{},a)}he({target:"String",proto:!0,forced:Js},{trimEnd:qs,trimRight:qs});function tl(e){var t=e[0]/239*360,n=e[1]/240,r=e[2]/240,i=(1-Math.abs(2*r-1))*n,a=i*(1-Math.abs(t/60%2-1)),o=r-i/2,s=0,l=0,u=0;return 0<=t&&t<60?(s=i,l=a,u=0):60<=t&&t<120?(s=a,l=i,u=0):120<=t&&t<180?(s=0,l=i,u=a):180<=t&&t<240?(s=0,l=a,u=i):240<=t&&t<300?(s=a,l=0,u=i):300<=t&&t<360&&(s=i,l=0,u=a),s=Math.round(255*(s+o)).toString(16),l=Math.round(255*(l+o)).toString(16),u=Math.round(255*(u+o)).toString(16),1===s.length&&(s="0"+s),1===l.length&&(l="0"+l),1===u.length&&(u="0"+u),"#"+s+l+u}function nl(e){return e[0]}function rl(e){return e[0]}function il(e){return e.reduce(function(e,t){return Math.max(e,t)})}function al(e){var t=dr(e,2),n=t[0],r=t[1];return Math.atan2(n,r)}function ol(e){return Math.sqrt(e[0])}function sl(e){return"1"===e[0].toString()?e[1]:e[2]}function ll(e){var t=dr(e,2),n=t[0],r=t[1];if(isNaN(n)||isNaN(r))throw Error("#VALUE");if(n=parseInt(n),r=parseInt(r),n<0||r<0)throw Error("#NUM");return Math.floor(n)!==n||Math.floor(r)!==r?"#NUM!":0xffffffffffff<n||0xffffffffffff<r?"#NUM!":((n^r)>>>0).toString(2)}var ul=function(){lr(i,t.Parser);var r=pr(i);function i(e,t){var n;return ir(this,i),(n=r.call(this)).registerFunctions(e,t),n.registerEvents(t),n}return or(i,[{key:"registerFunctions",value:function(e,t){this.setFunction("HSL",tl),this.setFunction("PAGENUMBER",function(e){return e.page.index+1}.bind(this,t)),this.setFunction("PAGECOUNT",function(e){var t=e.pages.pages;return t?t.length:0}.bind(this,t.archive.document)),this.setFunction("GUARD",nl),this.setFunction("PAR",rl),this.setFunction("PNT",function(e,t){switch(e.name[e.name.length-1]){case"X":return t[0];case"Y":return t[1];default:throw Error("#VALUE")}}.bind(this,e)),this.setFunction("ATAN2",al),this.setFunction("SQRT",ol),this.setFunction("IF",sl),this.setFunction("BITXOR",ll),this.setFunction("MAX",il),this.setFunction("TEXTWIDTH",function(e,t){var n=dr(t,2)[1];n=isNaN(n)?1e6:Ra(n);var r=e.cells,i=r.leftMargin,a=void 0===i?0:i,o=r.rightMargin,s=void 0===o?0:o;return Da(el(e,{maxWidth:n}).width+a+s)}.bind(this,t)),this.setFunction("TEXTHEIGHT",function(e,t){var n=dr(t,2)[1];n=isNaN(n)?1e6:Ra(n);var r=e.cells,i=r.topMargin,a=void 0===i?0:i,o=r.bottomMargin,s=void 0===o?0:o;return Da(el(e,{maxWidth:n}).height+a+s)}.bind(this,t))}},{key:"registerEvents",value:function(e){var t=this;this.on("callFunction",function(e){t.getFunction(e)}),this.on("callVariable",function(e,t,n){var r;switch(t){case cl.THE_TEXT:var i=$s(e).mergedText;return n(i)}var a=t.charAt(0).toLowerCase()+t.slice(1),o=e.cells.get(a);o=o||e.cells.getParentCell(a);{if(!(r=o?o.value:null)&&0!==r)throw Error("#N/A");n(r)}}.bind(this,e))}}]),i}(),cl={THE_TEXT:"TheText"};var hl=D.f,fl=Ve.f,pl=be.set,gl=de("match"),dl=R.RegExp,vl=dl.prototype,yl=/a/g,ml=/a/g,Sl=new dl(yl)!==yl,Cl=Xr.UNSUPPORTED_Y;if(V&&Xe("RegExp",!Sl||Cl||v(function(){return ml[gl]=!1,dl(yl)!=yl||dl(ml)==ml||"/a/i"!=dl(yl,"i")}))){for(var bl=function(e,t){var n,r=this instanceof bl,i=Yn(e),a=void 0===t;if(!r&&i&&e.constructor===bl&&a)return e;Sl?i&&!a&&(e=e.source):e instanceof bl&&(a&&(t=Nn.call(e)),e=e.source),Cl&&(n=!!t&&-1<t.indexOf("y"))&&(t=t.replace(/y/g,""));var o=cn(Sl?new dl(e,t):dl(e,t),r?this:vl,bl);return Cl&&n&&pl(o,{sticky:n}),o},kl=function(t){t in bl||hl(bl,t,{configurable:!0,get:function(){return dl[t]},set:function(e){dl[t]=e}})},xl=fl(dl),wl=0;xl.length>wl;)kl(xl[wl++]);(vl.constructor=bl).prototype=vl,ke(R,"RegExp",bl)}$o("RegExp"),qr("match",1,function(r,u,c){return[function(e){var t=h(this),n=null==e?void 0:e[r];return void 0!==n?n.call(e,t):new RegExp(e)[r](String(t))},function(e){var t=c(u,e,this);if(t.done)return t.value;var n=_(e),r=String(this);if(!n.global)return $r(n,r);for(var i,a=n.unicode,o=[],s=n.lastIndex=0;null!==(i=$r(n,r));){var l=String(i[0]);""===(o[s]=l)&&(n.lastIndex=Qr(r,ae(n.lastIndex),a)),s++}return 0===s?null:o}]});var Pl=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1};function _l(e,t){var n=t.cells,r=n.pinX,i=void 0===r?0:r,a=n.pinY,o=void 0===a?0:a,s=n.locPinX,l=void 0===s?0:s,u=n.locPinY,c=void 0===u?0:u,h=n.angle,f=void 0===h?0:h,p=Da(i-l),g=Da(o-c),d=e.x,v=e.y;return function(e,t,n,r,i){var a=Math.PI/180*i,o=Math.cos(a),s=Math.sin(a);return{x:o*(n-e)+s*(r-t)+e,y:o*(r-t)-s*(n-e)+t}}(p,g,d+=p,v+=g,f)}he({target:"Math",stat:!0},{sign:Pl});var Tl={PAR:"PAR"},Al={Actions:{alias:"Actions",default:"Menu"},Char:{alias:"Character"},Connections:{alias:"Connection"},Controls:{alias:"Control",default:"X"},Fields:{alias:"Field"},FillGradientStops:{alias:"FillGradient"},Geometry:{alias:"Geometry",indexedName:!0},Hyperlink:{alias:"Hyperlink",default:"Description"},Layers:{alias:"Layer"},LineGradientStops:{alias:"LineGradient"},Para:{alias:"Paragraph"},Prop:{alias:"Property",default:"Value"},Reviewer:{alias:"Reviewer"},Scratch:{alias:"Scratch"},SmartTags:{alias:"ActionTag",default:"X"},Tabs:{alias:"Tabs"},User:{alias:"User",default:"Value"}},Ll={singleCharOperator:/([-+^*/&<>=])/,multiCharOperator:/(<>|<=|>=)/,parentheses:/([()])/,singleParentheses:/^[()]$/,unitValue:/([-])?([0-9]+)([A-Z]*)/,potentialFunc:/^[A-Z]{2,}$/g},Ml={operatorSplit:new RegExp("(?:".concat(Ll.multiCharOperator.source,"|").concat(Ll.singleCharOperator.source,"|").concat(Ll.parentheses.source,")"),"gm"),skipEvaluation:new RegExp("^".concat(Ll.singleCharOperator.source,"|").concat(Ll.multiCharOperator.source,"|").concat(Ll.parentheses.source,"$")),referencedVariable:new RegExp("([\\w]+)\\.([\\d]+)(?:[!])","gm")};function Il(c,e,t){for(var n=t||{},r=c.split(Ml.operatorSplit).filter(function(e){return e}),i=0,a=[];i<r.length;){var o=r[i];if(o.match(Ml.skipEvaluation))a.push(o),i++;else if(o.match(Ll.potentialFunc)){var s=f(r,i),l=s.join("");o===Tl[o]&&(n.ctxType=n.ctxType||Tl[o]);var u=Il(l,e,n);a.push(o+u),i+=s.length+1}else{var h=p(o,e,n);a.push(h),i++}}return a=a.join("");function f(e,t){for(var n,r=t+1,i=r,a=0;i<e.length&&(e[i].match(Ll.singleParentheses)&&(a+="("===e[i]?1:-1,n=!0),i++,!n||0!==a););return e.slice(r,i)}function p(e,f,t){var n,p,g;if((t||{}).ctxType===Tl.PAR){var r=function(e){if(!e)return wa.log("[getReferenceIdFromFormula] No formula piece provided for id extraction."),null;for(var t=e.split(Ml.referencedVariable),n=t.length;0<=n;){if("Sheet"===t[n]){var r=t[n+1];return Number.isNaN(r)?(wa.log("[getReferenceIdFromFormula] Invalid reference ID",{refId:r}),null):parseInt(r)}n--}return null}(e);n=d(f,r)}var i=e.replace(/(?:([a-zA-Z]+)\.([\d]+)!(?:([a-zA-Z]+)([\d]+)?)(?:\.(\w+))?(?:\.(\w+))?)|(?:(Actions|Char|Connections|Controls|Fields|FillGradientStops|Geometry(?=[\d]+)?|HyperLink|Layers|LineGradientStops|Para|Prop|Reviewer|Scratch|SmartTags|Tabs|User)(\d+)?(?:\.(\w+))?(?:\.(\w+))?)/gm,function(){var e,t=0<=(p=parseInt(arguments[2]))?arguments[3]:arguments[7],n=0<=p?arguments[4]:arguments[8],r=0<=p?arguments[5]:arguments[9],i=0<=p?arguments[6]:arguments[10];if(isNaN(p))return arguments[0];if(!(g=d(f,p)))return arguments[0];if(Al[t]){var a,o,s=Al[t],l=g.sections.get(s.alias);if(!l)return arguments[0];if(Ca[s.alias]===Hi.Named)a=l[0].rows.find(function(e){return e.name===r}),o=i||s.default;else{var u=r.match(/\d+/g),c=u?parseInt(u[0])-1:0;a=l[0<=n?n-1:0].rows[c],o=r.match(/[a-zA-Z]+/)[0]}if(!a)return arguments[0];o=Ss(o),e=(e=a.cells.get(o))||a.cells.getParentCell(o)}else{var h=Ss(t);e=(e=g.cells.get(h))||g.cells.getParentCell(h)}return e?e.value:arguments[0]});if(n){var a=i.replace(/[()]/gm,"").split(",").map(function(e){return new ul({},f).parse(e).result}),o=dr(a,2),s=o[0],l=o[1];2<a.length&&wa.log("Potentially invalid PNT arguments",{formula:c,pntArguments:a});var u=_l({x:s,y:l},n);i="".concat(u.x,",").concat(u.y)}return i}function d(e,t){t||0===t||wa.log("no reference id provided",{shape:e,refId:t});for(var n,r=e.masterShape?e.masterShape.master:null,i=e.pageContent.shapes.values(),a=i.next();!a.done&&r;){if(a.value.masterId===r.id&&a.value.shapes.has(e.id)){n=a.value;break}a=i.next()}return n}}var Rl={false:"0",true:"1"},Vl=function(){lr(n,ys);var t=pr(n);function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return ir(this,n),t.call(this,e,new Set([Ki.shape,Ki.masterShape]))}return or(n,[{key:"setAttributes",value:function(e){var t=this;this._attributesSet=new Set,Object.keys(e).filter(function(e){return!["archive","structurePath"].includes(e)}).forEach(function(e){return t.attributeSet(e)}),gr(ur(n.prototype),"setAttributes",this).call(this,e)}},{key:"attributeSet",value:function(e){this._attributesSet.add(e)}},{key:"attributeUnset",value:function(e){this._attributesSet.delete(e)}},{key:"attributesSet",get:function(){return this._attributesSet}},{key:"has",value:function(e){return this.attributesSet.has(e)}},{key:"hasEvery",value:function(e){var t=this;return e.every(function(e){return void 0!==t[e]})}},{key:"getRowType",value:function(){if(this._rowType)return this._rowType;var e=this.structurePath.find(function(e){return e.xsdType===$i});return e?e.type:null}},{key:"setRowType",value:function(e){this._rowType=e}},{key:"isDescendantOfSectionType",value:function(t){return this.structurePath.some(function(e){return e.xsdType===Zi&&t.includes(e.type)})}},{key:"getDefaultCellValue",value:function(e){switch(e){case ya:case ca:case ra:return"";case ia:case va:return"#000000";case ha:return"0";case da:case fa:case pa:case ta:case sa:case ea:case ua:case aa:case la:case oa:case na:case ga:return 0}wa.log("No default Cell value for ".concat(e," type."))}},{key:"resolveCellValue",value:function(e,t){if(e){var n=e.value,r=e.formula,i=Is(t,e);if(r&&Rs.evaluateFormulas&&(n=function(e,t){if(!t)return e.value;var n=function(e,t){var n=e.formula;switch(n){case"Inh":n=function(e,t){if(t.masterShape){var n=t.masterShape.cells.get(e.name);if(n&&n.formula)return n.formula}var r=t.archive.document.pageSheet.cells.get(e.name);return r&&r.formula?r.formula:null}(e,t);break;case"No Formula":n=void 0}return n}(e,t);if(!n||!t)return e.value;var r=Il(n,t),i=new ul(e,t).parse(r);if(i.error)return e.value;var a=i.result.toString();return Rl[a.toLowerCase()]&&(a=Rl[a.toLowerCase()]),a}(e,this.shape)),"Themed"===n){var a=function(e,t){var n=e.name;return"lineColor"===n?Vs(Sa.Dark):"linePattern"===n?1:"lineColorTrans"!==n&&("fillForegnd"===n?Vs(Sa.Light):"fillPattern"===n?1:"fillForegndTrans"===n?0:"style"===n?0:"lineWeight"===n?1:"font"!==n&&"asianFont"!==n&&"complexScriptFont"!==n?"color"===n?Vs(Sa.Dark):"fillBkgnd"===n?Vs(Sa.Light):"fillBkgndTrans"!==n&&void 0:void 0)}.call(this,e,t);if(null!==a)return a}switch(i){case Qi.number:case Qi.byte:n=Ta(n);break;case Qi.percentage:n=100*Ta(n);break;case Qi.booleanStrict:n=Ma(n);break;case Qi.booleanTriState:n=La(n);break;case Qi.internalUnitsToPixels:n=0===Ta(n)?0:function(e,t){return Ia(Ta(e),t)}(n,ji.IN);break;case Qi.internalUnitsToDegrees:n=function(e,t){var n=1<arguments.length&&void 0!==t?t:{},r=n.round,i=void 0===r||r,a=n.decimalPlaces,o=void 0===a?2:a,s=n.units,l=void 0===s?ji.RAD:s,u=Number(e);return l===ji.RAD||l===ji.DA?u=360-180*u/Math.PI:l===ji.DEG||l===ji.AD&&0===u||wa.log('Implement unit type "'.concat(Fa(l),'" ("VisioUnitType.').concat(l,'")')),u%=360,i&&(u=Ci(u,o)),u}(n,{units:ji.RAD});break;case Qi.color:if(n.includes("#"));else if("Themed"===n)n="red";else{var o=Ta(n);n=this.archive.document._colors.get(o)}break;case Qi.asIs:break;default:wa.log("Unknown VisioConvertType",{cell:e,convertType:i,valueType:t})}return n}}},{key:"themedResolver",value:function(){return null}},{key:"getOwnNames",value:function(){return this.hasOwnProperty("_attributesSet")?yr(this._attributesSet.values()):[]}},{key:"get",value:function(e){var t=Ss(e);return this.hasOwnProperty(t)?this[t]:this["_".concat(t)]}},{key:"set",value:function(e,t,n){if(!n)return null;var r=e.charAt(0).toLowerCase()+e.slice(1),i=e.charAt(0).toUpperCase()+e.slice(1);void 0===zi[i]&&wa.log('Cell named "'.concat(i,'" is not supported.')),"object"===$n(t)&&null!==t||wa.log("Attributes are required to set a cell."),this.attributeSet(r),t=Zn(Zn({},t),{},{name:i});var a=Zn({},this["_".concat(r)]);if(Object.keys(t).forEach(function(e){void 0!==t[e]&&(null===t[e]?delete a[e]:a[e]=t[e].toString())}),this["_".concat(r)]=a,n&&"string"==typeof i){var o=n.Cell,s=o.findIndex(function(e){return e.hasOwnProperty(_i.Name)&&e[_i.Name].toLowerCase()===r.toLowerCase()}),l={};-1<s&&(l=o[s]),Object.keys(a).forEach(function(e){if(Ti[e]){if(void 0===t[e])return;null===t[e]?delete l[Ti[e]]:l[Ti[e]]=a[e]}}),-1<s?o[s]=l:o.push(l)}return a}},{key:"remove",value:function(t,e){if(this.attributeUnset(t),delete this["_".concat(t)],e&&Array.isArray(e.Cell)){var n=e.Cell,r=n.findIndex(function(e){return e.hasOwnProperty(_i.Name)&&e[_i.Name].toLowerCase()===t.toLowerCase()});-1<r&&n.splice(r,1)}}},{key:"shape",get:function(){return this._shape},set:function(e){this._shape=e}},{key:"jxon",get:function(){return this._jxon},set:function(e){this._jxon=e}},{key:"masterShape",get:function(){return this._masterShape},set:function(e){this._masterShape=e}},{key:"resolveCellValueByType",value:function(e,t){return e.value}},{key:"getParentCell",value:function(e){var t=this.parent;if(t&&t.cells)return t.cells.get(e)}},{key:"getStylesheetFillStyleCell",value:function(e){return this.getStylesheetCell(e,Ki.fillStyle)}},{key:"getStylesheetLineStyleCell",value:function(e){return this.getStylesheetCell(e,Ki.lineStyle)}},{key:"getStylesheetTextStyleCell",value:function(e){return this.getStylesheetCell(e,Ki.textStyle)}},{key:"getStylesheetCell",value:function(e,t){var n=this.shape,r=this.masterShape;if(n||r){var i;if(n){if(void 0===(i=n[t])){var a=this.shape.masterShape;a&&(i=a[t])}}else i=r[t];if(void 0!==i)return function e(t,n,r,i){var a=t.get(n);if(!a)return null;var o=a.cells;return o.has(i)?o.get(i):r in a?e(t,a[r],r,i):null}(this.archive.document.styleSheets,i,t,e);wa.log("styleSheetIndex undefined")}}},{key:"getSetValues",value:function(){var t=this,n={};return this.attributesSet.forEach(function(e){return n[e]=t[e]}),n}},{key:"getSetValuesMaster",value:function(){var e=this.shape.masterShape;if(!e)return null;var t=function(e){var t=!1,n={};return e.forEach(function(e){e.jxonType!==Pi.Shape?t&&(e.jxonType===Pi.Section&&(n.section=e),e.jxonType===Pi.Row&&(n.row=e)):t=!0}),n}(this.structurePath);if(!t.section||!t.row)return null;var n=e.sections.get(t.section.type)[t.section.index].rows.find(function(e){return e.index===t.row.index});if(!n)return null;var r=n.cells;return r?r===this?"exactly same":r.getSetValues():null}},{key:"directValues",get:function(){return this.debugGatherValues(yr(this.attributesSet))}},{key:"clone",value:function(){var n=this,e=this.structurePath.slice();e.unshift({jxonType:"clone"});var r=new this.constructor({archive:this.archive,structurePath:e});return this.attributesSet.forEach(function(e){var t=n.get(e);r[e]=Zn({},t),r.attributeSet(e)}),this.shape&&(r.shape=this.shape),this.masterShape&&(r.masterShape=this.masterShape),r}},{key:"debug",get:function(){var e={owner:this.owner,parent:this.parent,directValues:this.debugGatherValues(yr(this.attributesSet))};return this.shape&&(e.ownerShape=this.shape),this.parent&&(e.extendedValues=this.debugGatherValues([].concat(yr(this.attributesSet),yr(this.parent.cells.attributesSet)))),this.masterShape&&(e.ownerMasterShape=this.masterShape),e.stylesheetFill=this.debugGatherValues(["fillForegnd","fillBkgnd","fillPattern","fillForegndTrans","fillBkgndTrans"]),e.stylesheetLine=this.debugGatherValues(["lineColor","lineColorTrans","linePattern","lineWeight"]),e.stylesheetText=this.debugGatherValues(["bottomMargin","defaultTabStop","leftMargin","rightMargin","textBkgnd","textBkgndTrans","topMargin","verticalAlign"]),e.structurePath=this.structurePath,e}},{key:"debugGatherValues",value:function(e){var n=this;return e.reduce(function(e,t){return e[t]=n[t],e},{})}}]),n}(),El=function(){lr(t,Vl);var e=pr(t);function t(){return ir(this,t),e.apply(this,arguments)}return or(t,[{key:"a",get:function(){var e;switch(this.getRowType()){case Ji.ArcTo:case Ji.Ellipse:case Ji.EllipticalArcTo:case Ji.InfiniteLine:e=da;break;case Ji.NURBSTo:case Ji.RelCubBezTo:case Ji.RelEllipticalArcTo:case Ji.RelQuadBezTo:case Ji.SplineStart:case Ji.SplineKnot:e=ga;break;case Ji.PolylineTo:e=fa;break;default:wa.log("Incorrect cell type",{attributeName:"a",cells:this})}var t=this._a;return void 0===t&&(t=this.getParentCell("a")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("a"),this._a=e}},{key:"action",get:function(){var e=ga,t=this._action;return void 0===t&&(t=this.getParentCell("action")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("action"),this._action=e}},{key:"active",get:function(){var e=na,t=this._active;return void 0===t&&(t=this.getParentCell("active")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("active"),this._active=e}},{key:"addMarkup",get:function(){var e=na,t=this._addMarkup;return void 0===t&&(t=this.getParentCell("addMarkup")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("addMarkup"),this._addMarkup=e}},{key:"address",get:function(){var e=ra,t=this._address;return void 0===t&&(t=this.getParentCell("address")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("address"),this._address=e}},{key:"alignBottom",get:function(){var e=ga,t=this._alignBottom;return void 0===t&&(t=this.getParentCell("alignBottom")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("alignBottom"),this._alignBottom=e}},{key:"alignCenter",get:function(){var e=ga,t=this._alignCenter;return void 0===t&&(t=this.getParentCell("alignCenter")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("alignCenter"),this._alignCenter=e}},{key:"alignLeft",get:function(){var e=ga,t=this._alignLeft;return void 0===t&&(t=this.getParentCell("alignLeft")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("alignLeft"),this._alignLeft=e}},{key:"alignment",get:function(){var e=ga,t=this._alignment;return void 0===t&&(t=this.getParentCell("alignment")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("alignment"),this._alignment=e}},{key:"alignMiddle",get:function(){var e=ga,t=this._alignMiddle;return void 0===t&&(t=this.getParentCell("alignMiddle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("alignMiddle"),this._alignMiddle=e}},{key:"alignRight",get:function(){var e=ga,t=this._alignRight;return void 0===t&&(t=this.getParentCell("alignRight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("alignRight"),this._alignRight=e}},{key:"alignTop",get:function(){var e=ga,t=this._alignTop;return void 0===t&&(t=this.getParentCell("alignTop")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("alignTop"),this._alignTop=e}},{key:"angle",get:function(){var e=this._angle;void 0===e&&(e=this.getParentCell("angle"));var t=pa;return e&&e.units&&e.units!==ji.DEG&&"0"!==e.value&&wa.log("vAngle unclear"),void 0===e?this.getDefaultCellValue(t):this.resolveCellValue(e,t)},set:function(e){this.attributeSet("angle"),this._angle=e}},{key:"asianFont",get:function(){var e=ha,t=this._asianFont;return void 0===t&&(t=this.getParentCell("asianFont")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("asianFont"),this._asianFont=e}},{key:"autoGen",get:function(){var e=na,t=this._autoGen;return void 0===t&&(t=this.getParentCell("autoGen")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("autoGen"),this._autoGen=e}},{key:"avenueSizeX",get:function(){var e=ga,t=this._avenueSizeX;return void 0===t&&(t=this.getParentCell("avenueSizeX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("avenueSizeX"),this._avenueSizeX=e}},{key:"avenueSizeY",get:function(){var e=ga,t=this._avenueSizeY;return void 0===t&&(t=this.getParentCell("avenueSizeY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("avenueSizeY"),this._avenueSizeY=e}},{key:"avoidPageBreaks",get:function(){var e=na,t=this._avoidPageBreaks;return void 0===t&&(t=this.getParentCell("avoidPageBreaks")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("avoidPageBreaks"),this._avoidPageBreaks=e}},{key:"b",get:function(){var e;if(this.isDescendantOfSectionType([Ui.Scratch]))e=fa;else switch(this.getRowType()){case Ji.Ellipse:case Ji.EllipticalArcTo:case Ji.InfiniteLine:e=da;break;case Ji.NURBSTo:case Ji.RelCubBezTo:case Ji.RelEllipticalArcTo:case Ji.RelQuadBezTo:case Ji.SplineStart:e=ga;break;default:wa.log("Incorrect cell type",{attributeName:"a",cells:this})}var t=this._b;return void 0===t&&(t=this.getParentCell("b")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("b"),this._b=e}},{key:"beginArrow",get:function(){var e=ta,t=this._beginArrow;return void 0===t&&(t=this.getParentCell("beginArrow")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("beginArrow"),this._beginArrow=e}},{key:"beginArrowSize",get:function(){var e=ta,t=this._beginArrowSize;return void 0===t&&(t=this.getParentCell("beginArrowSize")),void 0===t?2:this.resolveCellValue(t,e)},set:function(e){this.attributeSet("beginArrowSize"),this._beginArrowSize=e}},{key:"beginGroup",get:function(){var e=na,t=this._beginGroup;return void 0===t&&(t=this.getParentCell("beginGroup")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("beginGroup"),this._beginGroup=e}},{key:"beginX",get:function(){var e=da,t=this._beginX;return void 0===t&&(t=this.getParentCell("beginX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("beginX"),this._beginX=e}},{key:"beginY",get:function(){var e=da,t=this._beginY;return void 0===t&&(t=this.getParentCell("beginY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("beginY"),this._beginY=e}},{key:"begTrigger",get:function(){var e=ta,t=this._begTrigger;return void 0===t&&(t=this.getParentCell("begTrigger")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("begTrigger"),this._begTrigger=e}},{key:"bevelBottomHeight",get:function(){var e=da,t=this._bevelBottomHeight;return void 0===t&&(t=this.getParentCell("bevelBottomHeight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelBottomHeight"),this._bevelBottomHeight=e}},{key:"bevelBottomType",get:function(){var e=ta,t=this._bevelBottomType;return void 0===t&&(t=this.getParentCell("bevelBottomType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelBottomType"),this._bevelBottomType=e}},{key:"bevelBottomWidth",get:function(){var e=da,t=this._bevelBottomWidth;return void 0===t&&(t=this.getParentCell("bevelBottomWidth")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelBottomWidth"),this._bevelBottomWidth=e}},{key:"bevelContourColor",get:function(){var e=ia,t=this._bevelContourColor;return void 0===t&&(t=this.getParentCell("bevelContourColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelContourColor"),this._bevelContourColor=e}},{key:"bevelContourSize",get:function(){var e=da,t=this._bevelContourSize;return void 0===t&&(t=this.getParentCell("bevelContourSize")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelContourSize"),this._bevelContourSize=e}},{key:"bevelDepthColor",get:function(){var e=ia,t=this._bevelDepthColor;return void 0===t&&(t=this.getParentCell("bevelDepthColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelDepthColor"),this._bevelDepthColor=e}},{key:"bevelDepthSize",get:function(){var e=da,t=this._bevelDepthSize;return void 0===t&&(t=this.getParentCell("bevelDepthSize")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelDepthSize"),this._bevelDepthSize=e}},{key:"bevelLightingAngle",get:function(){var e=ga,t=this._bevelLightingAngle;return void 0===t&&(t=this.getParentCell("bevelLightingAngle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelLightingAngle"),this._bevelLightingAngle=e}},{key:"bevelLightingType",get:function(){var e=ta,t=this._bevelLightingType;return void 0===t&&(t=this.getParentCell("bevelLightingType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelLightingType"),this._bevelLightingType=e}},{key:"bevelMaterialType",get:function(){var e=ta,t=this._bevelMaterialType;return void 0===t&&(t=this.getParentCell("bevelMaterialType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelMaterialType"),this._bevelMaterialType=e}},{key:"bevelTopHeight",get:function(){var e=da,t=this._bevelTopHeight;return void 0===t&&(t=this.getParentCell("bevelTopHeight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelTopHeight"),this._bevelTopHeight=e}},{key:"bevelTopType",get:function(){var e=ta,t=this._bevelTopType;return void 0===t&&(t=this.getParentCell("bevelTopType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelTopType"),this._bevelTopType=e}},{key:"bevelTopWidth",get:function(){var e=da,t=this._bevelTopWidth;return void 0===t&&(t=this.getParentCell("bevelTopWidth")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelTopWidth"),this._bevelTopWidth=e}},{key:"blockSizeX",get:function(){var e=ga,t=this._blockSizeX;return void 0===t&&(t=this.getParentCell("blockSizeX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("blockSizeX"),this._blockSizeX=e}},{key:"blockSizeY",get:function(){var e=ga,t=this._blockSizeY;return void 0===t&&(t=this.getParentCell("blockSizeY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("blockSizeY"),this._blockSizeY=e}},{key:"blur",get:function(){var e=ga,t=this._blur;return void 0===t&&(t=this.getParentCell("blur")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("blur"),this._blur=e}},{key:"bottomMargin",get:function(){var e=da,t=this._bottomMargin;return void 0===t&&(t=this.getParentCell("bottomMargin")),void 0===t&&(t=this.getStylesheetTextStyleCell("bottomMargin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bottomMargin"),this._bottomMargin=e}},{key:"brightness",get:function(){var e=ga,t=this._brightness;return void 0===t&&(t=this.getParentCell("brightness")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("brightness"),this._brightness=e}},{key:"bullet",get:function(){var e=ta,t=this._bullet;return void 0===t&&(t=this.getParentCell("bullet")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bullet"),this._bullet=e}},{key:"bulletFont",get:function(){var e=ha,t=this._bulletFont;return void 0===t&&(t=this.getParentCell("bulletFont")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bulletFont"),this._bulletFont=e}},{key:"bulletFontSize",get:function(){var e=da,t=this._bulletFontSize;return void 0===t&&(t=this.getParentCell("bulletFontSize")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bulletFontSize"),this._bulletFontSize=e}},{key:"bulletStr",get:function(){var e=ra,t=this._bulletStr;return void 0===t&&(t=this.getParentCell("bulletStr")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bulletStr"),this._bulletStr=e}},{key:"buttonFace",get:function(){var e=ra,t=this._buttonFace;return void 0===t&&(t=this.getParentCell("buttonFace")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("buttonFace"),this._buttonFace=e}},{key:"c",get:function(){var e;if(this.isDescendantOfSectionType([Ui.Scratch]))e=fa;else switch(this.getRowType()){case Ji.Ellipse:e=da;break;case Ji.EllipticalArcTo:case Ji.RelEllipticalArcTo:e=pa;break;case Ji.NURBSTo:case Ji.RelCubBezTo:case Ji.SplineStart:e=ga;break;default:wa.log("Incorrect cell type",{attributeName:"c",cells:this})}var t=this._c;return void 0===t&&(t=this.getParentCell("c")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("c"),this._c=e}},{key:"calendar",get:function(){var e=ga,t=this._calendar;return void 0===t&&(t=this.getParentCell("calendar")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("calendar"),this._calendar=e}},{key:"canGlue",get:function(){var e=na,t=this._canGlue;return void 0===t&&(t=this.getParentCell("canGlue")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("canGlue"),this._canGlue=e}},{key:"uppercase",get:function(){var e=ta,t=this._uppercase;return void 0===t&&(t=this.getParentCell("uppercase")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("uppercase"),this._uppercase=e}},{key:"centerX",get:function(){var e=na,t=this._centerX;return void 0===t&&(t=this.getParentCell("centerX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("centerX"),this._centerX=e}},{key:"centerY",get:function(){var e=na,t=this._centerY;return void 0===t&&(t=this.getParentCell("centerY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("centerY"),this._centerY=e}},{key:"checked",get:function(){var e=na,t=this._checked;return void 0===t&&(t=this.getParentCell("checked")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("checked"),this._checked=e}},{key:"clippingPath",get:function(){var e=ra,t=this._clippingPath;return void 0===t&&(t=this.getParentCell("clippingPath")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("clippingPath"),this._clippingPath=e}},{key:"color",get:function(){var e=ia,t=this._color;return void 0===t&&(t=this.getParentCell("color")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("color"),this._color=e}},{key:"colorSchemeIndex",get:function(){var e=ta,t=this._colorSchemeIndex;return void 0===t&&(t=this.getParentCell("colorSchemeIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("colorSchemeIndex"),this._colorSchemeIndex=e}},{key:"colorTrans",get:function(){var e=ga,t=this._colorTrans;return void 0===t&&(t=this.getParentCell("colorTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("colorTrans"),this._colorTrans=e}},{key:"comment",get:function(){var e=ra,t=this._comment;return void 0===t&&(t=this.getParentCell("comment")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("comment"),this._comment=e}},{key:"complexScriptFont",get:function(){var e=ha,t=this._complexScriptFont;return void 0===t&&(t=this.getParentCell("complexScriptFont")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("complexScriptFont"),this._complexScriptFont=e}},{key:"complexScriptSize",get:function(){var e=da,t=this._complexScriptSize;if(void 0===t&&(t=this.getParentCell("complexScriptSize")),void 0!==t){var n=Ta(t.value);return 0===n?this.size:n<0?-n*this.size:this.resolveCellValue(t,e)}},set:function(e){this.attributeSet("complexScriptSize"),this._complexScriptSize=e}},{key:"compoundType",get:function(){var e=ta,t=this._compoundType;return void 0===t&&(t=this.getParentCell("compoundType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("compoundType"),this._compoundType=e}},{key:"conFixedCode",get:function(){var e=ta,t=this._conFixedCode;return void 0===t&&(t=this.getParentCell("conFixedCode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("conFixedCode"),this._conFixedCode=e}},{key:"conLineJumpCode",get:function(){var e=ta,t=this._conLineJumpCode;return void 0===t&&(t=this.getParentCell("conLineJumpCode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("conLineJumpCode"),this._conLineJumpCode=e}},{key:"conLineJumpDirX",get:function(){var e=ta,t=this._conLineJumpDirX;return void 0===t&&(t=this.getParentCell("conLineJumpDirX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("conLineJumpDirX"),this._conLineJumpDirX=e}},{key:"conLineJumpDirY",get:function(){var e=ta,t=this._conLineJumpDirY;return void 0===t&&(t=this.getParentCell("conLineJumpDirY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("conLineJumpDirY"),this._conLineJumpDirY=e}},{key:"conLineJumpStyle",get:function(){var e=ta,t=this._conLineJumpStyle;return void 0===t&&(t=this.getParentCell("conLineJumpStyle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("conLineJumpStyle"),this._conLineJumpStyle=e}},{key:"conLineRouteExt",get:function(){var e=ta,t=this._conLineRouteExt;return void 0===t&&(t=this.getParentCell("conLineRouteExt")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("conLineRouteExt"),this._conLineRouteExt=e}},{key:"connectorSchemeIndex",get:function(){var e=ta,t=this._connectorSchemeIndex;return void 0===t&&(t=this.getParentCell("connectorSchemeIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("connectorSchemeIndex"),this._connectorSchemeIndex=e}},{key:"contrast",get:function(){var e=ga,t=this._contrast;return void 0===t&&(t=this.getParentCell("contrast")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("contrast"),this._contrast=e}},{key:"copyright",get:function(){var e=ra,t=this._copyright;return void 0===t&&(t=this.getParentCell("copyright")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("copyright"),this._copyright=e}},{key:"ctrlAsInput",get:function(){var e=na,t=this._ctrlAsInput;return void 0===t&&(t=this.getParentCell("ctrlAsInput")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("ctrlAsInput"),this._ctrlAsInput=e}},{key:"currentIndex",get:function(){var e=aa,t=this._currentIndex;return void 0===t&&(t=this.getParentCell("currentIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("currentIndex"),this._currentIndex=e}},{key:"d",get:function(){var e;if(this.isDescendantOfSectionType([Ui.Scratch]))e=fa;else switch(this.getRowType()){case Ji.Ellipse:e=da;break;case Ji.EllipticalArcTo:case Ji.RelCubBezTo:case Ji.RelEllipticalArcTo:case Ji.NURBSTo:case Ji.SplineStart:e=ga;break;default:wa.log("Incorrect cell type",{attributeName:"d",cells:this})}var t=this._d;return void 0===t&&(t=this.getParentCell("d")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("d"),this._d=e}},{key:"dataLinked",get:function(){var e=na,t=this._dataLinked;return void 0===t&&(t=this.getParentCell("dataLinked")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("dataLinked"),this._dataLinked=e}},{key:"dblUnderline",get:function(){var e=na,t=this._dblUnderline;return void 0===t&&(t=this.getParentCell("dblUnderline")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("dblUnderline"),this._dblUnderline=e}},{key:"__default",get:function(){var e=na,t=this.___default;return void 0===t&&(t=this.getParentCell("__default")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("__default"),this.___default=e}},{key:"defaultTabStop",get:function(){var e=da,t=this._defaultTabStop;return void 0===t&&(t=this.getParentCell("defaultTabStop")),void 0===t&&(t=this.getStylesheetTextStyleCell("defaultTabStop")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("defaultTabStop"),this._defaultTabStop=e}},{key:"denoise",get:function(){var e=ga,t=this._denoise;return void 0===t&&(t=this.getParentCell("denoise")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("denoise"),this._denoise=e}},{key:"description",get:function(){var e=ra,t=this._description;return void 0===t&&(t=this.getParentCell("description")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("description"),this._description=e}},{key:"dirX",get:function(){var e=da,t=this._dirX;return void 0===t&&(t=this.getParentCell("dirX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("dirX"),this._dirX=e}},{key:"dirY",get:function(){var e=da,t=this._dirY;return void 0===t&&(t=this.getParentCell("dirY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("dirY"),this._dirY=e}},{key:"disabled",get:function(){var e=na,t=this._disabled;return void 0===t&&(t=this.getParentCell("disabled")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("disabled"),this._disabled=e}},{key:"displayLevel",get:function(){var e=sa,t=this._displayLevel;return void 0===t&&(t=this.getParentCell("displayLevel")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("displayLevel"),this._displayLevel=e}},{key:"displayMode",get:function(){var e=ta,t=this._displayMode;return void 0===t&&(t=this.getParentCell("displayMode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("displayMode"),this._displayMode=e}},{key:"distanceFromGround",get:function(){var e=da,t=this._distanceFromGround;return void 0===t&&(t=this.getParentCell("distanceFromGround")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("distanceFromGround"),this._distanceFromGround=e}},{key:"docLangID",get:function(){var e=ca,t=this._docLangID;return void 0===t&&(t=this.getParentCell("docLangID")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("docLangID"),this._docLangID=e}},{key:"docLockDuplicatePage",get:function(){var e=na,t=this._docLockDuplicatePage;return void 0===t&&(t=this.getParentCell("docLockDuplicatePage")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("docLockDuplicatePage"),this._docLockDuplicatePage=e}},{key:"docLockReplace",get:function(){var e=na,t=this._docLockReplace;return void 0===t&&(t=this.getParentCell("docLockReplace")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("docLockReplace"),this._docLockReplace=e}},{key:"dontMoveChildren",get:function(){var e=na,t=this._dontMoveChildren;return void 0===t&&(t=this.getParentCell("dontMoveChildren")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("dontMoveChildren"),this._dontMoveChildren=e}},{key:"doubleStrikethrough",get:function(){var e=na,t=this._doubleStrikethrough;return void 0===t&&(t=this.getParentCell("doubleStrikethrough")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("doubleStrikethrough"),this._doubleStrikethrough=e}},{key:"drawingResizeType",get:function(){var e=ta,t=this._drawingResizeType;return void 0===t&&(t=this.getParentCell("drawingResizeType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("drawingResizeType"),this._drawingResizeType=e}},{key:"drawingScale",get:function(){var e=da,t=this._drawingScale;return void 0===t&&(t=this.getParentCell("drawingScale")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("drawingScale"),this._drawingScale=e}},{key:"drawingScaleType",get:function(){var e=ta,t=this._drawingScaleType;return void 0===t&&(t=this.getParentCell("drawingScaleType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("drawingScaleType"),this._drawingScaleType=e}},{key:"drawingSizeType",get:function(){var e=ta,t=this._drawingSizeType;return void 0===t&&(t=this.getParentCell("drawingSizeType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("drawingSizeType"),this._drawingSizeType=e}},{key:"dropOnPageScale",get:function(){var e=ga,t=this._dropOnPageScale;return void 0===t&&(t=this.getParentCell("dropOnPageScale")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("dropOnPageScale"),this._dropOnPageScale=e}},{key:"dynamicsOff",get:function(){var e=na,t=this._dynamicsOff;return void 0===t&&(t=this.getParentCell("dynamicsOff")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("dynamicsOff"),this._dynamicsOff=e}},{key:"dynFeedback",get:function(){var e=ta,t=this._dynFeedback;return void 0===t&&(t=this.getParentCell("dynFeedback")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("dynFeedback"),this._dynFeedback=e}},{key:"e",get:function(){var e=ma,t=this._e;return void 0===t&&(t=this.getParentCell("e")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("e"),this._e=e}},{key:"effectSchemeIndex",get:function(){var e=ta,t=this._effectSchemeIndex;return void 0===t&&(t=this.getParentCell("effectSchemeIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("effectSchemeIndex"),this._effectSchemeIndex=e}},{key:"embellishmentIndex",get:function(){var e=sa,t=this._embellishmentIndex;return void 0===t&&(t=this.getParentCell("embellishmentIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("embellishmentIndex"),this._embellishmentIndex=e}},{key:"enableFillProps",get:function(){var e=na,t=this._enableFillProps;return void 0===t&&(t=this.getParentCell("enableFillProps")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("enableFillProps"),this._enableFillProps=e}},{key:"enableGrid",get:function(){var e=na,t=this._enableGrid;return void 0===t&&(t=this.getParentCell("enableGrid")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("enableGrid"),this._enableGrid=e}},{key:"enableLineProps",get:function(){var e=na,t=this._enableLineProps;return void 0===t&&(t=this.getParentCell("enableLineProps")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("enableLineProps"),this._enableLineProps=e}},{key:"enableTextProps",get:function(){var e=na,t=this._enableTextProps;return void 0===t&&(t=this.getParentCell("enableTextProps")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("enableTextProps"),this._enableTextProps=e}},{key:"endArrow",get:function(){var e=ta,t=this._endArrow;return void 0===t&&(t=this.getParentCell("endArrow")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("endArrow"),this._endArrow=e}},{key:"endArrowSize",get:function(){var e=ta,t=this._endArrowSize;return void 0===t&&(t=this.getParentCell("endArrowSize")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("endArrowSize"),this._endArrowSize=e}},{key:"endTrigger",get:function(){var e=ta,t=this._endTrigger;return void 0===t&&(t=this.getParentCell("endTrigger")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("endTrigger"),this._endTrigger=e}},{key:"endX",get:function(){var e=da,t=this._endX;return void 0===t&&(t=this.getParentCell("endX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("endX"),this._endX=e}},{key:"endY",get:function(){var e=da,t=this._endY;return void 0===t&&(t=this.getParentCell("endY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("endY"),this._endY=e}},{key:"eventDblClick",get:function(){var e=ga,t=this._eventDblClick;return void 0===t&&(t=this.getParentCell("eventDblClick")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("eventDblClick"),this._eventDblClick=e}},{key:"eventDrop",get:function(){var e=ga,t=this._eventDrop;return void 0===t&&(t=this.getParentCell("eventDrop")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("eventDrop"),this._eventDrop=e}},{key:"eventMultiDrop",get:function(){var e=ga,t=this._eventMultiDrop;return void 0===t&&(t=this.getParentCell("eventMultiDrop")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("eventMultiDrop"),this._eventMultiDrop=e}},{key:"eventXFMod",get:function(){var e=ga,t=this._eventXFMod;return void 0===t&&(t=this.getParentCell("eventXFMod")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("eventXFMod"),this._eventXFMod=e}},{key:"extraInfo",get:function(){var e=ra,t=this._extraInfo;return void 0===t&&(t=this.getParentCell("extraInfo")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("extraInfo"),this._extraInfo=e}},{key:"fillBkgnd",get:function(){var e=va,t=this._fillBkgnd;return void 0===t&&(t=this.getParentCell("fillBkgnd")),void 0===t&&(t=this.getStylesheetFillStyleCell("fillBkgnd")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fillBkgnd"),this._fillBkgnd=e}},{key:"fillBkgndTrans",get:function(){var e=ga,t=this._fillBkgndTrans;return void 0===t&&(t=this.getParentCell("fillBkgndTrans")),void 0===t&&(t=this.getStylesheetFillStyleCell("fillBkgndTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fillBkgndTrans"),this._fillBkgndTrans=e}},{key:"fillForegnd",get:function(){var e=va,t=this._fillForegnd;return void 0===t&&(t=this.getParentCell("fillForegnd")),void 0===t&&(t=this.getStylesheetFillStyleCell("fillForegnd")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fillForegnd"),this._fillForegnd=e}},{key:"fillForegndTrans",get:function(){var e=ga,t=this._fillForegndTrans;return void 0===t&&(t=this.getParentCell("fillForegndTrans")),void 0===t&&(t=this.getStylesheetFillStyleCell("fillForegndTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fillForegndTrans"),this._fillForegndTrans=e}},{key:"fillGradientAngle",get:function(){var e=pa,t=this._fillGradientAngle;return void 0===t&&(t=this.getParentCell("fillGradientAngle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fillGradientAngle"),this._fillGradientAngle=e}},{key:"fillGradientDir",get:function(){var e=ta,t=this._fillGradientDir;return void 0===t&&(t=this.getParentCell("fillGradientDir")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fillGradientDir"),this._fillGradientDir=e}},{key:"fillGradientEnabled",get:function(){var e=na,t=this._fillGradientEnabled;return void 0===t&&(t=this.getParentCell("fillGradientEnabled")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fillGradientEnabled"),this._fillGradientEnabled=e}},{key:"fillPattern",get:function(){var e=ta,t=this._fillPattern;return void 0===t&&(t=this.getParentCell("fillPattern")),void 0===t&&(t=this.getStylesheetFillStyleCell("fillPattern")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fillPattern"),this._fillPattern=e}},{key:"flags",get:function(){var e=ta,t=this._flags;return void 0===t&&(t=this.getParentCell("flags")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("flags"),this._flags=e}},{key:"flipX",get:function(){var e=ga,t=this._flipX;return void 0===t&&(t=this.getParentCell("flipX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("flipX"),this._flipX=e}},{key:"flipY",get:function(){var e=ga,t=this._flipY;return void 0===t&&(t=this.getParentCell("flipY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("flipY"),this._flipY=e}},{key:"flyoutChild",get:function(){var e=na,t=this._flyoutChild;return void 0===t&&(t=this.getParentCell("flyoutChild")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("flyoutChild"),this._flyoutChild=e}},{key:"font",get:function(){var e=ha,t=this._font;return void 0===t&&(t=this.getParentCell("font")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("font"),this._font=e}},{key:"fontScale",get:function(){var e=ga,t=this._fontScale;return void 0===t&&(t=this.getParentCell("fontScale")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fontScale"),this._fontScale=e}},{key:"fontSchemeIndex",get:function(){var e=ta,t=this._fontSchemeIndex;return void 0===t&&(t=this.getParentCell("fontSchemeIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fontSchemeIndex"),this._fontSchemeIndex=e}},{key:"format",get:function(){var e=ya,t=this._format;return void 0===t&&(t=this.getParentCell("format")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("format"),this._format=e}},{key:"frame",get:function(){var e=ra,t=this._frame;return void 0===t&&(t=this.getParentCell("frame")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("frame"),this._frame=e}},{key:"gamma",get:function(){var e=ga,t=this._gamma;return void 0===t&&(t=this.getParentCell("gamma")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("gamma"),this._gamma=e}},{key:"glowColor",get:function(){var e=va,t=this._glowColor;return void 0===t&&(t=this.getParentCell("glowColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("glowColor"),this._glowColor=e}},{key:"glowColorTrans",get:function(){var e=ga,t=this._glowColorTrans;return void 0===t&&(t=this.getParentCell("glowColorTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("glowColorTrans"),this._glowColorTrans=e}},{key:"glowSize",get:function(){var e=da,t=this._glowSize;return void 0===t&&(t=this.getParentCell("glowSize")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("glowSize"),this._glowSize=e}},{key:"glue",get:function(){var e=na,t=this._glue;return void 0===t&&(t=this.getParentCell("glue")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("glue"),this._glue=e}},{key:"glueType",get:function(){var e=ta,t=this._glueType;return void 0===t&&(t=this.getParentCell("glueType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("glueType"),this._glueType=e}},{key:"gradientStopColor",get:function(){var e=va,t=this._gradientStopColor;return void 0===t&&(t=this.getParentCell("gradientStopColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("gradientStopColor"),this._gradientStopColor=e}},{key:"gradientStopColorTrans",get:function(){var e=ga,t=this._gradientStopColorTrans;return void 0===t&&(t=this.getParentCell("gradientStopColorTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("gradientStopColorTrans"),this._gradientStopColorTrans=e}},{key:"gradientStopPosition",get:function(){var e=ga,t=this._gradientStopPosition;return void 0===t&&(t=this.getParentCell("gradientStopPosition")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("gradientStopPosition"),this._gradientStopPosition=e}},{key:"height",get:function(){var e=da,t=this._height;return void 0===t&&(t=this.getParentCell("height")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("height"),this._height=e}},{key:"helpTopic",get:function(){var e=ra,t=this._helpTopic;return void 0===t&&(t=this.getParentCell("helpTopic")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("helpTopic"),this._helpTopic=e}},{key:"hideForApply",get:function(){var e=na,t=this._hideForApply;return void 0===t&&(t=this.getParentCell("hideForApply")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("hideForApply"),this._hideForApply=e}},{key:"hideText",get:function(){var e=ga,t=this._hideText;return void 0===t&&(t=this.getParentCell("hideText")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("hideText"),this._hideText=e}},{key:"horzAlign",get:function(){var e=ta,t=this._horzAlign;return void 0===t&&(t=this.getParentCell("horzAlign")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("horzAlign"),this._horzAlign=e}},{key:"imgHeight",get:function(){var e=da,t=this._imgHeight;return void 0===t&&(t=this.getParentCell("imgHeight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("imgHeight"),this._imgHeight=e}},{key:"imgOffsetX",get:function(){var e=da,t=this._imgOffsetX;return void 0===t&&(t=this.getParentCell("imgOffsetX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("imgOffsetX"),this._imgOffsetX=e}},{key:"imgOffsetY",get:function(){var e=da,t=this._imgOffsetY;return void 0===t&&(t=this.getParentCell("imgOffsetY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("imgOffsetY"),this._imgOffsetY=e}},{key:"imgWidth",get:function(){var e=da,t=this._imgWidth;return void 0===t&&(t=this.getParentCell("imgWidth")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("imgWidth"),this._imgWidth=e}},{key:"indFirst",get:function(){var e=da,t=this._indFirst;return void 0===t&&(t=this.getParentCell("indFirst")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("indFirst"),this._indFirst=e}},{key:"indLeft",get:function(){var e=da,t=this._indLeft;return void 0===t&&(t=this.getParentCell("indLeft")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("indLeft"),this._indLeft=e}},{key:"indRight",get:function(){var e=da,t=this._indRight;return void 0===t&&(t=this.getParentCell("indRight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("indRight"),this._indRight=e}},{key:"inhibitSnap",get:function(){var e=na,t=this._inhibitSnap;return void 0===t&&(t=this.getParentCell("inhibitSnap")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("inhibitSnap"),this._inhibitSnap=e}},{key:"initials",get:function(){var e=ra,t=this._initials;return void 0===t&&(t=this.getParentCell("initials")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("initials"),this._initials=e}},{key:"invisible",get:function(){var e=na,t=this._invisible;return void 0===t&&(t=this.getParentCell("invisible")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("invisible"),this._invisible=e}},{key:"isDropSource",get:function(){var e=na,t=this._isDropSource;return void 0===t&&(t=this.getParentCell("isDropSource")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("isDropSource"),this._isDropSource=e}},{key:"isDropTarget",get:function(){var e=na,t=this._isDropTarget;return void 0===t&&(t=this.getParentCell("isDropTarget")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("isDropTarget"),this._isDropTarget=e}},{key:"isSnapTarget",get:function(){var e=na,t=this._isSnapTarget;return void 0===t&&(t=this.getParentCell("isSnapTarget")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("isSnapTarget"),this._isSnapTarget=e}},{key:"isTextEditTarget",get:function(){var e=na,t=this._isTextEditTarget;return void 0===t&&(t=this.getParentCell("isTextEditTarget")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("isTextEditTarget"),this._isTextEditTarget=e}},{key:"keepTextFlat",get:function(){var e=na,t=this._keepTextFlat;return void 0===t&&(t=this.getParentCell("keepTextFlat")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("keepTextFlat"),this._keepTextFlat=e}},{key:"label",get:function(){var e=ra,t=this._label;return void 0===t&&(t=this.getParentCell("label")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("label"),this._label=e}},{key:"langID",get:function(){var e=ca,t=this._langID;return void 0===t&&(t=this.getParentCell("langID")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("langID"),this._langID=e}},{key:"layerMember",get:function(){var e=ra,t=this._layerMember;return void 0===t&&(t=this.getParentCell("layerMember")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("layerMember"),this._layerMember=e}},{key:"leftMargin",get:function(){var e=da,t=this._leftMargin;return void 0===t&&(t=this.getParentCell("leftMargin")),void 0===t&&(t=this.getStylesheetTextStyleCell("leftMargin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("leftMargin"),this._leftMargin=e}},{key:"letterspace",get:function(){var e=da,t=this._letterspace;return void 0===t&&(t=this.getParentCell("letterspace")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("letterspace"),this._letterspace=e}},{key:"lineAdjustFrom",get:function(){var e=ta,t=this._lineAdjustFrom;return void 0===t&&(t=this.getParentCell("lineAdjustFrom")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineAdjustFrom"),this._lineAdjustFrom=e}},{key:"lineAdjustTo",get:function(){var e=ta,t=this._lineAdjustTo;return void 0===t&&(t=this.getParentCell("lineAdjustTo")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineAdjustTo"),this._lineAdjustTo=e}},{key:"lineCap",get:function(){var e=ta,t=this._lineCap;return void 0===t&&(t=this.getParentCell("lineCap")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineCap"),this._lineCap=e}},{key:"lineColor",get:function(){var e=va,t=this._lineColor;return void 0===t&&(t=this.getParentCell("lineColor")),void 0===t&&(t=this.getStylesheetLineStyleCell("lineColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineColor"),this._lineColor=e}},{key:"lineColorTrans",get:function(){var e=ga,t=this._lineColorTrans;return void 0===t&&(t=this.getParentCell("lineColorTrans")),void 0===t&&(t=this.getStylesheetLineStyleCell("lineColorTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineColorTrans"),this._lineColorTrans=e}},{key:"lineGradientAngle",get:function(){var e=pa,t=this._lineGradientAngle;return void 0===t&&(t=this.getParentCell("lineGradientAngle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineGradientAngle"),this._lineGradientAngle=e}},{key:"lineGradientDir",get:function(){var e=ta,t=this._lineGradientDir;return void 0===t&&(t=this.getParentCell("lineGradientDir")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineGradientDir"),this._lineGradientDir=e}},{key:"lineGradientEnabled",get:function(){var e=na,t=this._lineGradientEnabled;return void 0===t&&(t=this.getParentCell("lineGradientEnabled")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineGradientEnabled"),this._lineGradientEnabled=e}},{key:"lineJumpCode",get:function(){var e=ta,t=this._lineJumpCode;return void 0===t&&(t=this.getParentCell("lineJumpCode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineJumpCode"),this._lineJumpCode=e}},{key:"lineJumpFactorX",get:function(){var e=ga,t=this._lineJumpFactorX;return void 0===t&&(t=this.getParentCell("lineJumpFactorX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineJumpFactorX"),this._lineJumpFactorX=e}},{key:"lineJumpFactorY",get:function(){var e=ga,t=this._lineJumpFactorY;return void 0===t&&(t=this.getParentCell("lineJumpFactorY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineJumpFactorY"),this._lineJumpFactorY=e}},{key:"lineJumpStyle",get:function(){var e=ta,t=this._lineJumpStyle;return void 0===t&&(t=this.getParentCell("lineJumpStyle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineJumpStyle"),this._lineJumpStyle=e}},{key:"linePattern",get:function(){var e=ta,t=this._linePattern;return void 0===t&&(t=this.getParentCell("linePattern")),void 0===t&&(t=this.getStylesheetLineStyleCell("linePattern")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("linePattern"),this._linePattern=e}},{key:"lineRouteExt",get:function(){var e=ta,t=this._lineRouteExt;return void 0===t&&(t=this.getParentCell("lineRouteExt")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineRouteExt"),this._lineRouteExt=e}},{key:"lineToLineX",get:function(){var e=ga,t=this._lineToLineX;return void 0===t&&(t=this.getParentCell("lineToLineX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineToLineX"),this._lineToLineX=e}},{key:"lineToLineY",get:function(){var e=ga,t=this._lineToLineY;return void 0===t&&(t=this.getParentCell("lineToLineY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineToLineY"),this._lineToLineY=e}},{key:"lineToNodeX",get:function(){var e=ga,t=this._lineToNodeX;return void 0===t&&(t=this.getParentCell("lineToNodeX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineToNodeX"),this._lineToNodeX=e}},{key:"lineToNodeY",get:function(){var e=ga,t=this._lineToNodeY;return void 0===t&&(t=this.getParentCell("lineToNodeY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineToNodeY"),this._lineToNodeY=e}},{key:"lineWeight",get:function(){var e=da,t=this._lineWeight;return void 0===t&&(t=this.getParentCell("lineWeight")),void 0===t&&(t=this.getStylesheetLineStyleCell("lineWeight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineWeight"),this._lineWeight=e}},{key:"localizeMerge",get:function(){var e=na,t=this._localizeMerge;return void 0===t&&(t=this.getParentCell("localizeMerge")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("localizeMerge"),this._localizeMerge=e}},{key:"lock",get:function(){var e=na,t=this._lock;return void 0===t&&(t=this.getParentCell("lock")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lock"),this._lock=e}},{key:"lockAspect",get:function(){var e=na,t=this._lockAspect;return void 0===t&&(t=this.getParentCell("lockAspect")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockAspect"),this._lockAspect=e}},{key:"lockBegin",get:function(){var e=na,t=this._lockBegin;return void 0===t&&(t=this.getParentCell("lockBegin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockBegin"),this._lockBegin=e}},{key:"lockCalcWH",get:function(){var e=na,t=this._lockCalcWH;return void 0===t&&(t=this.getParentCell("lockCalcWH")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockCalcWH"),this._lockCalcWH=e}},{key:"lockCrop",get:function(){var e=na,t=this._lockCrop;return void 0===t&&(t=this.getParentCell("lockCrop")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockCrop"),this._lockCrop=e}},{key:"lockCustProp",get:function(){var e=na,t=this._lockCustProp;return void 0===t&&(t=this.getParentCell("lockCustProp")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockCustProp"),this._lockCustProp=e}},{key:"lockDelete",get:function(){var e=na,t=this._lockDelete;return void 0===t&&(t=this.getParentCell("lockDelete")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockDelete"),this._lockDelete=e}},{key:"lockEnd",get:function(){var e=na,t=this._lockEnd;return void 0===t&&(t=this.getParentCell("lockEnd")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockEnd"),this._lockEnd=e}},{key:"lockFormat",get:function(){var e=na,t=this._lockFormat;return void 0===t&&(t=this.getParentCell("lockFormat")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockFormat"),this._lockFormat=e}},{key:"lockFromGroupFormat",get:function(){var e=na,t=this._lockFromGroupFormat;return void 0===t&&(t=this.getParentCell("lockFromGroupFormat")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockFromGroupFormat"),this._lockFromGroupFormat=e}},{key:"lockGroup",get:function(){var e=na,t=this._lockGroup;return void 0===t&&(t=this.getParentCell("lockGroup")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockGroup"),this._lockGroup=e}},{key:"lockHeight",get:function(){var e=na,t=this._lockHeight;return void 0===t&&(t=this.getParentCell("lockHeight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockHeight"),this._lockHeight=e}},{key:"lockMoveX",get:function(){var e=na,t=this._lockMoveX;return void 0===t&&(t=this.getParentCell("lockMoveX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockMoveX"),this._lockMoveX=e}},{key:"lockMoveY",get:function(){var e=na,t=this._lockMoveY;return void 0===t&&(t=this.getParentCell("lockMoveY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockMoveY"),this._lockMoveY=e}},{key:"lockPreview",get:function(){var e=na,t=this._lockPreview;return void 0===t&&(t=this.getParentCell("lockPreview")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockPreview"),this._lockPreview=e}},{key:"lockReplace",get:function(){var e=na,t=this._lockReplace;return void 0===t&&(t=this.getParentCell("lockReplace")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockReplace"),this._lockReplace=e}},{key:"lockRotate",get:function(){var e=na,t=this._lockRotate;return void 0===t&&(t=this.getParentCell("lockRotate")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockRotate"),this._lockRotate=e}},{key:"lockSelect",get:function(){var e=na,t=this._lockSelect;return void 0===t&&(t=this.getParentCell("lockSelect")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockSelect"),this._lockSelect=e}},{key:"lockTextEdit",get:function(){var e=na,t=this._lockTextEdit;return void 0===t&&(t=this.getParentCell("lockTextEdit")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockTextEdit"),this._lockTextEdit=e}},{key:"lockThemeColors",get:function(){var e=na,t=this._lockThemeColors;return void 0===t&&(t=this.getParentCell("lockThemeColors")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockThemeColors"),this._lockThemeColors=e}},{key:"lockThemeConnectors",get:function(){var e=na,t=this._lockThemeConnectors;return void 0===t&&(t=this.getParentCell("lockThemeConnectors")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockThemeConnectors"),this._lockThemeConnectors=e}},{key:"lockThemeEffects",get:function(){var e=na,t=this._lockThemeEffects;return void 0===t&&(t=this.getParentCell("lockThemeEffects")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockThemeEffects"),this._lockThemeEffects=e}},{key:"lockThemeFonts",get:function(){var e=na,t=this._lockThemeFonts;return void 0===t&&(t=this.getParentCell("lockThemeFonts")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockThemeFonts"),this._lockThemeFonts=e}},{key:"lockThemeIndex",get:function(){var e=na,t=this._lockThemeIndex;return void 0===t&&(t=this.getParentCell("lockThemeIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockThemeIndex"),this._lockThemeIndex=e}},{key:"lockVariation",get:function(){var e=na,t=this._lockVariation;return void 0===t&&(t=this.getParentCell("lockVariation")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockVariation"),this._lockVariation=e}},{key:"lockVtxEdit",get:function(){var e=na,t=this._lockVtxEdit;return void 0===t&&(t=this.getParentCell("lockVtxEdit")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockVtxEdit"),this._lockVtxEdit=e}},{key:"lockWidth",get:function(){var e=na,t=this._lockWidth;return void 0===t&&(t=this.getParentCell("lockWidth")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockWidth"),this._lockWidth=e}},{key:"locPinX",get:function(){var e=da,t=this._locPinX;return void 0===t&&(t=this.getParentCell("locPinX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("locPinX"),this._locPinX=e}},{key:"locPinY",get:function(){var e=da,t=this._locPinY;return void 0===t&&(t=this.getParentCell("locPinY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("locPinY"),this._locPinY=e}},{key:"menu",get:function(){var e=ra,t=this._menu;return void 0===t&&(t=this.getParentCell("menu")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("menu"),this._menu=e}},{key:"name",get:function(){var e=ra,t=this._name;return void 0===t&&(t=this.getParentCell("name")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("name"),this._name=e}},{key:"nameUniv",get:function(){var e=ra,t=this._nameUniv;return void 0===t&&(t=this.getParentCell("nameUniv")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("nameUniv"),this._nameUniv=e}},{key:"newWindow",get:function(){var e=na,t=this._newWindow;return void 0===t&&(t=this.getParentCell("newWindow")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("newWindow"),this._newWindow=e}},{key:"noAlignBox",get:function(){var e=na,t=this._noAlignBox;return void 0===t&&(t=this.getParentCell("noAlignBox")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noAlignBox"),this._noAlignBox=e}},{key:"noCoauth",get:function(){var e=na,t=this._noCoauth;return void 0===t&&(t=this.getParentCell("noCoauth")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noCoauth"),this._noCoauth=e}},{key:"noCtlHandles",get:function(){var e=na,t=this._noCtlHandles;return void 0===t&&(t=this.getParentCell("noCtlHandles")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noCtlHandles"),this._noCtlHandles=e}},{key:"noFill",get:function(){var e=na,t=this._noFill;return void 0===t&&(t=this.getParentCell("noFill")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noFill"),this._noFill=e}},{key:"noLine",get:function(){var e=na,t=this._noLine;return void 0===t&&(t=this.getParentCell("noLine")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noLine"),this._noLine=e}},{key:"noLiveDynamics",get:function(){var e=na,t=this._noLiveDynamics;return void 0===t&&(t=this.getParentCell("noLiveDynamics")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noLiveDynamics"),this._noLiveDynamics=e}},{key:"nonPrinting",get:function(){var e=na,t=this._nonPrinting;return void 0===t&&(t=this.getParentCell("nonPrinting")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("nonPrinting"),this._nonPrinting=e}},{key:"noObjHandles",get:function(){var e=na,t=this._noObjHandles;return void 0===t&&(t=this.getParentCell("noObjHandles")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noObjHandles"),this._noObjHandles=e}},{key:"noProofing",get:function(){var e=na,t=this._noProofing;return void 0===t&&(t=this.getParentCell("noProofing")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noProofing"),this._noProofing=e}},{key:"noQuickDrag",get:function(){var e=na,t=this._noQuickDrag;return void 0===t&&(t=this.getParentCell("noQuickDrag")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noQuickDrag"),this._noQuickDrag=e}},{key:"noShow",get:function(){var e=na,t=this._noShow;return void 0===t&&(t=this.getParentCell("noShow")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noShow"),this._noShow=e}},{key:"noSnap",get:function(){var e=na,t=this._noSnap;return void 0===t&&(t=this.getParentCell("noSnap")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noSnap"),this._noSnap=e}},{key:"objectKind",get:function(){var e=ta,t=this._objectKind;return void 0===t&&(t=this.getParentCell("objectKind")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("objectKind"),this._objectKind=e}},{key:"objType",get:function(){var e=ta,t=this._objType;return void 0===t&&(t=this.getParentCell("objType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("objType"),this._objType=e}},{key:"onPage",get:function(){var e=na,t=this._onPage;return void 0===t&&(t=this.getParentCell("onPage")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("onPage"),this._onPage=e}},{key:"outputFormat",get:function(){var e=ta,t=this._outputFormat;return void 0===t&&(t=this.getParentCell("outputFormat")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("outputFormat"),this._outputFormat=e}},{key:"overline",get:function(){var e=na,t=this._overline;return void 0===t&&(t=this.getParentCell("overline")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("overline"),this._overline=e}},{key:"pageBottomMargin",get:function(){var e=ga,t=this._pageBottomMargin;return void 0===t&&(t=this.getParentCell("pageBottomMargin")),void 0===t?this.getDefaultCellValue(e):this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageBottomMargin"),this._pageBottomMargin=e}},{key:"pageHeight",get:function(){var e=da,t=this._pageHeight;return void 0===t&&(t=this.getParentCell("pageHeight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageHeight"),this._pageHeight=e}},{key:"pageLeftMargin",get:function(){var e=ga,t=this._pageLeftMargin;return void 0===t&&(t=this.getParentCell("pageLeftMargin")),void 0===t?this.getDefaultCellValue(e):this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageLeftMargin"),this._pageLeftMargin=e}},{key:"pageLineJumpDirX",get:function(){var e=ta,t=this._pageLineJumpDirX;return void 0===t&&(t=this.getParentCell("pageLineJumpDirX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageLineJumpDirX"),this._pageLineJumpDirX=e}},{key:"pageLineJumpDirY",get:function(){var e=ta,t=this._pageLineJumpDirY;return void 0===t&&(t=this.getParentCell("pageLineJumpDirY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageLineJumpDirY"),this._pageLineJumpDirY=e}},{key:"pageLockDuplicate",get:function(){var e=na,t=this._pageLockDuplicate;return void 0===t&&(t=this.getParentCell("pageLockDuplicate")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageLockDuplicate"),this._pageLockDuplicate=e}},{key:"pageLockReplace",get:function(){var e=na,t=this._pageLockReplace;return void 0===t&&(t=this.getParentCell("pageLockReplace")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageLockReplace"),this._pageLockReplace=e}},{key:"pageRightMargin",get:function(){var e=ga,t=this._pageRightMargin;return void 0===t&&(t=this.getParentCell("pageRightMargin")),void 0===t?this.getDefaultCellValue(e):this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageRightMargin"),this._pageRightMargin=e}},{key:"pageScale",get:function(){var e=da,t=this._pageScale;return void 0===t&&(t=this.getParentCell("pageScale")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageScale"),this._pageScale=e}},{key:"pageShapeSplit",get:function(){var e=ta,t=this._pageShapeSplit;return void 0===t&&(t=this.getParentCell("pageShapeSplit")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageShapeSplit"),this._pageShapeSplit=e}},{key:"pagesX",get:function(){var e=la,t=this._pagesX;return void 0===t&&(t=this.getParentCell("pagesX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pagesX"),this._pagesX=e}},{key:"pagesY",get:function(){var e=la,t=this._pagesY;return void 0===t&&(t=this.getParentCell("pagesY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pagesY"),this._pagesY=e}},{key:"pageTopMargin",get:function(){var e=ga,t=this._pageTopMargin;return void 0===t&&(t=this.getParentCell("pageTopMargin")),void 0===t?this.getDefaultCellValue(e):this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageTopMargin"),this._pageTopMargin=e}},{key:"pageWidth",get:function(){var e=da,t=this._pageWidth;return void 0===t&&(t=this.getParentCell("pageWidth")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageWidth"),this._pageWidth=e}},{key:"paperKind",get:function(){var e=la,t=this._paperKind;return void 0===t&&(t=this.getParentCell("paperKind")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("paperKind"),this._paperKind=e}},{key:"paperSource",get:function(){var e=la,t=this._paperSource;return void 0===t&&(t=this.getParentCell("paperSource")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("paperSource"),this._paperSource=e}},{key:"perspective",get:function(){var e=this._perspective;void 0===e&&(e=this.getParentCell("perspective"));var t=pa;return wa.log('resolve cell type "perspective"'),e.units&&wa.log("vScalar unclear"),this.resolveCellValue(e,t)},set:function(e){this.attributeSet("perspective"),this._perspective=e}},{key:"pinX",get:function(){var e=da,t=this._pinX;return void 0===t&&(t=this.getParentCell("pinX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pinX"),this._pinX=e}},{key:"pinY",get:function(){var e=da,t=this._pinY;return void 0===t&&(t=this.getParentCell("pinY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pinY"),this._pinY=e}},{key:"placeDepth",get:function(){var e=ta,t=this._placeDepth;return void 0===t&&(t=this.getParentCell("placeDepth")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("placeDepth"),this._placeDepth=e}},{key:"placeFlip",get:function(){var e=ta,t=this._placeFlip;return void 0===t&&(t=this.getParentCell("placeFlip")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("placeFlip"),this._placeFlip=e}},{key:"placeStyle",get:function(){var e=ta,t=this._placeStyle;return void 0===t&&(t=this.getParentCell("placeStyle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("placeStyle"),this._placeStyle=e}},{key:"plowCode",get:function(){var e=ta,t=this._plowCode;return void 0===t&&(t=this.getParentCell("plowCode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("plowCode"),this._plowCode=e}},{key:"pos",get:function(){var e=ta,t=this._pos;return void 0===t&&(t=this.getParentCell("pos")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pos"),this._pos=e}},{key:"position",get:function(){var e=da,t=this._position;return void 0===t&&(t=this.getParentCell("position")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("position"),this._position=e}},{key:"previewQuality",get:function(){var e=ta,t=this._previewQuality;return void 0===t&&(t=this.getParentCell("previewQuality")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("previewQuality"),this._previewQuality=e}},{key:"previewScope",get:function(){var e=ta,t=this._previewScope;return void 0===t&&(t=this.getParentCell("previewScope")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("previewScope"),this._previewScope=e}},{key:"print",get:function(){var e=na,t=this._print;return void 0===t&&(t=this.getParentCell("print")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("print"),this._print=e}},{key:"printGrid",get:function(){var e=na,t=this._printGrid;return void 0===t&&(t=this.getParentCell("printGrid")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("printGrid"),this._printGrid=e}},{key:"printPageOrientation",get:function(){var e=ta,t=this._printPageOrientation;return void 0===t&&(t=this.getParentCell("printPageOrientation")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("printPageOrientation"),this._printPageOrientation=e}},{key:"prompt",get:function(){var e=ra,t=this._prompt;return void 0===t&&(t=this.getParentCell("prompt")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("prompt"),this._prompt=e}},{key:"quickStyleEffectsMatrix",get:function(){var e=ta,t=this._quickStyleEffectsMatrix;return void 0===t&&(t=this.getParentCell("quickStyleEffectsMatrix")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleEffectsMatrix"),this._quickStyleEffectsMatrix=e}},{key:"quickStyleFillColor",get:function(){var e=ta,t=this._quickStyleFillColor;return void 0===t&&(t=this.getParentCell("quickStyleFillColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleFillColor"),this._quickStyleFillColor=e}},{key:"quickStyleFillMatrix",get:function(){var e=ta,t=this._quickStyleFillMatrix;return void 0===t&&(t=this.getParentCell("quickStyleFillMatrix")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleFillMatrix"),this._quickStyleFillMatrix=e}},{key:"quickStyleFontColor",get:function(){var e=ta,t=this._quickStyleFontColor;return void 0===t&&(t=this.getParentCell("quickStyleFontColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleFontColor"),this._quickStyleFontColor=e}},{key:"quickStyleFontMatrix",get:function(){var e=ta,t=this._quickStyleFontMatrix;return void 0===t&&(t=this.getParentCell("quickStyleFontMatrix")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleFontMatrix"),this._quickStyleFontMatrix=e}},{key:"quickStyleLineColor",get:function(){var e=ta,t=this._quickStyleLineColor;return void 0===t&&(t=this.getParentCell("quickStyleLineColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleLineColor"),this._quickStyleLineColor=e}},{key:"quickStyleLineMatrix",get:function(){var e=ta,t=this._quickStyleLineMatrix;return void 0===t&&(t=this.getParentCell("quickStyleLineMatrix")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleLineMatrix"),this._quickStyleLineMatrix=e}},{key:"quickStyleShadowColor",get:function(){var e=ta,t=this._quickStyleShadowColor;return void 0===t&&(t=this.getParentCell("quickStyleShadowColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleShadowColor"),this._quickStyleShadowColor=e}},{key:"quickStyleType",get:function(){var e=sa,t=this._quickStyleType;return void 0===t&&(t=this.getParentCell("quickStyleType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleType"),this._quickStyleType=e}},{key:"quickStyleVariation",get:function(){var e=ta,t=this._quickStyleVariation;return void 0===t&&(t=this.getParentCell("quickStyleVariation")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleVariation"),this._quickStyleVariation=e}},{key:"readOnly",get:function(){var e=na,t=this._readOnly;return void 0===t&&(t=this.getParentCell("readOnly")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("readOnly"),this._readOnly=e}},{key:"reflectionBlur",get:function(){var e=da,t=this._reflectionBlur;return void 0===t&&(t=this.getParentCell("reflectionBlur")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("reflectionBlur"),this._reflectionBlur=e}},{key:"reflectionDist",get:function(){var e=da,t=this._reflectionDist;return void 0===t&&(t=this.getParentCell("reflectionDist")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("reflectionDist"),this._reflectionDist=e}},{key:"reflectionSize",get:function(){var e=ga,t=this._reflectionSize;return void 0===t&&(t=this.getParentCell("reflectionSize")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("reflectionSize"),this._reflectionSize=e}},{key:"reflectionTrans",get:function(){var e=ga,t=this._reflectionTrans;return void 0===t&&(t=this.getParentCell("reflectionTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("reflectionTrans"),this._reflectionTrans=e}},{key:"relationships",get:function(){var e=na,t=this._relationships;return void 0===t&&(t=this.getParentCell("relationships")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("relationships"),this._relationships=e}},{key:"replaceCopyCells",get:function(){var e=ta,t=this._replaceCopyCells;return void 0===t&&(t=this.getParentCell("replaceCopyCells")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("replaceCopyCells"),this._replaceCopyCells=e}},{key:"replaceLockFormat",get:function(){var e=ta,t=this._replaceLockFormat;return void 0===t&&(t=this.getParentCell("replaceLockFormat")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("replaceLockFormat"),this._replaceLockFormat=e}},{key:"replaceLockShapeData",get:function(){var e=ta,t=this._replaceLockShapeData;return void 0===t&&(t=this.getParentCell("replaceLockShapeData")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("replaceLockShapeData"),this._replaceLockShapeData=e}},{key:"replaceLockText",get:function(){var e=ta,t=this._replaceLockText;return void 0===t&&(t=this.getParentCell("replaceLockText")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("replaceLockText"),this._replaceLockText=e}},{key:"resizeMode",get:function(){var e=ta,t=this._resizeMode;return void 0===t&&(t=this.getParentCell("resizeMode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("resizeMode"),this._resizeMode=e}},{key:"resizePage",get:function(){var e=na,t=this._resizePage;return void 0===t&&(t=this.getParentCell("resizePage")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("resizePage"),this._resizePage=e}},{key:"reviewerID",get:function(){var e=aa,t=this._reviewerID;return void 0===t&&(t=this.getParentCell("reviewerID")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("reviewerID"),this._reviewerID=e}},{key:"rightMargin",get:function(){var e=da,t=this._rightMargin;return void 0===t&&(t=this.getParentCell("rightMargin")),void 0===t&&(t=this.getStylesheetTextStyleCell("rightMargin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("rightMargin"),this._rightMargin=e}},{key:"rotateGradientWithShape",get:function(){var e=na,t=this._rotateGradientWithShape;return void 0===t&&(t=this.getParentCell("rotateGradientWithShape")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("rotateGradientWithShape"),this._rotateGradientWithShape=e}},{key:"rotationType",get:function(){var e=ta,t=this._rotationType;return void 0===t&&(t=this.getParentCell("rotationType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("rotationType"),this._rotationType=e}},{key:"rotationXAngle",get:function(){var e=pa,t=this._rotationXAngle;return void 0===t&&(t=this.getParentCell("rotationXAngle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("rotationXAngle"),this._rotationXAngle=e}},{key:"rotationYAngle",get:function(){var e=pa,t=this._rotationYAngle;return void 0===t&&(t=this.getParentCell("rotationYAngle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("rotationYAngle"),this._rotationYAngle=e}},{key:"rotationZAngle",get:function(){var e=pa,t=this._rotationZAngle;return void 0===t&&(t=this.getParentCell("rotationZAngle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("rotationZAngle"),this._rotationZAngle=e}},{key:"rounding",get:function(){var e=da,t=this._rounding;return void 0===t&&(t=this.getParentCell("rounding")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("rounding"),this._rounding=e}},{key:"routeStyle",get:function(){var e=ta,t=this._routeStyle;return void 0===t&&(t=this.getParentCell("routeStyle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("routeStyle"),this._routeStyle=e}},{key:"scaleX",get:function(){var e=ga,t=this._scaleX;return void 0===t&&(t=this.getParentCell("scaleX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("scaleX"),this._scaleX=e}},{key:"scaleY",get:function(){var e=ga,t=this._scaleY;return void 0===t&&(t=this.getParentCell("scaleY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("scaleY"),this._scaleY=e}},{key:"selectMode",get:function(){var e=ta,t=this._selectMode;return void 0===t&&(t=this.getParentCell("selectMode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("selectMode"),this._selectMode=e}},{key:"shapeFixedCode",get:function(){var e=ta,t=this._shapeFixedCode;return void 0===t&&(t=this.getParentCell("shapeFixedCode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeFixedCode"),this._shapeFixedCode=e}},{key:"shapeKeywords",get:function(){var e=ra,t=this._shapeKeywords;return void 0===t&&(t=this.getParentCell("shapeKeywords")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeKeywords"),this._shapeKeywords=e}},{key:"shapePermeablePlace",get:function(){var e=na,t=this._shapePermeablePlace;return void 0===t&&(t=this.getParentCell("shapePermeablePlace")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapePermeablePlace"),this._shapePermeablePlace=e}},{key:"shapePermeableX",get:function(){var e=na,t=this._shapePermeableX;return void 0===t&&(t=this.getParentCell("shapePermeableX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapePermeableX"),this._shapePermeableX=e}},{key:"shapePermeableY",get:function(){var e=na,t=this._shapePermeableY;return void 0===t&&(t=this.getParentCell("shapePermeableY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapePermeableY"),this._shapePermeableY=e}},{key:"shapePlaceFlip",get:function(){var e=ta,t=this._shapePlaceFlip;return void 0===t&&(t=this.getParentCell("shapePlaceFlip")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapePlaceFlip"),this._shapePlaceFlip=e}},{key:"shapePlaceStyle",get:function(){var e=ta,t=this._shapePlaceStyle;return void 0===t&&(t=this.getParentCell("shapePlaceStyle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapePlaceStyle"),this._shapePlaceStyle=e}},{key:"shapePlowCode",get:function(){var e=ta,t=this._shapePlowCode;return void 0===t&&(t=this.getParentCell("shapePlowCode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapePlowCode"),this._shapePlowCode=e}},{key:"shapeRouteStyle",get:function(){var e=ta,t=this._shapeRouteStyle;return void 0===t&&(t=this.getParentCell("shapeRouteStyle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeRouteStyle"),this._shapeRouteStyle=e}},{key:"shapeShdwBlur",get:function(){var e=da,t=this._shapeShdwBlur;return void 0===t&&(t=this.getParentCell("shapeShdwBlur")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeShdwBlur"),this._shapeShdwBlur=e}},{key:"shapeShdwObliqueAngle",get:function(){var e=pa,t=this._shapeShdwObliqueAngle;return void 0===t&&(t=this.getParentCell("shapeShdwObliqueAngle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeShdwObliqueAngle"),this._shapeShdwObliqueAngle=e}},{key:"shapeShdwOffsetX",get:function(){var e=da,t=this._shapeShdwOffsetX;return void 0===t&&(t=this.getParentCell("shapeShdwOffsetX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeShdwOffsetX"),this._shapeShdwOffsetX=e}},{key:"shapeShdwOffsetY",get:function(){var e=da,t=this._shapeShdwOffsetY;return void 0===t&&(t=this.getParentCell("shapeShdwOffsetY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeShdwOffsetY"),this._shapeShdwOffsetY=e}},{key:"shapeShdwScaleFactor",get:function(){var e=ga,t=this._shapeShdwScaleFactor;return void 0===t&&(t=this.getParentCell("shapeShdwScaleFactor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeShdwScaleFactor"),this._shapeShdwScaleFactor=e}},{key:"shapeShdwShow",get:function(){var e=ta,t=this._shapeShdwShow;return void 0===t&&(t=this.getParentCell("shapeShdwShow")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeShdwShow"),this._shapeShdwShow=e}},{key:"shapeShdwType",get:function(){var e=ta,t=this._shapeShdwType;return void 0===t&&(t=this.getParentCell("shapeShdwType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeShdwType"),this._shapeShdwType=e}},{key:"shapeSplit",get:function(){var e=ta,t=this._shapeSplit;return void 0===t&&(t=this.getParentCell("shapeSplit")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeSplit"),this._shapeSplit=e}},{key:"shapeSplittable",get:function(){var e=ta,t=this._shapeSplittable;return void 0===t&&(t=this.getParentCell("shapeSplittable")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeSplittable"),this._shapeSplittable=e}},{key:"sharpen",get:function(){var e=ga,t=this._sharpen;return void 0===t&&(t=this.getParentCell("sharpen")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("sharpen"),this._sharpen=e}},{key:"shdwForegnd",get:function(){var e=va,t=this._shdwForegnd;return void 0===t&&(t=this.getParentCell("shdwForegnd")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shdwForegnd"),this._shdwForegnd=e}},{key:"shdwForegndTrans",get:function(){var e=ga,t=this._shdwForegndTrans;return void 0===t&&(t=this.getParentCell("shdwForegndTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shdwForegndTrans"),this._shdwForegndTrans=e}},{key:"shdwObliqueAngle",get:function(){var e=ga,t=this._shdwObliqueAngle;return void 0===t&&(t=this.getParentCell("shdwObliqueAngle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shdwObliqueAngle"),this._shdwObliqueAngle=e}},{key:"shdwOffsetX",get:function(){var e=da,t=this._shdwOffsetX;return void 0===t&&(t=this.getParentCell("shdwOffsetX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shdwOffsetX"),this._shdwOffsetX=e}},{key:"shdwOffsetY",get:function(){var e=da,t=this._shdwOffsetY;return void 0===t&&(t=this.getParentCell("shdwOffsetY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shdwOffsetY"),this._shdwOffsetY=e}},{key:"shdwPattern",get:function(){var e=ta,t=this._shdwPattern;return void 0===t&&(t=this.getParentCell("shdwPattern")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shdwPattern"),this._shdwPattern=e}},{key:"shdwScaleFactor",get:function(){var e=ga,t=this._shdwScaleFactor;return void 0===t&&(t=this.getParentCell("shdwScaleFactor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shdwScaleFactor"),this._shdwScaleFactor=e}},{key:"shdwType",get:function(){var e=ta,t=this._shdwType;return void 0===t&&(t=this.getParentCell("shdwType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shdwType"),this._shdwType=e}},{key:"size",get:function(){var e=da,t=this._size;return void 0===t&&(t=this.getParentCell("size")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("size"),this._size=e}},{key:"sketchAmount",get:function(){var e=sa,t=this._sketchAmount;return void 0===t&&(t=this.getParentCell("sketchAmount")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("sketchAmount"),this._sketchAmount=e}},{key:"sketchEnabled",get:function(){var e=na,t=this._sketchEnabled;return void 0===t&&(t=this.getParentCell("sketchEnabled")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("sketchEnabled"),this._sketchEnabled=e}},{key:"sketchFillChange",get:function(){var e=ga,t=this._sketchFillChange;return void 0===t&&(t=this.getParentCell("sketchFillChange")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("sketchFillChange"),this._sketchFillChange=e}},{key:"sketchLineChange",get:function(){var e=ga,t=this._sketchLineChange;return void 0===t&&(t=this.getParentCell("sketchLineChange")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("sketchLineChange"),this._sketchLineChange=e}},{key:"sketchLineWeight",get:function(){var e=da,t=this._sketchLineWeight;return void 0===t&&(t=this.getParentCell("sketchLineWeight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("sketchLineWeight"),this._sketchLineWeight=e}},{key:"sketchSeed",get:function(){var e=sa,t=this._sketchSeed;return void 0===t&&(t=this.getParentCell("sketchSeed")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("sketchSeed"),this._sketchSeed=e}},{key:"snap",get:function(){var e=na,t=this._snap;return void 0===t&&(t=this.getParentCell("snap")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("snap"),this._snap=e}},{key:"softEdgesSize",get:function(){var e=da,t=this._softEdgesSize;return void 0===t&&(t=this.getParentCell("softEdgesSize")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("softEdgesSize"),this._softEdgesSize=e}},{key:"sortKey",get:function(){var e=ra,t=this._sortKey;return void 0===t&&(t=this.getParentCell("sortKey")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("sortKey"),this._sortKey=e}},{key:"spAfter",get:function(){var e=da,t=this._spAfter;return void 0===t&&(t=this.getParentCell("spAfter")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("spAfter"),this._spAfter=e}},{key:"spBefore",get:function(){var e=da,t=this._spBefore;return void 0===t&&(t=this.getParentCell("spBefore")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("spBefore"),this._spBefore=e}},{key:"spLine",get:function(){var e=da,t=this._spLine;return void 0===t&&(t=this.getParentCell("spLine")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("spLine"),this._spLine=e}},{key:"status",get:function(){var e=ta,t=this._status;return void 0===t&&(t=this.getParentCell("status")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("status"),this._status=e}},{key:"strikethru",get:function(){var e=na,t=this._strikethru;return void 0===t&&(t=this.getParentCell("strikethru")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("strikethru"),this._strikethru=e}},{key:"style",get:function(){var e=ta,t=this._style;return void 0===t&&(t=this.getParentCell("style")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("style"),this._style=e}},{key:"subAddress",get:function(){var e=ra,t=this._subAddress;return void 0===t&&(t=this.getParentCell("subAddress")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("subAddress"),this._subAddress=e}},{key:"tagName",get:function(){var e=ra,t=this._tagName;return void 0===t&&(t=this.getParentCell("tagName")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("tagName"),this._tagName=e}},{key:"textBkgnd",get:function(){var e=ia,t=this._textBkgnd;return void 0===t&&(t=this.getParentCell("textBkgnd")),void 0===t&&(t=this.getStylesheetTextStyleCell("textBkgnd")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("textBkgnd"),this._textBkgnd=e}},{key:"textBkgndTrans",get:function(){var e=ga,t=this._textBkgndTrans;return void 0===t&&(t=this.getParentCell("textBkgndTrans")),void 0===t&&(t=this.getStylesheetTextStyleCell("textBkgndTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("textBkgndTrans"),this._textBkgndTrans=e}},{key:"textDirection",get:function(){var e=ga,t=this._textDirection;return void 0===t&&(t=this.getParentCell("textDirection")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("textDirection"),this._textDirection=e}},{key:"textPosAfterBullet",get:function(){var e=da,t=this._textPosAfterBullet;return void 0===t&&(t=this.getParentCell("textPosAfterBullet")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("textPosAfterBullet"),this._textPosAfterBullet=e}},{key:"theData",get:function(){var e=ga,t=this._theData;return void 0===t&&(t=this.getParentCell("theData")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("theData"),this._theData=e}},{key:"themeIndex",get:function(){var e=sa,t=this._themeIndex;return void 0===t&&(t=this.getParentCell("themeIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("themeIndex"),this._themeIndex=e}},{key:"theText",get:function(){var e=ga,t=this._theText;return void 0===t&&(t=this.getParentCell("theText")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("theText"),this._theText=e}},{key:"topMargin",get:function(){var e=da,t=this._topMargin;return void 0===t&&(t=this.getParentCell("topMargin")),void 0===t&&(t=this.getStylesheetTextStyleCell("topMargin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("topMargin"),this._topMargin=e}},{key:"transparency",get:function(){var e=ga,t=this._transparency;return void 0===t&&(t=this.getParentCell("transparency")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("transparency"),this._transparency=e}},{key:"txtAngle",get:function(){var e=this._txtAngle;void 0===e&&(e=this.getParentCell("txtAngle"));var t=pa;return wa.log('resolve cell type "txtAngle"'),e&&"0"!==e.value&&e.units&&e.units!==ji.DEG&&wa.log("txtAngle unclear"),this.resolveCellValue(e,t)},set:function(e){this.attributeSet("txtAngle"),this._txtAngle=e}},{key:"txtHeight",get:function(){var e=da,t=this._txtHeight;return void 0===t&&(t=this.getParentCell("txtHeight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("txtHeight"),this._txtHeight=e}},{key:"txtLocPinX",get:function(){var e=da,t=this._txtLocPinX;return void 0===t&&(t=this.getParentCell("txtLocPinX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("txtLocPinX"),this._txtLocPinX=e}},{key:"txtLocPinY",get:function(){var e=da,t=this._txtLocPinY;return void 0===t&&(t=this.getParentCell("txtLocPinY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("txtLocPinY"),this._txtLocPinY=e}},{key:"txtPinX",get:function(){var e=da,t=this._txtPinX;return void 0===t&&(t=this.getParentCell("txtPinX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("txtPinX"),this._txtPinX=e}},{key:"txtPinY",get:function(){var e=da,t=this._txtPinY;return void 0===t&&(t=this.getParentCell("txtPinY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("txtPinY"),this._txtPinY=e}},{key:"txtWidth",get:function(){var e=da,t=this._txtWidth;return void 0===t&&(t=this.getParentCell("txtWidth")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("txtWidth"),this._txtWidth=e}},{key:"type",get:function(){var e=ga,t=this._type;return void 0===t&&(t=this.getParentCell("type")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("type"),this._type=e}},{key:"uICat",get:function(){var e=ga,t=this._uICat;return void 0===t&&(t=this.getParentCell("uICat")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("uICat"),this._uICat=e}},{key:"uICod",get:function(){var e=ga,t=this._uICod;return void 0===t&&(t=this.getParentCell("uICod")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("uICod"),this._uICod=e}},{key:"uIFmt",get:function(){var e=ga,t=this._uIFmt;return void 0===t&&(t=this.getParentCell("uIFmt")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("uIFmt"),this._uIFmt=e}},{key:"uIVisibility",get:function(){var e=na,t=this._uIVisibility;return void 0===t&&(t=this.getParentCell("uIVisibility")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("uIVisibility"),this._uIVisibility=e}},{key:"updateAlignBox",get:function(){var e=na,t=this._updateAlignBox;return void 0===t&&(t=this.getParentCell("updateAlignBox")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("updateAlignBox"),this._updateAlignBox=e}},{key:"useGroupGradient",get:function(){var e=na,t=this._useGroupGradient;return void 0===t&&(t=this.getParentCell("useGroupGradient")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("useGroupGradient"),this._useGroupGradient=e}},{key:"value",get:function(){var e=fa,t=this._value;return void 0===t&&(t=this.getParentCell("value")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("value"),this._value=e}},{key:"variationColorIndex",get:function(){var e=sa,t=this._variationColorIndex;return void 0===t&&(t=this.getParentCell("variationColorIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("variationColorIndex"),this._variationColorIndex=e}},{key:"variationStyleIndex",get:function(){var e=sa,t=this._variationStyleIndex;return void 0===t&&(t=this.getParentCell("variationStyleIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("variationStyleIndex"),this._variationStyleIndex=e}},{key:"verify",get:function(){var e=na,t=this._verify;return void 0===t&&(t=this.getParentCell("verify")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("verify"),this._verify=e}},{key:"verticalAlign",get:function(){var e=ga,t=this._verticalAlign;return void 0===t&&(t=this.getParentCell("verticalAlign")),void 0===t&&(t=this.getStylesheetTextStyleCell("verticalAlign")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("verticalAlign"),this._verticalAlign=e}},{key:"viewMarkup",get:function(){var e=na,t=this._viewMarkup;return void 0===t&&(t=this.getParentCell("viewMarkup")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("viewMarkup"),this._viewMarkup=e}},{key:"visible",get:function(){var e=na,t=this._visible;return void 0===t&&(t=this.getParentCell("visible")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("visible"),this._visible=e}},{key:"walkPreference",get:function(){var e=ta,t=this._walkPreference;return void 0===t&&(t=this.getParentCell("walkPreference")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("walkPreference"),this._walkPreference=e}},{key:"width",get:function(){var e=da,t=this._width;return void 0===t&&(t=this.getParentCell("width")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("width"),this._width=e}},{key:"x",get:function(){var e;if(this.isDescendantOfSectionType([Ui.Control,Ui.Scratch,Ui.ActionTag,Ui.Connection]))e=da;else switch(this.getRowType()){case Ji.ArcTo:case Ji.Ellipse:case Ji.EllipticalArcTo:case Ji.InfiniteLine:case Ji.LineTo:case Ji.MoveTo:case Ji.NURBSTo:case Ji.PolylineTo:case Ji.SplineKnot:case Ji.SplineStart:e=da;break;case Ji.RelCubBezTo:case Ji.RelEllipticalArcTo:case Ji.RelLineTo:case Ji.RelMoveTo:case Ji.RelQuadBezTo:e=ga;break;default:wa.log("Incorrect cell type",{attributeName:"x",cells:this,rowType:this.getRowType()})}var t=this._x;return void 0===t&&(t=this.getParentCell("x")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("x"),this._x=e}},{key:"xCon",get:function(){var e=ta,t=this._xCon;return void 0===t&&(t=this.getParentCell("xCon")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("xCon"),this._xCon=e}},{key:"xDyn",get:function(){var e=da,t=this._xDyn;return void 0===t&&(t=this.getParentCell("xDyn")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("xDyn"),this._xDyn=e}},{key:"xGridDensity",get:function(){var e=ta,t=this._xGridDensity;return void 0===t&&(t=this.getParentCell("xGridDensity")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("xGridDensity"),this._xGridDensity=e}},{key:"xGridOrigin",get:function(){var e=da,t=this._xGridOrigin;return void 0===t&&(t=this.getParentCell("xGridOrigin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("xGridOrigin"),this._xGridOrigin=e}},{key:"xGridSpacing",get:function(){var e=da,t=this._xGridSpacing;return void 0===t&&(t=this.getParentCell("xGridSpacing")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("xGridSpacing"),this._xGridSpacing=e}},{key:"xJustify",get:function(){var e=ta,t=this._xJustify;return void 0===t&&(t=this.getParentCell("xJustify")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("xJustify"),this._xJustify=e}},{key:"xRulerDensity",get:function(){var e=ta,t=this._xRulerDensity;return void 0===t&&(t=this.getParentCell("xRulerDensity")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("xRulerDensity"),this._xRulerDensity=e}},{key:"xRulerOrigin",get:function(){var e=da,t=this._xRulerOrigin;return void 0===t&&(t=this.getParentCell("xRulerOrigin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("xRulerOrigin"),this._xRulerOrigin=e}},{key:"y",get:function(){var e;if(this.isDescendantOfSectionType([Ui.Control,Ui.Scratch,Ui.ActionTag,Ui.Connection]))e=da;else switch(this.getRowType()){case Ji.ArcTo:case Ji.Ellipse:case Ji.EllipticalArcTo:case Ji.InfiniteLine:case Ji.LineTo:case Ji.MoveTo:case Ji.NURBSTo:case Ji.PolylineTo:case Ji.SplineKnot:case Ji.SplineStart:e=da;break;case Ji.RelCubBezTo:case Ji.RelEllipticalArcTo:case Ji.RelLineTo:case Ji.RelMoveTo:case Ji.RelQuadBezTo:e=ga;break;default:wa.log("Incorrect cell type",{attributeName:"a",cells:this})}var t=this._y;return void 0===t&&(t=this.getParentCell("y")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("y"),this._y=e}},{key:"yCon",get:function(){var e=ta,t=this._yCon;return void 0===t&&(t=this.getParentCell("yCon")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("yCon"),this._yCon=e}},{key:"yDyn",get:function(){var e=da,t=this._yDyn;return void 0===t&&(t=this.getParentCell("yDyn")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("yDyn"),this._yDyn=e}},{key:"yGridDensity",get:function(){var e=ta,t=this._yGridDensity;return void 0===t&&(t=this.getParentCell("yGridDensity")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("yGridDensity"),this._yGridDensity=e}},{key:"yGridOrigin",get:function(){var e=da,t=this._yGridOrigin;return void 0===t&&(t=this.getParentCell("yGridOrigin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("yGridOrigin"),this._yGridOrigin=e}},{key:"yGridSpacing",get:function(){var e=da,t=this._yGridSpacing;return void 0===t&&(t=this.getParentCell("yGridSpacing")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("yGridSpacing"),this._yGridSpacing=e}},{key:"yJustify",get:function(){var e=ta,t=this._yJustify;return void 0===t&&(t=this.getParentCell("yJustify")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("yJustify"),this._yJustify=e}},{key:"yRulerDensity",get:function(){var e=ta,t=this._yRulerDensity;return void 0===t&&(t=this.getParentCell("yRulerDensity")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("yRulerDensity"),this._yRulerDensity=e}},{key:"yRulerOrigin",get:function(){var e=da,t=this._yRulerOrigin;return void 0===t&&(t=this.getParentCell("yRulerOrigin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("yRulerOrigin"),this._yRulerOrigin=e}}]),t}(),Dl=["MoveTo","RelMoveTo","LineTo","RelLineTo","ArcTo","InfiniteLine","Ellipse","EllipticalArcTo","RelEllipticalArcTo","SplineStart","SplineKnow","PolylineTo","NURBSTo","RelCubBezTo","RelQuadBezTo"],Fl=function(){lr(o,bs);var a=pr(o);function o(e){var t,n=Object.assign({},e);ir(this,o),t=a.call(this,n);var r=n.cells,i=void 0===r?new El({archive:t.archive}):r;return t.cells=i,t.debugType=n.debugType,t.jxon=n.jxon,n.type&&(t.type=n.type),n.debugType===Hi.Named?t.name=n.name:t.index=n.index,t}return or(o,[{key:"type",get:function(){return this._type},set:function(e){Dl.includes(e)&&this.jxon&&(this.jxon[Wi.Type]=e),this._type=e}}]),o}(),Ol={Geometry:["NoFill","NoLine","NoShow","NoSnap","NoQuickDrag"]},Nl={Actions:["Menu","Action","Checked","Disabled","ReadOnly","Invisible","BeginGroup","FlyoutChild","TagName","ButtonFace","SortKey"],Character:["Font","Color","Style","Case","Pos","FontScale","Size","DblUnderline","Overline","Strikethru","DoubleStrikethrough","Letterspace","ColorTrans","AsianFont","ComplexScriptFont","ComplexScriptSize","LangID"],Connection:["X","Y","DirX","DirY","Type","AutoGen","Prompt"],Control:["X","Y","XDyn","YDyn","XCon","YCon","CanGlue","Prompt"],Field:["Value","Format","Type","UICat","UICod","UIFmt","Calendar","ObjectKind"],FillGradient:["GradientStopColor","GradientStopColorTrans","GradientStopPosition"],Geometry:["X","Y","A","B","C","D","E"],Hyperlink:["Description","Address","SubAddress","ExtraInfo","Frame","NewWindow","Default","Invisible","SortKey"],Layer:["Name","Color","Status","Visible","Print","Active","Lock","Snap","Glue","NameUniv","ColorTrans"],LineGradient:["GradientStopColor","GradientStopColorTrans","GradientStopPosition"],Paragraph:["IndFirst","IndLeft","IndRight","SpLine","SpBefore","SpAfter","HorzAlign","Bullet","BulletStr","BulletFont","BulletFontSize","TextPosAfterBullet","Flags"],Property:["Value","Prompt","Label","Format","SortKey","Type","Invisible","Verify","DataLinked","LangID","Calendar"],Reviewer:["Name","Initials","Color","ReviewerID","CurrentIndex"],Scratch:["X","Y","A","B","C","D"],ActionTag:["X","Y","TagName","XJustify","YJustify","DisplayMode","ButtonFace","Disabled","Description"],Tabs:["Position","Alignment"],User:["Value","Prompt"]},Bl=function(){lr(s,ys);var o=pr(s);function s(t){var e;ir(this,s),e=o.call(this,t);var n=t.rows,r=void 0===n?[]:n,i=t.cells,a=void 0===i?new El({archive:e.archive}):i;return e.cells=a,e.rows=r.map(function(e){return new Fl(Zn(Zn({},e),{},{archive:t.archive}))}),e}return or(s,[{key:"getRows",value:function(){var e=this.rows;return e||[]}},{key:"getRow",value:function(){}},{key:"addRow",value:function(){}},{key:"removeRow",value:function(){}}],[{key:"from",value:function(e){return e.type===Ui.Geometry?new zl(e):e.type===Ui.Property?new jl(e):e.type===Ui.User?new jl(e):Ca[e.type]===Hi.Indexed?new Gl(e):new Xl(e)}}]),s}(),Gl=function(){lr(t,Bl);var e=pr(t);function t(){return ir(this,t),e.apply(this,arguments)}return or(t,[{key:"getRow",value:function(e){var t=this.rows[e];return t||null}},{key:"addRow",value:function(){var e,t=this.rows.map(function(e){return e.index}).sort().pop(),n=Number.isInteger(t)?t+1:1,r=(sr(e={},Ei,n.toString()),sr(e,"Cell",[]),e),i=new Fl({debugType:Hi.Indexed,index:n,jxon:r,archive:this.archive});return Nl[this.type].forEach(function(e){return i.setCell(e,{value:""})}),this.jxon.Row.push(i.jxon),this.rows.push(i),i}},{key:"removeRow",value:function(e){return this.rows.splice(e,1),this.jxon.Row.splice(e,1),this.rows}}]),t}(),Xl=function(){lr(t,Bl);var e=pr(t);function t(){return ir(this,t),e.apply(this,arguments)}return or(t,[{key:"getRow",value:function(t){var e=this.rows.find(function(e){return e.name===t});return e||null}},{key:"addRow",value:function(t){var e;if(-1<this.rows.findIndex(function(e){return e.name===t}))throw new Error('Row named "'.concat(t,'" already exists.'));var n=(sr(e={},Vi,t),sr(e,"Cell",[]),e),r=new Fl({name:t,jxon:n,debugType:Hi.Named,archive:this.archive});return Nl[this.type].forEach(function(e){return r.setCell(e,{value:""})}),this.jxon.Row.push(r.jxon),this.rows.push(r),r}},{key:"removeRow",value:function(t){return this.rows=this.rows.filter(function(e){return e.name!==t}),this.jxon.Row=this.jxon.Row.filter(function(e){return e["@N"]!==t}),this.rows}}]),t}(),jl=function(){lr(t,Xl);var e=pr(t);function t(){return ir(this,t),e.apply(this,arguments)}return or(t,[{key:"getProperty",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:"value",r=this.getRow(e);return r?r.cells[n]:null}},{key:"getPropertyNames",value:function(){return this.rows.map(function(e){return e.name})}}]),t}(),zl=function(){lr(r,Gl);var t=pr(r);function r(e){var n;return ir(this,r),n=t.call(this,e),e.cells?n.cells=e.cells:(n.cells=new El({archive:n.archive}),n.jxon.Cell=[],Ol.Geometry.forEach(function(e){var t=Ss(e);n.cells.has(t)||n.cells["_".concat(t)]||n.setCell(e,{value:""})})),n}return or(r,[{key:"getOwnCellNames",value:function(){return bs.prototype.getOwnCellNames.call(this)}},{key:"getCell",value:function(e){return bs.prototype.getCell.call(this,e)}},{key:"setCell",value:function(e,t){Ol.Geometry.includes(e)?bs.prototype.setCell.call(this,e,t):wa.log("Cannot add ".concat(e," cell to Geometry section."))}},{key:"removeCell",value:function(e){bs.prototype.removeCell.call(this,e)}},{key:"toPath",value:function(e,t){var n=this.rows,r=Qa({rows:void 0===n?[]:n},{width:e,height:t});r=Ce.V.normalizePathData(r);for(var i=new Ce.g.Path(r),a=i.segments.length;2<a&&i.segments[a-1].end.equals(i.segments[a-2].end);)i.removeSegment(a-2),a--;return i.translate(0,-t).scale(1,-1),i}},{key:"addRow",value:function(e){var t=gr(ur(r.prototype),"addRow",this).call(this),n=e;return n=n||(1===this.getRows().length?Ji.RelMoveTo:Ji.RelLineTo),t.type=n,t}}]),r}(),Yl=function(e,t,n,r,i,a,o,s){for(var l,u=i,c=0,h=!!o&&pe(o,s,3);c<r;){if(c in n){if(l=h?h(n[c],c,t):n[c],0<a&&ze(l))u=Yl(e,t,l,ae(l.length),u,a-1)-1;else{if(9007199254740991<=u)throw TypeError("Exceed the acceptable array length");e[u]=l}u++}c++}return u},Ul=Yl;he({target:"Array",proto:!0},{flat:function(e){var t=arguments.length?e:void 0,n=ge(this),r=ae(n.length),i=ve(n,0);return i.length=Ul(i,n,n,r,0,void 0===t?1:ie(t)),i}}),Pt("flat");Qo("Map",function(t){return function(e){return t(this,arguments.length?e:void 0)}},as);function Wl(e){if(lu.hasOwnProperty(e)){var t=lu[e];delete lu[e],t()}}function Hl(e){return function(){Wl(e)}}function Jl(e){Wl(e.data)}function ql(e){R.postMessage(e+"",tu.protocol+"//"+tu.host)}var Kl,Ql,Zl,$l=R.Promise,eu=/(iphone|ipod|ipad).*applewebkit/i.test(Ze),tu=R.location,nu=R.setImmediate,ru=R.clearImmediate,iu=R.process,au=R.MessageChannel,ou=R.Dispatch,su=0,lu={},uu="onreadystatechange";nu&&ru||(nu=function(e){for(var t=[],n=1;n<arguments.length;)t.push(arguments[n++]);return lu[++su]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},Kl(su),su},ru=function(e){delete lu[e]},Ts?Kl=function(e){iu.nextTick(Hl(e))}:ou&&ou.now?Kl=function(e){ou.now(Hl(e))}:au&&!eu?(Zl=(Ql=new au).port2,Ql.port1.onmessage=Jl,Kl=pe(Zl.postMessage,Zl,1)):R.addEventListener&&"function"==typeof postMessage&&!R.importScripts&&tu&&"file:"!==tu.protocol&&!v(ql)?(Kl=ql,R.addEventListener("message",Jl,!1)):Kl=uu in o("script")?function(e){yt.appendChild(o("script"))[uu]=function(){yt.removeChild(this),Wl(e)}}:function(e){setTimeout(Hl(e),0)});var cu,hu,fu,pu,gu,du,vu,yu,mu={set:nu,clear:ru},Su=/web0s(?!.*chrome)/i.test(Ze),Cu=E.f,bu=mu.set,ku=R.MutationObserver||R.WebKitMutationObserver,xu=R.document,wu=R.process,Pu=R.Promise,_u=Cu(R,"queueMicrotask"),Tu=_u&&_u.value;Tu||(cu=function(){var e,t;for(Ts&&(e=wu.domain)&&e.exit();hu;){t=hu.fn,hu=hu.next;try{t()}catch(e){throw hu?pu():fu=void 0,e}}fu=void 0,e&&e.enter()},pu=eu||Ts||Su||!ku||!xu?Pu&&Pu.resolve?(vu=Pu.resolve(void 0),yu=vu.then,function(){yu.call(vu,cu)}):Ts?function(){wu.nextTick(cu)}:function(){bu.call(R,cu)}:(gu=!0,du=xu.createTextNode(""),new ku(cu).observe(du,{characterData:!0}),function(){du.data=gu=!gu}));function Au(e){var n,r;this.promise=new e(function(e,t){if(void 0!==n||void 0!==r)throw TypeError("Bad Promise constructor");n=e,r=t}),this.resolve=fe(n),this.reject=fe(r)}function Lu(e,t){if(_(e),I(t)&&t.constructor===e)return t;var n=Xu.f(e);return(0,n.resolve)(t),n.promise}function Mu(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}function Iu(e){var t;return!(!I(e)||"function"!=typeof(t=e.then))&&t}function Ru(h,f){if(!h.notified){h.notified=!0;var p=h.reactions;Gu(function(){for(var e=h.value,t=1==h.state,n=0;p.length>n;){var r,i,a,o=p[n++],s=t?o.ok:o.fail,l=o.resolve,u=o.reject,c=o.domain;try{s?(t||(2===h.rejection&&lc(h),h.rejection=1),!0===s?r=e:(c&&c.enter(),r=s(e),c&&(c.exit(),a=!0)),r===o.promise?u(qu("Promise-chain cycle")):(i=Iu(r))?i.call(r,l,u):l(r)):u(e)}catch(e){c&&!a&&c.exit(),u(e)}}h.reactions=[],h.notified=!1,f&&!h.rejection&&oc(h)})}}function Vu(e,t,n){var r,i;tc?((r=Ku.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),R.dispatchEvent(r)):r={promise:t,reason:n},!nc&&(i=R["on"+e])?i(r):e===rc&&function(e,t){var n=R.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)}function Eu(t,n,r){return function(e){t(n,e,r)}}function Du(e,t,n){e.done||(e.done=!0,n&&(e=n),e.value=t,e.state=2,Ru(e,!0))}var Fu,Ou,Nu,Bu,Gu=Tu||function(e){var t={fn:e,next:void 0};fu&&(fu.next=t),hu||(hu=t,pu()),fu=t},Xu={f:function(e){return new Au(e)}},ju=mu.set,zu=de("species"),Yu="Promise",Uu=be.get,Wu=be.set,Hu=be.getterFor(Yu),Ju=$l,qu=R.TypeError,Ku=R.document,Qu=R.process,Zu=re("fetch"),$u=Xu.f,ec=$u,tc=!!(Ku&&Ku.createEvent&&R.dispatchEvent),nc="function"==typeof PromiseRejectionEvent,rc="unhandledrejection",ic=Xe(Yu,function(){if(!(j(Ju)!==String(Ju))){if(66===at)return!0;if(!Ts&&!nc)return!0}if(51<=at&&/native code/.test(Ju))return!1;function e(e){e(function(){},function(){})}var t=Ju.resolve(1);return(t.constructor={})[zu]=e,!(t.then(function(){})instanceof e)}),ac=ic||!Ko(function(e){Ju.all(e).catch(function(){})}),oc=function(r){ju.call(R,function(){var e,t=r.facade,n=r.value;if(sc(r)&&(e=Mu(function(){Ts?Qu.emit("unhandledRejection",n,t):Vu(rc,t,n)}),r.rejection=Ts||sc(r)?2:1,e.error))throw e.value})},sc=function(e){return 1!==e.rejection&&!e.parent},lc=function(t){ju.call(R,function(){var e=t.facade;Ts?Qu.emit("rejectionHandled",e):Vu("rejectionhandled",e,t.value)})},uc=function(n,e,t){if(!n.done){n.done=!0,t&&(n=t);try{if(n.facade===e)throw qu("Promise can't be resolved itself");var r=Iu(e);r?Gu(function(){var t={done:!1};try{r.call(e,Eu(uc,t,n),Eu(Du,t,n))}catch(e){Du(t,e,n)}}):(n.value=e,n.state=1,Ru(n,!1))}catch(e){Du({done:!1},e,n)}}};ic&&(Ju=function(e){Go(this,Ju,Yu),fe(e),Fu.call(this);var t=Uu(this);try{e(Eu(uc,t),Eu(Du,t))}catch(e){Du(t,e)}},(Fu=function(e){Wu(this,{type:Yu,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=Zo(Ju.prototype,{then:function(e,t){var n=Hu(this),r=$u(gi(this,Ju));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=Ts?Qu.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&Ru(n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),Ou=function(){var e=new Fu,t=Uu(e);this.promise=e,this.resolve=Eu(uc,t),this.reject=Eu(Du,t)},Xu.f=$u=function(e){return e===Ju||e===Nu?new Ou(e):ec(e)},"function"==typeof $l&&(Bu=$l.prototype.then,ke($l.prototype,"then",function(e,t){var n=this;return new Ju(function(e,t){Bu.call(n,e,t)}).then(e,t)},{unsafe:!0}),"function"==typeof Zu&&he({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return Lu(Ju,Zu.apply(R,arguments))}}))),he({global:!0,wrap:!0,forced:ic},{Promise:Ju}),ho(Ju,Yu,!1),$o(Yu),Nu=re(Yu),he({target:Yu,stat:!0,forced:ic},{reject:function(e){var t=$u(this);return t.reject.call(void 0,e),t.promise}}),he({target:Yu,stat:!0,forced:ic},{resolve:function(e){return Lu(this,e)}}),he({target:Yu,stat:!0,forced:ac},{all:function(e){var s=this,t=$u(s),l=t.resolve,u=t.reject,n=Mu(function(){var r=fe(s.resolve),i=[],a=0,o=1;Bo(e,function(e){var t=a++,n=!1;i.push(void 0),o++,r.call(s,e).then(function(e){n||(n=!0,i[t]=e,--o||l(i))},u)}),--o||l(i)});return n.error&&u(n.value),t.promise},race:function(e){var n=this,r=$u(n),i=r.reject,t=Mu(function(){var t=fe(n.resolve);Bo(e,function(e){t.call(n,e).then(r.resolve,i)})});return t.error&&i(t.value),r.promise}});r(function(e){var t=function(o){var l,e=Object.prototype,c=e.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},i=t.iterator||"@@iterator",n=t.asyncIterator||"@@asyncIterator",r=t.toStringTag||"@@toStringTag";function a(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(e){a=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,a=Object.create(i.prototype),o=new A(r||[]);return a._invoke=function(a,o,s){var l=u;return function(e,t){if(l===p)throw new Error("Generator is already running");if(l===g){if("throw"===e)throw t;return M()}for(s.method=e,s.arg=t;;){var n=s.delegate;if(n){var r=P(n,s);if(r){if(r===d)continue;return r}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(l===u)throw l=g,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);l=p;var i=h(a,o,s);if("normal"===i.type){if(l=s.done?g:f,i.arg===d)continue;return{value:i.arg,done:s.done}}"throw"===i.type&&(l=g,s.method="throw",s.arg=i.arg)}}}(e,n,o),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}o.wrap=s;var u="suspendedStart",f="suspendedYield",p="executing",g="completed",d={};function v(){}function y(){}function m(){}var S={};a(S,i,function(){return this});var C=Object.getPrototypeOf,b=C&&C(C(L([])));b&&b!==e&&c.call(b,i)&&(S=b);var k=m.prototype=v.prototype=Object.create(S);function x(e){["next","throw","return"].forEach(function(t){a(e,t,function(e){return this._invoke(t,e)})})}function w(l,u){var t;this._invoke=function(n,r){function e(){return new u(function(e,t){!function t(e,n,r,i){var a=h(l[e],l,n);if("throw"!==a.type){var o=a.arg,s=o.value;return s&&"object"==typeof s&&c.call(s,"__await")?u.resolve(s.__await).then(function(e){t("next",e,r,i)},function(e){t("throw",e,r,i)}):u.resolve(s).then(function(e){o.value=e,r(o)},function(e){return t("throw",e,r,i)})}i(a.arg)}(n,r,e,t)})}return t=t?t.then(e,e):e()}}function P(e,t){var n=e.iterator[t.method];if(n===l){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=l,P(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var r=h(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,d;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=l),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function L(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(c.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=l,e.done=!0,e};return r.next=r}}return{next:M}}function M(){return{value:l,done:!0}}return a(k,"constructor",y.prototype=m),a(m,"constructor",y),y.displayName=a(m,r,"GeneratorFunction"),o.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,a(e,r,"GeneratorFunction")),e.prototype=Object.create(k),e},o.awrap=function(e){return{__await:e}},x(w.prototype),a(w.prototype,n,function(){return this}),o.AsyncIterator=w,o.async=function(e,t,n,r,i){void 0===i&&(i=Promise);var a=new w(s(e,t,n,r),i);return o.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},x(k),a(k,r,"Generator"),a(k,i,function(){return this}),a(k,"toString",function(){return"[object Generator]"}),o.keys=function(n){var r=[];for(var e in n)r.push(e);return r.reverse(),function e(){for(;r.length;){var t=r.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},o.values=L,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&c.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=l)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function e(e,t){return a.type="throw",a.arg=n,r.next=e,t&&(r.method="next",r.arg=l),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],a=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var o=c.call(i,"catchLoc"),s=c.call(i,"finallyLoc");if(o&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(o){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&c.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:L(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=l),d}},o}(e.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}});function cc(e){var t=/^rId(\d+)$/;return t.test(e)||wa.log("incorrect format of relationship to master",e),Aa(e.match(t)[1])}function hc(e){return function(e){1!==Object.keys(e).length&&wa.log("Rel should have one attribute",e)}(e),cc(e[Xi.RelId])}function fc(e,t){var n,r=Ds(e,Pi.ShapeText,t),i=e.orderedNodes,a=void 0===i?[]:i,o=[],s=null,l=null,u=null,c=dc(o,{characterPropertiesIndex:s,paragraphPropertiesIndex:l,tabsPropertiesIndex:u}),h=xr(a);try{for(h.s();!(n=h.n()).done;){var f=n.value;if("string"!=typeof f){var p=f._tagName,g=Ta(f["@IX"]);["cp","pp","tp"].includes(p)?(gc(c)&&(c=dc(o,{characterPropertiesIndex:s,paragraphPropertiesIndex:l,tabsPropertiesIndex:u})),"cp"===p&&(s=g,c.characterPropertiesIndex=g),"pp"===p&&(l=g,c.paragraphPropertiesIndex=g),"tp"===p&&(u=g,c.tabsPropertiesIndex=g)):"fld"===p?pc(c,{fieldIndex:g,defaultValue:f.keyValue}):wa.log("Unknown text tag.",{tagName:p,textJxon:e})}else pc(c,f)}}catch(e){h.e(e)}finally{h.f()}return void 0===o[o.length-1].content&&o.pop(),r.structure=o,r}function pc(e,t){gc(e)||(e.content=[]),e.content.push(t)}function gc(e){return Array.isArray(e.content)}function dc(e,t){var n=t.characterPropertiesIndex,r=t.paragraphPropertiesIndex,i=t.tabsPropertiesIndex,a={};return null!==n&&(a.characterPropertiesIndex=n),null!==r&&(a.paragraphPropertiesIndex=r),null!==i&&(a.tabsPropertiesIndex=i),e.push(a),a}function vc(e,r){var i=this;return r||wa.log("path not defined"),Ka(e).reduce(function(e,t){!function(t){"object"!==$n(t)&&wa.log("Cell is not object.",t),[_i.Name].forEach(function(e){t.hasOwnProperty(e)||wa.log('Cell required key "${key}" missing.',t)})}(t);var n=function(e,t){var n=function(e){return e[_i.Name]}(e);zi.hasOwnProperty(n)||wa.log("unknown cell attribute name",n);return{name:function(e){return"Case"===e?"uppercase":Ss(e)}(n),value:function(e){var t=_i.Value;return t in e?e[t]:e.keyValue}(e),formula:function(e){return e[_i.Formula]}(e)||null,units:function(e){return e[_i.Units]}(e)}}.call(i,t,r);return e[n.name]=n,e},{})}function yc(e,t){return function(s,e,t){var n=1<arguments.length&&void 0!==e?e:{},l=2<arguments.length&&void 0!==t?t:null;return Object.entries(s).filter(function(e){var t=dr(e,2),n=t[0];t[1];return"@"!==n[0]}).reduce(function(e,t){var n=dr(t,2),r=n[0],i=n[1],a=Fs(r,l);e.hasOwnProperty(a)&&wa.log("keys collision ".concat(a),s);var o=i.hasOwnProperty("keyValue")?i.keyValue:null;return e[a]=Es(a,o),e},n)}(e,Ds(e,Pi.DocumentSettings,t))}function mc(i,e){!function(e){1!==Object.keys(e).length&&wa.log("DocumentColor should have one attribute",{documentColorJxon:e})}(i);var t=function(){var e=new Map;return e.set(0,"#000000"),e.set(1,"#FFFFFF"),e.set(2,"#FF0000"),e.set(3,"#00FF00"),e.set(4,"#0000FF"),e.set(5,"#FFFF00"),e.set(6,"#FF00FF"),e.set(7,"#00FFFF"),e.set(8,"#800000"),e.set(9,"#008000"),e.set(10,"#000080"),e.set(11,"#808000"),e.set(12,"#800080"),e.set(13,"#008080"),e.set(14,"#C0C0C0"),e.set(15,"#E6E6E6"),e.set(16,"#CDCDCD"),e.set(17,"#B3B3B3"),e.set(18,"#9A9A9A"),e.set(19,"#808080"),e.set(20,"#666666"),e.set(21,"#4D4D4D"),e.set(22,"#333333"),e.set(23,"#1A1A1A"),e}();return Ka(i[Ni.ColorEntry]).reduce(function(e,t){!function(e){2!==Object.keys(e).length&&wa.log("documentColorEntryRgbJxon should have two attributes",{documentColorEntryRgbJxon:e})}(t);var n=t[Ni.Ix],r=t[Ni.Rgb];return e.has(n)&&wa.log("Color override",{colorsJxon:i}),e.set(n,r),e},t)}var Sc=v(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})});function Cc(e){var t=e.endArrow,n=e.endArrowSize,r=e.beginArrow,i=e.beginArrowSize,a=e.lineWeight,o={};return o.sourceMarker=r?bc(r,i,a):null,o.targetMarker=t?bc(t,n,a):null,o}function bc(e,t,n){var r=1<arguments.length&&void 0!==t?t:0,i=2<arguments.length?n:void 0,a="#000000",o="#000000",s=function(e){switch(e){case 0:return null;case 1:return{d:"M 1 -1 L 0 0 L 1 1",type:"stroke"};case 2:return{d:"M 1 1 L 0 0 L 1 -1 L 1 1",type:"fill"};case 3:return{d:"M 2 -1 0 0 2 1",type:"stroke"};case 4:return{d:"M 2 -1 0 0 2 1 Z",type:"fill"};case 5:return{d:"M 2 1 L 0 0 L 1.98117 -0.993387 C 1.67173 -0.364515 1.67301 0.372641 1.98465 1.00043",type:"fill"};case 6:return{d:"M 2 1 L 0 0 L 2.01237 -1.00641 C 2.32921 -0.372874 2.32921 0.37287 2.01238 1.0064",type:"fill"};case 7:return{d:"M 1.84309 -0.959455 C 1.43792 -0.3808 0.784502 -0.0260248 0.0785258 -0.00137083 L 0.0785228 0.00137063 C 0.784499 0.0260235 1.43791 0.380798 1.84309 0.959452",type:"stroke"};case 8:return{d:"M 1.84309 -0.959455 C 1.43792 -0.3808 0.784502 -0.0260248 0.0785258 -0.00137083 L 0.0785228 0.00137063 C 0.784499 0.0260235 1.43791 0.380798 1.84309 0.959452 C 1.67173 0.364515 1.67301 -0.372641 1.84309 -0.959455",type:"fill"};case 9:return{d:"M -1 -1 0 0 1 1",type:"stroke"};case 10:return{d:"M -1 0 a 1 1 0 1 0 2 0 a 1 1 0 1 0 -2 0",type:"fill"};case 11:return{d:"M -1 -1 1 -1 1 1 -1 1 z",type:"fill"};case 12:return{d:"M 2 -1 0 0 2 1",type:"stroke"};case 13:return{d:"M 3 -1 0 0 3 1 Z",type:"fill"};case 14:return{d:"M 3 -1 0 0 3 1 Z",type:"stroke-empty"};case 15:return{d:"M 1 -1 0 0 1 1 Z",type:"stroke-empty"};case 16:return{d:"M 2 -1 0 0 2 1 Z",type:"stroke-empty"};case 17:return{d:"M 2 1 L 0 0 L 1.98117 -0.993387 C 1.67051 -0.362037 1.67309 0.378293 1.98815 1.00746",type:"stroke-empty"};case 18:return{d:"M 2 1 L 0 0 L 2.01237 -1.00641 C 2.32921 -0.372874 2.32921 0.37287 2.01238 1.0064",type:"stroke-empty"};case 19:return{d:"M 1.95144 1.125 C 1.55653 0.440984 1.54919 -0.400016 1.93211 -1.09082 L 1.92863 -1.09117 C 1.52903 -0.42613 0.815004 -0.013884 0.0392696 -0.000342899 L 0.0392671 0.000342659 C 0.815002 0.0138829 1.52903 0.426128 1.92863 1.09116",type:"stroke-empty"};case 20:return{d:"M -1 0 a 1 1 0 1 0 2 0 a 1 1 0 1 0 -2 0",type:"stroke-empty"};case 21:return{d:"M -1 -1 1 -1 1 1 -1 1 z",type:"stroke-empty"};case 22:return{d:"M 0 0 2 -1 4 0 2 1 z",type:"stroke-empty"};case 23:return{d:"M 2.5 -1 1.5 1",type:"stroke"};case 24:return{d:"M 1.5 -0.75 L 1.5 0.75",type:"stroke"};case 25:return{d:"M 1.5 -0.75 1.5 0.75 M 2.25 -0.75 2.25 0.75",type:"stroke"};case 26:return{d:"M 1.5 -0.75 L 1.5 0.75 M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75",type:"stroke"};case 27:return{d:"M 0 -0.75 L 1.5 0 L 0 0.75",type:"stroke"};case 28:return{d:"M 0 -0.75 L 1.5 0 L 0 0.75 M 2 -0.75 L 2 0.75",type:"stroke"};case 29:return{d:"M 2.25 0.75 C 1.83579 0.75 1.5 0.414214 1.5 0 1.5 -0.414214 1.83579 -0.75 2.25 -0.75 2.66421 -0.75 3 -0.414214 3 0 3 0.414214 2.66421 0.75 2.25 0.75 Z M 0 -0.75 L 1.5 0 L 0 0.75 M 1.5 0 L 0 0",type:"stroke-empty"};case 30:return{d:"M 2.25 0.75 C 1.83579 0.75 1.5 0.414214 1.5 0 1.5 -0.414214 1.83579 -0.75 2.25 -0.75 2.66421 -0.75 3 -0.414214 3 0 3 0.414214 2.66421 0.75 2.25 0.75 Z M 0.75 -0.75 L 0.75 0.75 M 1.5 0 L 0 0",type:"stroke-empty"};case 31:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75",type:"stroke-empty"};case 32:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75",type:"stroke-empty"};case 33:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75 M 3.75 -0.75 L 3.75 0.75",type:"stroke-empty"};case 34:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 1.5 0 L 3.75 -1.15 L 6 0 L 3.75 1.15 L 1.5 0",type:"stroke-empty"};case 35:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75",type:"stroke"};case 36:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75",type:"fill"};case 37:return{d:"",type:"fill"};case 38:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 1.5 0 L 3.75 -1.15 M 3.75 -1.15 L 6 0 M 6 0 L 3.75 1.15 M 3.75 1.15 L 1.5 0",type:"stroke-empty"};case 39:return{d:"M 0 0 L 2 -1 L 2 1 L 0 0 M 2 0 L 4 -1 L 4 1 L 2 0",type:"fill"};case 40:return{d:"M 0 0 L 2 -1 L 2 1 L 0 0 M 2 0 L 4 -1 L 4 1 L 2 0",type:"stroke-empty"};case 41:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z",type:"stroke-empty"};case 42:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75",type:"fill"};case 43:return{d:"M 2 -1 L 0 0 L 2 1 M 4 -1 L 2 0 L 4 1",type:"stroke"};case 44:return{d:"M 2 -1 L 0 0 L 2 1 M 3 0.75 L 3 -0.75",type:"stroke"};case 45:return{d:"M 2 -1 L 0 0 L 2 1 M 4 -1 L 2 0 L 4 1 M 5 0.75 L 5 -0.75",type:"stroke"}}}(e);if(!s)return null;var l=s.d,u=s.type;(l.includes("A")||l.includes("a"))&&(l=Ce.V.normalizePathData(l));var c=new Ce.g.Path(l),h=function(e){switch(e){case 0:return 3.253333333333325;case 1:return 3.7333333333333236;case 2:return 4.693333333333321;case 3:return 5.653333333333319;case 4:return 6.613333333333316;case 5:return 13.3333333333333;case 6:return 25.333333333333268;default:return 4.693333333333321}}(r);return c.scale(h,h),"stroke"===u&&(a="none"),"fill"===u&&(o="none"),"stroke-empty"===u&&(a="#ffffff"),{type:"path",d:c.serialize(),"stroke-width":i,fill:a,stroke:o}}function kc(e){switch(e){case 1:default:return"none";case 2:return"7 5";case 3:return"0 5";case 4:return"7 5 0 5";case 5:return"7 5 0 5 0 5";case 6:return"7 5 7 5 0 5";case 7:return"19 5 7 5";case 8:return"19 5 7 5 7 5";case 9:return"3 3";case 10:return"0 5";case 11:return"3 3 0 3";case 12:return"3 3 0 3 0 3";case 13:return"3 3 3 3 0 3";case 14:return"9 3 3 3";case 15:return"9 3 3 3 3 3";case 16:return"15 9";case 17:return"0 9";case 18:return"15 9 0 9";case 19:return"15 9 0 9 0 9";case 20:return"15 9 15 9 0 9";case 21:return"39 9 15 9";case 22:return"39 9 15 9 15 9";case 23:return"1 2"}}function xc(e,t,n){var r=e.getShape(),i=function(e){var t=dr(e.getComputedGeometry(),1)[0];if(!t)return null;var n=e.width,r=e.height,i=e.pageContent,a=e.cells,o=a.locPinX,s=a.locPinY,l=a.angle,u=a.flipX,c=a.flipY,h=dr(t.toPath(n,r).toPolylines(),1)[0];h.simplify();var f=h.points,p=u&&!c||c&&!u;f.forEach(function(e){var t=o,n=s;e.translate(0,-r).scale(1,-1),l&&e.rotate({x:t,y:n},p?-l:l)});var g=u?-1:1,d=c?-1:1;h.scale(g,d,{x:o,y:s});var v=e.getPageMatrix(),y=v.e,m=i.page.height-v.f;return f.map(function(e){var t=e.x,n=e.y;return{x:y+t,y:m-n}})}(r);if(!Array.isArray(i)||i.length<2)return null;var a={},o=Cc(r.cells),s=o.sourceMarker,l=void 0===s?null:s,u=o.targetMarker,c=void 0===u?null:u,h=r.cells,f=h.lineWeight,p=void 0===f?1:f,g=h.lineColor,d=void 0===g?"#000000":g,v=h.linePattern,y=void 0===v?"none":v,m={line:{sourceMarker:l,targetMarker:c,stroke:d,strokeWidth:Math.max(p,1),strokeDasharray:kc(y)}};r.getComputedGeometry().every(function(e){return e.cells.noShow})&&(m.line.visibility="hidden"),wa.level&wa.TOOLTIPS&&(m.root={title:"".concat(e.tooltip)}),a.attrs=m;var S=i.shift();if(t){var C=Pc(t,S),b=C.dx,k=C.dy;a.source={id:t.id,anchor:{name:"modelCenter",args:{dx:b,dy:k,rotate:!0}}}}else{if(e.getSource())return null;a.source=new Ce.g.Point(S.x,S.y).toJSON()}var x=i.pop();if(n){var w=Pc(n,x),P=w.dx,_=w.dy;a.target={id:n.id,anchor:{name:"modelCenter",args:{dx:P,dy:_,rotate:!0}}}}else{if(e.getTarget())return null;a.target=new Ce.g.Point(x.x,x.y).toJSON()}return a.vertices=i,a}function wc(e,t){var n=function e(t,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;var a=n.id;if(t.has(a))return{shapeId:a,offsetX:r,offsetY:i};if(n.parent)return e(t,n.parent,r,i);return null}(t,e);if(!n)return wa.log("no nearestElement source"),null;var r=n.shapeId;return t.get(r)}function Pc(e,t){var n=1<arguments.length&&void 0!==t?t:{x:0,y:0},r=e.get("position"),i=r.x,a=r.y,o=e.get("size"),s=o.width,l=o.height;return{dx:n.x-i-s/2,dy:n.y-a-l/2}}function _c(e){if(!Ce.util.isObject(e))throw new TypeError("dia.Paper: defineGradient() requires 1. argument to be an object.");var t=e.id||e.type+this.svg.id+Ce.util.hashCode(JSON.stringify(e));if(this.isDefined(t))return t;var n,r,i=e.type;switch(e.type){case"linearGradient":case"radialGradient":var a=function(e,t,n){var r=e.stops,i=e.rotate,a=void 0===i?0:i,o=e.scale,s=void 0===o?"1 1":o,l=e.viewBox;if(!r)throw new TypeError('dia.Paper: definePattern() requires "stops" attribute not empty.');var u="<".concat(n,">\n                ").concat(Ka(r).map(function(e){var t=e.offset,n=e.color,r=e.opacity;return'\n                    <stop\n                    offset="'.concat(t,'"\n                    stop-color="').concat(n,'"\n                    stop-opacity="').concat(r,'"/>')}).join(""),"\n                </").concat(n,">"),c={id:t,gradientTransform:"rotate(".concat(a,") scale(").concat(s,")")};l&&(c.viewBox=l);return{gradientSVGString:u,gradientAttrs:Ce.util.assign(c,e.attrs)}}(e,t,i);n=a.gradientSVGString,r=a.gradientAttrs;break;default:wa.log("Unknown Gradient",e)}return Ce.V(n,r).appendTo(this.defs),t}he({target:"Date",proto:!0,forced:Sc},{toJSON:function(e){var t=ge(this),n=c(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}}),he({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return URL.prototype.toString.call(this)}});var Tc=Ce.dia.Element.define("visio.Element",{},{},{attributes:{filter:{qualify:Ce.util.isPlainObject,set:function(e){return"url(#".concat(function(e){if(!Ce.util.isObject(e))throw new TypeError("dia.Paper: defineFilter() requires 1. argument to be an object.");var t=e.id,n=e.name;if(t=t||n+this.svg.id+Ce.util.hashCode(JSON.stringify(e)),!this.isDefined(t)){var r=Ce.util.filter,i=r[n]&&r[n](e.args||{});if(!i)throw new Error("Non-existing filter "+n);var a=Ce.util.assign({filterUnits:"userSpaceOnUse"},e.attrs,{id:t});Ce.V(i,a).appendTo(this.defs)}return t}.call(this.paper,e),")")}},fill:{qualify:Ce.util.isPlainObject,set:function(e){switch(e.type){case"linearGradient":case"radialGradient":return"url(#"+_c.call(this.paper,e)+")";case"pattern":return"url(#"+function(e){if(!Ce.util.isObject(e))throw new TypeError("dia.Paper: definePattern() requires 1. argument to be an object.");var t=e.id||e.type+this.svg.id+Ce.util.hashCode(JSON.stringify(e));if(this.isDefined(t))return t;var n=e.d,r=e.backgroundColor,i=void 0===r?"#ffffff":r,a=e.color,o=void 0===a?"#000000":a,s=e.strokeWidth,l=void 0===s?1:s,u=e.x,c=void 0===u?0:u,h=e.y,f=void 0===h?0:h,p=e.width,g=void 0===p?10:p,d=e.height,v=void 0===d?10:d,y=e.patternUnits,m=void 0===y?"userSpaceOnUse":y,S=e.strokeOpacity,C=void 0===S?1:S,b=e.fillOpacity,k=void 0===b?1:b,x=e.rotate,w=void 0===x?0:x,P=e.scale,_=void 0===P?"1 1":P,T=e.viewBox,A=void 0===T?"0 0 10 10":T;if(!n)throw new TypeError('dia.Paper: definePattern() requires "d" attribute not empty.');var L='<pattern>\n             <rect\n                width="100%"\n                height="100%"\n                fill-opacity="1"\n                fill="'.concat(i,'"\n                ></rect>\n            <path\n                d="').concat(n,'"\n                stroke="').concat(o,'"\n                stroke-width="').concat(l,'"\n                stroke-opacity="').concat(C,'"\n                fill="').concat(o,'"\n                fill-opacity="').concat(k,'"\n                ></path>\n                </pattern>'),M=Ce.util.assign({id:t,patternUnits:m,x:c,y:f,width:g,height:v,patternTransform:"rotate(".concat(w,") scale(").concat(_,")"),viewBox:A},e.attrs);return Ce.V(L,M).appendTo(this.defs),t}.call(this.paper,e)+")"}}}}}),Ac=Ce.dia.Link.define("visio.Link",{attrs:{line:{connection:!0},wrapper:{connection:!0}}},{markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":10}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none","stroke-linejoin":"round","stroke-linecap":"round",stroke:"#333333"}}]},{});function Lc(e,t){var n=e.toElementAttributes(t);return n?new Tc(n):null}function Mc(e,t,n,r){var i=e.toLinkAttributes(t,n);return i?new Ac(i):Lc(e.getShape(),r)}function Ic(e,t){var n=e.toElementAttributes({noGeometry:!0});return[new Tc(n)]}var Rc=["emf"];function Vc(e,t,n){var r,i=n.extension,a=n.base64,o=n.selector,s={};return!a||Rc.includes(i)?(r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mN0qwcAAREAx9X+/mIAAAAASUVORK5CYII=",s.preserveAspectRatio="none"):r=a,s.xlinkHref=r,t.attr([o],s),r}var Ec=function(){lr(n,ys);var t=pr(n);function n(e){return ir(this,n),t.call(this,e,new Set([Ki.source,Ki.target]))}return or(n,[{key:"referencePageContent",value:function(e){this.pageContent=e}},{key:"getShape",value:function(){return this.pageContent.getShape(this.shapeId)}},{key:"getSource",value:function(){var e=this._source;if(e)return this.pageContent.getShape(e.shapeId);var t=this.getShape();return t.isRootShape()?null:t.getRootShape()}},{key:"getTarget",value:function(){var e=this._target;return e?this.pageContent.getShape(e.shapeId):null}},{key:"tooltip",get:function(){var e=this.getShape();return"connectId: ".concat(e.id," (shapeId)\n")+"type: ".concat(e.type)}},{key:"toLinkAttributes",value:function(e,t){var n=xc(this,e,t);if(!n)return null;var r=this.getShape();return n.z=r.getPageZIndex(),n}},{key:"toLink",value:function(e,t){var n=1<arguments.length&&void 0!==t?t:{},r=n.importConnect,i=void 0===r?Mc:r,a=n.ignoreNonPrinting,o=void 0===a||a;if("function"!=typeof i)return null;var s=this.getShape();if(o&&!s.isPrintable())return null;var l={ignoreNonPrinting:o},u=this.getSource(),c=this.getTarget();return i(this,u?wc(u,e):null,c?wc(c,e):null,l)}},{key:"toLinkLabels",value:function(e,t){var n=(1<arguments.length&&void 0!==t?t:{}).importLabels;return(void 0===n?Ic:n)(this.getShape(),e)}}]),n}();function Dc(e){var n=this,r=new Map;return e.forEach(function(e,t){return r.set(t,new Ec(Zn({archive:n},e)))}),r}function Fc(e,t){return function(e){var i=new Map;return Oc(e).forEach(function(e,t){var n=e.source,r=e.target;i.set(t,{shapeId:t,source:n||null,target:r||null})}),i}(Ka(e[Di.Connect]).map(function(e){return Ds(e,Di.Connect,t)}))}function Oc(e){var r=new Map;return e.forEach(function(e){var t=e.fromSheet;r.has(t)||r.set(t,{source:null,target:null});var n=r.get(t);!function(e){return"BeginX"===e.fromCell}(e)?(n.target&&wa.log("target already set"),n.target={shapeId:e.toSheet,cell:e.toCell,part:e.toPart}):(n.source&&wa.log("source already set"),n.source={shapeId:e.toSheet,cell:e.toCell,part:e.toPart})}),r}function Nc(t,e,n,r){try{return r?e(_(n)[0],n[1]):e(n)}catch(e){throw Oo(t),e}}var Bc=function(){function t(e){ir(this,t),this._attributes={},void 0!==e&&this.setAttributes(e)}return or(t,[{key:"set",value:function(e,t){"archive"!==e&&(this._attributes[e]=t)}},{key:"setAttributes",value:function(e){var i=this;Object.entries(e).forEach(function(e){var t=dr(e,2),n=t[0],r=t[1];return i.set(n,r)})}},{key:"attributes",get:function(){return this._attributes}},{key:"isDummyResult",get:function(){return!0}}]),t}(),Gc=!Ko(function(e){Array.from(e)});he({target:"Array",stat:!0,forced:Gc},{from:function(e,t,n){var r,i,a,o,s,l,u=ge(e),c="function"==typeof this?this:Array,h=arguments.length,f=1<h?t:void 0,p=void 0!==f,g=Fo(u),d=0;if(p&&(f=pe(f,2<h?n:void 0,2)),null==g||c==Array&&Do(g))for(i=new c(r=ae(u.length));d<r;d++)l=p?f(u[d],d):u[d],qt(i,d,l);else for(s=(o=g.call(u)).next,i=new c;!(a=s.call(o)).done;d++)l=p?Nc(o,f,[a.value,d],!0):a.value,qt(i,d,l);return i.length=d,i}});var Xc=Le.indexOf,jc=[].indexOf,zc=!!jc&&1/[1].indexOf(1,-0)<0,Yc=Et("indexOf"),Uc=it("indexOf",{ACCESSORS:!0,1:0});he({target:"Array",proto:!0,forced:zc||!Yc||!Uc},{indexOf:function(e,t){return zc?jc.apply(this,arguments)||0:Xc(this,e,1<arguments.length?t:void 0)}});var Wc=mn.trim;he({target:"String",proto:!0,forced:Us("trim")},{trim:function(){return Wc(this)}});var Hc={"http://schemas.iaresearch.com/JCVGantt":!0},Jc={ElementNode:1,TextNode:3,CdataSectionNode:4,ProcessingInstructionNode:7,CommentNode:8,DocumentNode:9,DocumentTypeNode:10,DocumentFragmentNode:11};function qc(e,t){var n=t&&t.name,r=Hc[t&&t.namespaceURI];return/^(?:true|false)$/i.test(e)&&"PlainText"!==n&&!r?"true"===e.toLowerCase():e}function Kc(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];e.hasChildNodes()&&(this.orderedNodes=Array.from(e.childNodes).filter(function(e){return[Jc.TextNode,Jc.CdataSectionNode,Jc.ElementNode].includes(e.nodeType)}).map(function(e){if(function(e){return e.nodeType===Jc.TextNode||e.nodeType===Jc.CdataSectionNode}(e))return e.nodeValue;if(function(e){return"undefined"!=typeof HTMLHtmlElement&&e.constructor===HTMLHtmlElement}(e))return e;if(n.includes(e.nodeName))return new Kc(e);var t=new Qc(e);return t._tagName=e.tagName,t})),function(e){return e.hasAttributes&&e.hasAttributes()?e.attributes:[]}(e).forEach(function(e){return t["@"+e.name]=qc(e.value,e)})}function Qc(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(t.includes(e.nodeName))this[e.nodeName]=new Kc(e,t);else if(e.hasChildNodes()){for(var n,r,i,a="",o=0;o<e.childNodes.length;o++)(n=e.childNodes.item(o)).nodeType===Jc.TextNode?a+=n.nodeValue.trim():n.nodeType===Jc.CdataSectionNode?a+=n.nodeValue:n.nodeType===Jc.ElementNode&&(r=n.nodeName,t.includes(r)?this[r]=new Kc(n,t):"undefined"!=typeof HTMLHtmlElement&&n.constructor===HTMLHtmlElement?this[r]=n:(i=new Qc(n,t),this.hasOwnProperty(r)?(this[r].constructor!==Array&&(this[r]=[this[r]]),this[r].push(i)):this[r]=i));a&&(this.keyValue=qc(a))}if(e.hasAttributes&&e.hasAttributes())for(var s,l=0;l<e.attributes.length;l++)this["@"+(s=e.attributes.item(l)).name]=qc(s.value,s)}function Zc(e){var t=e.oParentEl,n=e.knownNameSpaces,r=e.slicedSName,i=e.vValue,a=r.split(":");if(a.length<2)t.setAttribute(r,i);else{String(i).match(/^http/)&&eh({knownNameSpaces:n,qualifiedName:r,namespaceURI:i});var o=a[0],s=Object.keys(n).filter(function(e){return"xmlns"===e.split(":")[0]}).map(function(e){return e.split(":")[1]});if("xmlns"===o)t.setAttributeNS("http://www.w3.org/2000/xmlns/",r,i);else if(s.includes(o)){var l=n["xmlns:"+o],u=r,c=i;t.setAttributeNS(l,u,c)}else"r:id"===r&&t.setAttribute(r,i)}}function $c(e){var t=e.knownNameSpaces,n=e.element,r=e.qualifiedName,i=e.namespaceURI;return eh({knownNameSpaces:t,qualifiedName:r,namespaceURI:i}),n.createElementNS(i,r)}function eh(e){var t=e.knownNameSpaces,n=e.qualifiedName,r=e.namespaceURI;t[n]=r}function th(e,p,g){e=function(e){return e}(e);var d={"xmlns:xs":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"};return function e(t,n){var r,i;if(n.constructor===String||n.constructor===Number||n.constructor===Boolean){if(t.appendChild(p.createTextNode(n.toString())),n===n.valueOf())return}else n.constructor===Date&&t.appendChild(p.createTextNode(n.toGMTString()));var a=Object.keys(n);0<a.indexOf("@N")&&(a.splice(a.indexOf("@N"),1),a.unshift("@N"));for(var o=0,s=a.length;o<s;o++){var l=a[o];if(!isFinite(l))if(r=n[l],"keyValue"===l)null!==r&&!0!==r&&t.appendChild(p.createTextNode(r.constructor===Date?r.toGMTString():String(r)));else if("keyAttributes"===l)for(var u in r)t.setAttribute(u,r[u]);else if("@"===l.charAt(0))t.namespaceURI!==r&&Zc({oParentEl:t,knownNameSpaces:d,slicedSName:l.slice(1),vValue:r});else if(r.constructor===HTMLHtmlElement)t.appendChild(r);else if(r.constructor===Array)for(var c=0;c<r.length;c++){var h=g[l.split(":")[0]];h=h||t.namespaceURI,e(i=$c({knownNameSpaces:d,element:p,namespaceURI:h,qualifiedName:l}),r[c]),t.appendChild(i)}else{var f=g[l.split(":")[0]];f=f||t.namespaceURI,i=$c({knownNameSpaces:d,element:p,namespaceURI:f,qualifiedName:l}),r instanceof Object?e(i,r):null!==r&&!0!==r&&i.appendChild(p.createTextNode(r.toString())),t.appendChild(i)}}}(p.documentElement,e),p}function nh(e,t,n){return rh.apply(this,arguments)}function rh(){return(rh=rr(regeneratorRuntime.mark(function e(n,r,i){var a,o,s,l,u,c,h,f,p,g,d,v,y,m,S,C,b,k,x,w,P,_,T,A,L,M=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((a=3<M.length&&void 0!==M[3]?M[3]:{}).base,o=a.structurePathEnrichObject,s=void 0===o?null:o,n&&r&&i||wa.log("Missing required param."),(l=i.slice()).push(Os(r,n,l,{structurePathEnrichObject:s})),(u=new Bc).set("jxon",n),u.setAttributes(Ds(n,r,l)),this&&(c=n[Oi.Cell]||[],u.set(Ki.cells,new El(Zn({archive:this,structurePath:l},vc.call(this,c,l))))),h=n[Oi.Row])return e.t0=u,e.t1=Ki.rows,e.next=14,ch.call(this,h,l);e.next=16;break;case 14:e.t2=e.sent,e.t0.set.call(e.t0,e.t1,e.t2);case 16:if(f=n[Oi.Section])return e.t3=u,e.t4=Ki.sections,e.next=22,Ch.call(this,f,l);e.next=24;break;case 22:e.t5=e.sent,e.t3.set.call(e.t3,e.t4,e.t5);case 24:if((p=n[Oi.Text])&&u.set(Ki.text,fc.call(this,p,l)),(g=n[Oi.Rel])&&u.set(Ki._rel,hc.call(this,g,l)),d=n[Oi.PageSheet])return e.t6=u,e.t7=Ki.pageSheet,e.next=34,ih.call(this,d,l);e.next=36;break;case 34:e.t8=e.sent,e.t6.set.call(e.t6,e.t7,e.t8);case 36:if(v=n[Oi.Icon])return e.t9=u,e.t10=Ki.icon,e.next=42,oh.call(this,v,l);e.next=44;break;case 42:e.t11=e.sent,e.t9.set.call(e.t9,e.t10,e.t11);case 44:if(y=n[Oi.ForeignData])return e.t12=u,e.t13=Ki.foreignData,e.next=50,lh.call(this,y,l);e.next=52;break;case 50:e.t14=e.sent,e.t12.set.call(e.t12,e.t13,e.t14);case 52:if((m=n[Ni.DocumentSettings])&&u.set(Ki.documentSettings,yc.call(this,m,l)),(S=n[Ni.Colors])&&u.set(Ki.colors,mc.call(this,S,l)),C=n[Ni.FaceNames])return e.t15=u,e.t16=Ki.faceNames,e.next=62,gh.call(this,C,l);e.next=64;break;case 62:e.t17=e.sent,e.t15.set.call(e.t15,e.t16,e.t17);case 64:if(b=n[Ni.StyleSheets])return e.t18=u,e.t19=Ki.styleSheets,e.next=70,vh.call(this,b,l);e.next=72;break;case 70:e.t20=e.sent,e.t18.set.call(e.t18,e.t19,e.t20);case 72:if((k=n[Ni.DocumentSheet])&&u.set(Ki.documentSheet,mh.call(this,k,l)),x=n[Di.Shapes])return e.next=78,wh.call(this,x,l);e.next=82;break;case 78:w=e.sent,P=new Map,w.forEach(function(e,t){null!==e?P.set(t,e):wa.log("Skipped shape === null",{shapesJxon:x})}),u.set(Ki.shapes,P);case 82:if(_=n[Fi.Shape])return e.next=86,wh.call(this,_,l);e.next=90;break;case 86:T=e.sent,A=new Map,T.forEach(function(e,t){null!==e?A.set(t,e):wa.log("Skipped shape === null",{shapeJxon:_})}),u.set(Ki.shape,A);case 90:if((L=n[Di.Connects])&&(t=L,0!==Object.keys(t).length)&&u.set(Ki.connects,Dc.call(this,Fc.call(this,L,l))),u.isDummyResult)return e.abrupt("return",u.attributes);e.next=94;break;case 94:return e.abrupt("return",u);case 95:case"end":return e.stop()}var t},e,this)}))).apply(this,arguments)}function ih(e,t){return ah.apply(this,arguments)}function ah(){return(ah=rr(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",nh.call(this,t,Pi.PageSheet,n));case 2:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function oh(e,t){return sh.apply(this,arguments)}function sh(){return(sh=rr(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,nh.call(this,t,Pi.Icon,n);case 3:return r=e.sent,t.hasOwnProperty(Gi.Content)&&(r[Ki.base64]=t[Gi.Content]),e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function lh(e,t){return uh.apply(this,arguments)}function uh(){return(uh=rr(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,l,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nh(t,Pi.ForeignData,n);case 2:if(r=e.sent,(a=n[0].jxonType)===Pi.Page)return o=this.document.pages.get(n[0].pageId),e.next=8,o.getRelsMapCachedAsync();e.next=11;break;case 8:i=e.sent,e.next=20;break;case 11:if(a===Pi.Master)return s=n[0].masterId,l=this.document.masters.get(s),e.next=16,l.getRelsMapCachedAsync();e.next=19;break;case 16:i=e.sent,e.next=20;break;case 19:wa.log("Unhandled ForeignData Type",t);case 20:if(i.has(Pi.Image)){e.next=23;break}return wa.log("missing foreign object relation"),e.abrupt("return",null);case 23:if((u=i.get(Pi.Image)).has(r._rel)){e.next=27;break}return wa.log("missing foreign object relation"),e.abrupt("return",null);case 27:return c=u.get(r._rel),e.abrupt("return",c);case 29:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function ch(e,t){return hh.apply(this,arguments)}function hh(){return(hh=rr(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=Ka(t),i=[],a=xr(r),e.prev=3,a.s();case 5:if((o=a.n()).done){e.next=13;break}return s=o.value,e.next=9,fh.call(this,s,n);case 9:null!==(l=e.sent)&&i.push(l);case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),a.e(e.t0);case 18:return e.prev=18,a.f(),e.finish(18);case 21:return e.abrupt("return",i);case 22:case"end":return e.stop()}},e,this,[[3,15,18,21]])}))).apply(this,arguments)}function fh(e,t){return ph.apply(this,arguments)}function ph(){return(ph=rr(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,nh.call(this,t,Pi.Row,n,{type:name});case 2:if(void 0===(r=e.sent).index&&void 0===r.name)return wa.log("row skipped - invalid XML (no required field)",{parsedRow:r,rowJxon:t,cellsDebug:r.cells?r.cells.debug:"no cells"}),e.abrupt("return",null);e.next=6;break;case 6:return r.debugType=void 0!==r.index?Hi.Indexed:Hi.Named,e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function gh(e,t){return dh.apply(this,arguments)}function dh(){return(dh=rr(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=Ka(t.FaceName),i=[],a=xr(r),e.prev=3,a.s();case 5:if((o=a.n()).done){e.next=13;break}return s=o.value,e.next=9,nh.call(this,s,Pi.FaceName,n);case 9:l=e.sent,i.push(l);case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),a.e(e.t0);case 18:return e.prev=18,a.f(),e.finish(18);case 21:return e.abrupt("return",i);case 22:case"end":return e.stop()}},e,this,[[3,15,18,21]])}))).apply(this,arguments)}function vh(e,t){return yh.apply(this,arguments)}function yh(){return(yh=rr(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=Ka(t.StyleSheet),i=new Map,a=xr(r),e.prev=3,a.s();case 5:if((o=a.n()).done){e.next=13;break}return s=o.value,e.next=9,nh.call(this,s,Pi.StyleSheet,n);case 9:l=e.sent,i.set(l.id,l);case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),a.e(e.t0);case 18:return e.prev=18,a.f(),e.finish(18);case 21:return e.abrupt("return",i);case 22:case"end":return e.stop()}},e,this,[[3,15,18,21]])}))).apply(this,arguments)}function mh(e,t){return Sh.apply(this,arguments)}function Sh(){return(Sh=rr(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",nh.call(this,t,Pi.DocumentSheet,n));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function Ch(e,t){return bh.apply(this,arguments)}function bh(){return(bh=rr(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t||wa.log("Empty section"),r=Ka(t),i=[],a=xr(r),e.prev=4,a.s();case 6:if((o=a.n()).done){e.next=14;break}return s=o.value,e.next=10,nh.call(this,s,Pi.Section,n);case 10:l=e.sent,i.push(l);case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),a.e(e.t0);case 19:return e.prev=19,a.f(),e.finish(19);case 22:return u=i.filter(function(e){return null!==e}),e.abrupt("return",kh.call(this,u));case 24:case"end":return e.stop()}},e,this,[[4,16,19,22]])}))).apply(this,arguments)}function kh(e){var i=this;return e.reduce(function(e,t){var n=Bl.from(Zn(Zn({},t),{},{archive:i})),r=n.type;return e.has(r)||e.set(r,[]),e.get(r).push(n),e},new Map)}var xh=0;function wh(e,t){return Ph.apply(this,arguments)}function Ph(){return(Ph=rr(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t&&n||wa.log("Missing required parameter."),r=Ka(t[Fi.Shape]),i=new Map,a=xr(r),e.prev=4,a.s();case 6:if((o=a.n()).done){e.next=14;break}return s=o.value,e.next=10,_h.call(this,s,n);case 10:l=e.sent,i.set(l.id,Zn({structurePath:n},l));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),a.e(e.t0);case 19:return e.prev=19,a.f(),e.finish(19);case 22:return e.abrupt("return",i);case 23:case"end":return e.stop()}},e,this,[[4,16,19,22]])}))).apply(this,arguments)}function _h(e,t){return Th.apply(this,arguments)}function Th(){return(Th=rr(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,nh.call(this,t,Pi.Shape,n);case 3:if(4294967295===(r=e.sent).id&&(r.id="deleted-"+xh++),r.structurePath=n,(i=r[Ki.type])!==Yi.Shape){e.next=12;break}sr({},Di.Type,Yi.Shape),r.debugType=qi.ShapeSimple,e.next=33;break;case 12:if(i!==Yi.Group){e.next=18;break}sr({},Di.Type,Yi.Group),r.debugType=qi.ShapeGroup,r.shapes||wa.log("property shapes undefined"),e.next=33;break;case 18:if(i!==Yi.Foreign){e.next=22;break}r.debugType=qi.ShapeForeign,e.next=33;break;case 22:if(i!==Yi.Guide){e.next=27;break}r.debugType=qi.ShapeGuide,wa.log("VisioShapeType.Guide investigate"),e.next=33;break;case 27:if(void 0!==i||!r.hasOwnProperty(Ki.deleted)){e.next=31;break}r.debugType=qi.ShapeDeleteOverride,e.next=33;break;case 31:return wa.log('Implement VisioShapeType "'.concat(i,'"'),{shape:t}),e.abrupt("return",null);case 33:return e.abrupt("return",r);case 34:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var Ah=["type","rows","index","cells","jxon","_prefixList","_archive"],Lh=["type","index","name","cells","deleted","debugType","jxon"],Mh=["type","index","name","cells","debugType","jxon","_prefixList","_archive"];function Ih(e,t,r){var i=function(e){var n=new Map;return e.forEach(function(e,t){return n.set(t,e.map(Dh))}),n}(e);return t.forEach(function(e,t){if(!i.get(t))return i.set(t,e);var n=i.get(t);i.set(t,function(i){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],t=2<arguments.length?arguments[2]:void 0,a=t._type,o=t.shape;return e.forEach(function(e){var t=e.index,n=e.deleted,r=i.findIndex(function(e){return e.index===t});n?i.splice(r,1):-1===r?i.push(e):function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=n._type,i=n.shape;Vh(e)!==Vh(t)&&(wa.log(),wa.log("Indexes are not same"));var a=e.rows,o=t.rows;Rh(a),Rh(o);var s={type:t.type,rows:function(s){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],t=2<arguments.length?arguments[2]:void 0;t._type,t.shape;return e.forEach(function(e){var t=e.index,n=e.name,r=e.debugType,i=e.deleted,a=s.findIndex(function(e){return r===Hi.Indexed?e.index===t:e.name===n}),o=Boolean(s[a]);i?o&&s.splice(a,1):-1===a?s.push(e):s[a]=function(e,t){!function(e,t){e.type;var n=e.index,r=e.name,i=(e.cells,e.deleted,e.debugType),a=(e.jxon,hr(e,Lh)),o=(t.type,t.index),s=t.name,l=(t.cells,t.debugType),u=(t.jxon,t._prefixList,t._archive,hr(t,Mh));i!==l&&wa.log("Rows are different");Object.keys(a).length&&wa.log("Unexpected attribute");Object.keys(u).length&&wa.log("Unexpected attribute");n!==o&&wa.log("Rows are different");r!==s&&wa.log("Rows are different");void 0!==n&&void 0!==r&&(wa.log(),wa.log("Row name and index can't be present together.",{indexMaster:n,nameMaster:r}));void 0===n&&void 0===r&&wa.log("A missing index and name of the row. One is required.")}(e,t);var n,r=Eh(e.cells,t.cells);r.setRowType(t.type),t.jxon?n=t.jxon:e.jxon;var i={type:t.type,debugType:t.debugType,jxon:n,cells:r};t.name&&(i.name=e.name);void 0!==t.index&&(i.index=e.index);return i}(s[a],e)}),s}(a,o,{_type:r,shape:i})};(e.cells||t.cells)&&(s.cells=Eh(e.cells,t.cells))}(i[r],e,{_type:a,shape:o})}),i}(n,e,{_type:t,shape:r}))}),i}function Rh(e){Array.isArray(e)||void 0===e||wa.log("Is not array")}function Vh(e){var t=e.type,n=e.rows,r=e.index,i=(e.cells,e.jxon,e._prefixList,e._archive,hr(e,Ah));return Ui.hasOwnProperty(t)||wa.log("Unknown type",t),Array.isArray(n)||void 0===n||wa.log("Unexpected row type"),Object.keys(i).length&&wa.log("Unexpected attribute"),r}function Eh(t,n){return t?(n&&n.attributesSet.forEach(function(e){return t[e]=n.get(e)}),t):n.clone()}function Dh(e){var t=e.type,n=e.rows,r=e.index,i=e.cells,a={};return t&&(a.type=t),void 0!==r&&(a.index=r),n&&(a.rows=n.map(Fh)),i&&(a.cells=i.clone()),a}function Fh(e){var t=e.type,n=e.index,r=e.name,i=e.cells,a=e.debugType,o={};return t&&(o.type=t),r&&(o.name=r),void 0!==n&&(o.index=n),a&&(o.debugType=a),i&&(o.cells=i.clone()),o}function Oh(e,l){if(e&&e.structure){var t=e.structure.reduce(function(t,o){var s={};return[{parsedIndexName:"characterPropertiesIndex",sectionType:Ui.Character,propertyName:"characterProperties"},{parsedIndexName:"paragraphPropertiesIndex",sectionType:Ui.Paragraph,propertyName:"paragraphProperties"},{parsedIndexName:"tabsPropertiesIndex",sectionType:Ui.Tabs,propertyName:"tabsProperties"}].forEach(function(e){var t=e.parsedIndexName,n=e.sectionType,r=e.propertyName,i=o[t];if(void 0!==i){var a=function(e,t){return t.rows[e].cells}(i,l.get(n)[0]);void 0!==a&&(s[r]={cells:a,values:a.directValues})}}),o.content.map(function(e){if("string"==typeof e)return e;var t=e.fieldIndex,n=l.get(Ui.Field)[0].rows[t].cells;return void 0===n&&wa.log("fieldCells undefined"),n.value}).filter(function(e){return""!==e}).forEach(function(e){t.push(Zn({content:e},s))}),t},[]);return t.some(function(e){return void 0===e.content})&&wa.log("contentArray some undefined"),t}}function Nh(e,t,n){for(var r=ge(this),i=ae(r.length),a=arguments.length,o=oe(1<a?t:void 0,i),s=2<a?n:void 0,l=void 0===s?i:oe(s,i);o<l;)r[o++]=e;return r}he({target:"Array",proto:!0},{fill:Nh}),Pt("fill");var Bh={linear:"linear",radial:"radial",rectangle:"rectangle",path:"path"};function Gh(e){var t,n=e.fillGradientDir,r=e.fillGradientSection,i=(e.fillGradientAngle,function(e){switch(e){case 0:return{type:Bh.linear};case 1:return{type:Bh.radial,base:jh.Shape,vertical:Xh.bottom,horizontal:Xh.right};case 2:return{type:Bh.radial,base:jh.Shape,vertical:Xh.bottom,horizontal:Xh.left};case 3:return{type:Bh.radial,base:jh.Shape,vertical:Xh.center,horizontal:Xh.center};case 4:return{type:Bh.radial,base:jh.Shape,vertical:Xh.bottom,horizontal:Xh.center};case 5:return{type:Bh.radial,base:jh.Shape,vertical:Xh.top,horizontal:Xh.center};case 6:case 7:return{type:Bh.radial,base:jh.BoundingBox,vertical:Xh.bottom,horizontal:Xh.right};case 8:return{type:Bh.rectangle,base:jh.Shape,vertical:Xh.bottom,horizontal:Xh.right};case 9:return{type:Bh.rectangle,base:jh.Shape,vertical:Xh.bottom,horizontal:Xh.left};case 10:return{type:Bh.rectangle,base:jh.Shape,vertical:Xh.center,horizontal:Xh.center};case 11:return{type:Bh.rectangle,base:jh.Shape,vertical:Xh.top,horizontal:Xh.right};case 12:return{type:Bh.rectangle,base:jh.Shape,vertical:Xh.top,horizontal:Xh.left};case 13:return{type:Bh.path}}}(n)),a=function(e){return e.rows.map(function(e){return e.cells}).map(function(e){return{offset:e.gradientStopPosition,color:e.gradientStopColor,opacity:1-e.gradientStopColorTrans}})}(r);switch(i.type){case Bh.linear:t="linearGradient";break;default:case Bh.radial:t="radialGradient"}return{type:t,stops:a,attrs:{}}}var Xh={left:"left",right:"right",top:"top",bottom:"bottom",center:"center"},jh={Shape:"Shape",BoundingBox:"BoundingBox"};function zh(e){switch(e){case 2:return{d:"M 2 0 L 2 2",rotate:315,width:4,height:2,scale:"1 1"};case 3:return{d:"M 0 5 L 10 5 M 5 0 L 5 10"};case 4:return{d:"M 0 0 L 10 10 M 0 10 L 10 0"};case 5:return{d:"M 2 0 L 2 2",rotate:45,width:4,height:2,scale:"1 1"};case 6:return{d:"M 0 5 L 10 5"};case 7:return{d:"M 5 0 L 5 10"};case 8:case 9:case 10:return Yh(e);case 11:return{d:"M 0 1 L 2 1 M 2 3 L 4 3",width:3,height:3,viewBox:"0 0 4 4"};case 12:return Yh(e);case 13:return{d:"M 0 2.5 L 1 2.5",width:1,height:3};case 14:return{d:"M 2.5 0 L 2.5 1",width:5,height:1};case 15:return{d:"M 2.5 0 L 2.5 1",rotate:45,width:5,height:1};case 16:return{d:"M 2.5 0 L 2.5 1",rotate:315,width:5,height:1};case 17:case 18:return Yh(e);case 19:return{d:"M 0 2.5 L 1 2.5",width:1,height:5};case 20:return{d:"M 2.5 0 L 2.5 1",width:5,height:1};case 21:return{d:"M 2 0 L 2 2",rotate:45,width:4,height:2};case 22:return{d:"M 2 0 L 2 2",rotate:315,width:4,height:2};case 23:return{d:"M 0 2.5 L 5 2.5 M 2.5 0 L 2.5 5",width:5,height:5};case 24:return Yh(e)}}function Yh(e){return wa.log("unimplemented fill pattern ".concat(e,", ")+"using pattern ".concat(2," instead")),zh(2)}function Uh(e,t,n){var r=1<arguments.length&&void 0!==t?t:{},i=r.origin,a=void 0===i?{x:0,y:0}:i,o=r.prefix,s=void 0===o?"":o,l=r.isRoot,u=void 0!==l&&l,c=2<arguments.length&&void 0!==n?n:{};if(c.ignoreNonPrinting&&!e.isPrintable())return null;var h=e.text,f=e.cells,p=void 0===f?{}:f,g=e.foreignData,d=p.angle,v=void 0===d?0:d,y=p.locPinX,m=void 0===y?0:y,S=p.locPinY,C=void 0===S?0:S,b=p.pinX,k=p.pinY,x=p.width,w=p.height,P=p.flipX,_=p.flipY,T=p.fillForegnd,A=void 0===T?"white":T,L=p.fillBkgnd,M=void 0===L?"#ff0000":L,I=p.lineColor,R=void 0===I?"black":I,V=p.lineWeight,E=p.lineColorTrans,D=void 0===E?0:E,F=p.fillForegndTrans,O=void 0===F?0:F,N=p.linePattern,B=void 0===N?1:N,G=p.fillPattern,X=void 0===G?1:G,j=p.fillGradientDir,z=void 0===j?0:j,Y=p.fillGradientAngle,U=p.fillGradientEnabled,W=void 0!==U&&U,H=[],J={};wa.level&wa.TOOLTIPS&&(J.root={title:"".concat(e.tooltip)});var q={x:a.x+b,y:a.y-w-k},K={width:x,height:w},Q=P?-1:1,Z=_?-1:1,$=-m,ee=_?-2*w+C:C,te=Q*Z*v,ne=m,re=w-C;u&&($+=P?-x+m:m,ee-=_?-w+C:C);var ie=["scale(".concat(Q,", ").concat(Z,")"),"translate(".concat($,", ").concat(ee,")"),"rotate(".concat(te,", ").concat(ne,", ").concat(re,")")].join(" "),ae=c.noGeometry?[]:e.getComputedGeometry();if(0<ae.length){var oe="".concat(s,"foreground");H.push({tagName:"g",selector:oe,children:function(e,t){var a=t.width,o=t.height,n=t.prefix,s=void 0===n?"":n;return e.map(function(e,t){var n={d:e.toPath(a,o).toString(),"stroke-linecap":"round","stroke-linejoin":"round"},r=e.cells,i=void 0===r?{}:r;return i.noFill&&(n.fill="none"),i.noLine&&(n.stroke="none"),i.noShow&&(n.visibility="hidden"),{tagName:"path",selector:"".concat(s,"geometry-").concat(t),attributes:n}})}(ae,{width:x,height:w,prefix:s}),attributes:{transform:ie,"stroke-width":Math.max(V,1)}});var se=J[oe]={};if(0===X?se.fill="none":(se.fill=1===X?A:function(e,t,n){var r=zh(e);if(!r)return t;var i=r.d,a=r.strokeWidth,o=void 0===a?1:a,s=r.x,l=void 0===s?0:s,u=r.y,c=void 0===u?0:u,h=r.width,f=void 0===h?10:h,p=r.height,g=void 0===p?10:p,d=r.patternUnits,v=void 0===d?"userSpaceOnUse":d,y=r.strokeOpacity,m=void 0===y?1:y,S=r.fillOpacity,C=void 0===S?1:S,b=r.rotate,k=void 0===b?0:b,x=r.viewBox,w=void 0===x?void 0:x,P=r.scale,_={type:"pattern",color:t,backgroundColor:n,strokeWidth:o,d:i,x:l,y:c,width:f,height:g,patternUnits:v,strokeOpacity:m,fillOpacity:C,rotate:k,scale:void 0===P?"1 1":P,viewBox:w};return w&&(_.viewBox=w),_}(X,A,M),se.fillOpacity=1-O),W){se.fillOpacity=1-O;var le=e.getComputedSection(Ui.FillGradient);le&&(se.fill=Gh({fillGradientAngle:Y,fillGradientDir:z,fillGradientSection:le,fillBkgnd:M}))}0<B?(se.stroke=R,se.strokeOpacity=1-D,se.strokeDasharray=kc(B)):se.stroke="none",e.isOneDimensional()&&Ce.util.assign(se,Cc(p));var ue=p.shapeShdwType,ce=p.shapeShdwOffsetX,he=p.shapeShdwOffsetY,fe=p.shapeShdwBlur,pe=void 0===fe?0:fe,ge=p.shdwForegnd,de=void 0===ge?"#000":ge,ve=p.shdwForegndTrans,ye=void 0===ve?0:ve;ue&&(se.filter={name:"dropShadow",args:{dx:ce,dy:-he,color:de,opacity:1-ye,blur:pe}})}if(g){var me={tagName:"image",selector:"".concat(s,"image"),groupSelector:"image".concat(g.id),attributes:{x:-x/2,y:w/2,width:x,height:w}};H.push(me)}h&&h.length&&function(e,t){var n=t.markup,r=t.attrs,i=t.prefix,a=t.isRootGroupText,o=e.cells,s=e.width,l=e.height,u=o.angle,c=o.locPinX,h=void 0===c?s/2:c,f=o.locPinY,p=void 0===f?l/2:f,g=o.txtAngle,d=void 0===g?0:g,v=o.flipX,y=o.flipY,m=o.txtHeight,S=void 0===m?l:m,C=o.txtWidth,b=void 0===C?s:C,k=o.txtPinX,x=void 0===k?s/2:k,w=o.txtPinY,P=void 0===w?l/2:w,_=o.txtLocPinX,T=void 0===_?b/2:_,A=o.txtLocPinY,L=void 0===A?S/2:A,M=o.verticalAlign,I=o.leftMargin,R=void 0===I?0:I,V=o.rightMargin,E=void 0===V?0:V,D=o.topMargin,F=void 0===D?0:D,O=o.bottomMargin,N=void 0===O?0:O,B="".concat(i,"text"),G=v?-b+h-x+T:-h+x-T,X=y?l-p+P-L:l-S+p-P+L,j=u,z=v?b-h+x-T:h-x+T,Y=y?p-P+L:S-p+P-L,U=(v?-1:1)*(y?-1:1)*d,W=v?T-b:T,H=y?L:S-L;a&&(G+=h,X-=p);var J=["translate(".concat(G,", ").concat(X,")"),"rotate(".concat(j,", ").concat(z,", ").concat(Y,")"),"rotate(".concat(U,", ").concat(W,", ").concat(H,")")].join(" "),q=[{tagName:"text",selector:B,attributes:{stroke:"none",fill:"#000000"}}];wa.level&wa.TEXT_FRAMES&&q.unshift({tagName:"rect",attributes:{width:b,height:S,fill:"transparent",stroke:"#ff0000",strokeWidth:1}}),n.push({tagName:"g",text:!0,attributes:{transform:J},children:q});var K=$s(e),Q=K.mergedText,Z=K.annotations,$=K.lineHeight,ee=K.firstFont,te=K.firstFontSize,ne=K.horzAlign,re=Qs(Q,{annotations:Z,hyphenationAllowed:!1,maxWidth:b-R-E}),ie=r[B]={text:re.text,lineHeight:$,fontFamily:ee||"sans-serif",letterSpacing:0,firstFontSize:te,annotations:re.annotations},ae=($-te)/2;Ce.util.assign(ie,function(e){var t=e.verticalAlign,n=e.height,r=e.topMargin,i=e.fontShoulder,a=e.bottomMargin,o=e.txtHeight,s=void 0===o?n:o,l=(e.txtLocPinY,(r+s-a)/2),u="middle";switch(t){case 1:break;case 2:l=s-a-i,u="bottom";break;case 0:default:l=r+i,u="top"}return{y:l,textVerticalAnchor:u}}({verticalAlign:M,height:l,topMargin:F,fontShoulder:ae,bottomMargin:N,txtPinY:P,txtLocPinY:L,txtHeight:S}),function(e){var t=e.horzAlign,n=e.width,r=e.leftMargin,i=e.rightMargin,a=e.txtWidth,o=void 0===a?n:a,s=(r+o-i)/2,l="middle";switch(t){case 0:s=r,l="start";break;case 2:s=o-i,l="end"}return{x:s,textAnchor:l}}({horzAlign:ne,width:s,leftMargin:R,rightMargin:E,txtPinX:x,txtLocPinX:T,txtWidth:b}))}(e,{markup:H,attrs:J,prefix:s,isRootGroupText:u});var Se={markup:H,attrs:J,position:q,size:K};return 2===e.cells.objType&&Ce.util.setByPath(Se,["attrs","foreground","fill"],"none"),Se}var Wh=["shapes"],Hh=0,Jh=function(){lr(l,bs);var n,e,i=pr(l);function l(e){var t,n=e.shapes,r=hr(e,Wh);return ir(this,l),r.type||!0===r.deleted||wa.log("Missing type, could not instantiate a VisioShape."),void 0!==(t=i.call(this,r,new Set([Ki.name,Ki.type,Ki.cells,Ki.sections,Ki.master,Ki.shapes,Ki.textStyle]))).masterId&&(t._master=t.masters.get(t.masterId)),n&&t.initShapes(n),t.pageContent.referenceShape(fr(t)),t}return or(l,[{key:"getDefaultAttributes",value:function(){return Zn(Zn({},gr(ur(l.prototype),"getDefaultAttributes",this).call(this)),{},{name:null,type:null,cells:null,sections:new Map,shapes:[],pageContent:null})}},{key:"initShapes",value:function(e){var t=this._master,n=this.masters&&this.masters.get(this.parentMasterId);if(t||n){if(t)this.shapes=this.traverseShapes(e,t.masterShapes);else if(n){var r=n.masterShapesMap.get(this.masterShapeId);this.shapes=this.traverseShapes(e,r.masterShapes)}}else this.shapes=this.instantiateShapes(e)}},{key:"traverseShapes",value:function(e,t){var r=this,n=1<arguments.length&&void 0!==t?t:new Map,i=void 0!==this.masterId?this.masterId:this.parentMasterId,a=this.shapesByMasterShapeId(e),o=0,s=new Map;return n.forEach(function(e,t){var n=a.get(t);(n=n||{id:"dummy-"+Hh++,type:e.type}).deleted||s.set(n.id,r.factory(Zn({masterShape:e,parentMasterId:i,xmlGroupOrder:o++},n)))}),s}},{key:"factory",value:function(e){return new l(Zn({archive:this.archive,parent:this,pageContent:this.pageContent,masters:this.masters},e))}},{key:"getRootShape",value:function(){for(var e=this,t=e.parent;t;)t=(e=t).parent;return e}},{key:"isRootShape",value:function(){return!this.parent}},{key:"shapesByMasterShapeId",value:function(e){var t=new Map;return e.forEach(function(e){e.masterShapeId||wa.log("masterShapeId undefined"),t.set(e.masterShapeId,e)}),t}},{key:"getComputedForeignData",value:function(){var e=this.foreignData,t=this.masterShape;return e||(t&&t.foreignData?t.foreignData:null)}},{key:"hasImage",value:function(){return Boolean(this.getComputedForeignData())}},{key:"getImage",value:(e=rr(regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getComputedForeignData()){e.next=3;break}return e.abrupt("return",null);case 3:return n=t.targetFile,r=t.id,e.next=6,this.archive.getImageAsync(n.absolutePath);case 6:return i=e.sent,e.abrupt("return",Zn(Zn({},i),{},{selector:"image".concat(r)}));case 8:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"referenceMasters",value:function(){var e=void 0!==this.masterId?this.masterId:this.parentMasterId;if(void 0!==e){var t=this.archive.document.masters;if(this.master=t.get(e),this.masterShapeId){var n=this.master.masterShapesMap;this._masterShape=n.get(this.masterShapeId)}else this._masterSubShape=t.getSubShape(e)}}},{key:"masterShape",get:function(){return this._masterShape||this._master},set:function(e){this._masterShape=e}},{key:"instantiateShapes",value:function(e){var n=this,r=void 0!==this.masterId?this.masterId:this.parentMasterId,i=new Map;return e.forEach(function(e,t){return i.set(t,n.factory(Zn({parentMasterId:r},e)))}),i}},{key:"x",get:function(){return this.cells.pinX-this.cells.locPinX}},{key:"y",get:function(){return this.cells.pinY-this.cells.locPinY}},{key:"angle",get:function(){return this.cells.angle}},{key:"height",get:function(){return this.cells.height}},{key:"width",get:function(){return this.cells.width}},{key:"matrix",get:function(){var e=this.x,t=this.y,n=this.angle,r=Ce.V.createSVGMatrix().translate(e,t);return n&&(r=r.rotate(n)),r}},{key:"getPageMatrix",value:function(){var t=Ce.V.createSVGMatrix();return[].concat(yr(this.getAncestorShapes()),[this]).forEach(function(e){t=t.multiply(e.matrix)}),t}},{key:"getPageOrigin",value:function(){var e=this.parent,t=this.pageContent,n=new Ce.g.Point(0,t.page.height);if(e){var r=e.getPageMatrix();n.offset(r.e,-r.f)}return n}},{key:"getPageZIndex",value:function(){return this.getRootShape().xmlOrder}},{key:"getPageAngle",value:function(){return this.getAncestorShapes().reduce(function(e,t){return e+t.angle},this.angle)}},{key:"getPagePosition",value:function(){return this.getPageBBox().origin()}},{key:"getPageBBox",value:function(){var e=this.getPageMatrix(),t=this.width,n=this.height,r=this.pageContent,i=e.e,a=r.page.height-e.f-n;return new Ce.g.Rect(i,a,t,n).normalize()}},{key:"name",get:function(){var e=this.archive.document.languageDependent?this._name:this.nameU;return"string"==typeof e?e:null}},{key:"type",get:function(){return this._type},set:function(e){this._type=e}},{key:"cells",get:function(){if(!this._cells){var e=this.masterShape;if(e&&e.cells)return e.cells}return this._cells},set:function(e){this._cells=e}},{key:"sections",get:function(){return this._cachedSections||this.cacheSections(),this._cachedSections},set:function(e){this._sections=e}},{key:"cacheSections",value:function(){var r=this,i=new Map;this.mergeSections().forEach(function(e,n){var t=e.map(function(e){var t=Bl.from(Zn(Zn({},e),{},{archive:r.archive}));return r._sections.has(n)&&(t.jxon=r._sections.get(n)[0].jxon),t});i.set(n,t)}),this._cachedSections=i}},{key:"mergeSections",value:function(){var e=this.getDefaultSections(),t=Boolean(this._sections),n=Boolean(this.masterShape&&this.masterShape.sections);if(!t&&!n)return e;if(t&&!n)return Ih(e,this._sections,this);if(!t&&n)return Ih(e,this.masterShape.sections,this);var r=this._sections;return Ih(Ih(e,this.masterShape.sections,this),r,this)}},{key:"shapes",get:function(){return this._shapes},set:function(e){this._shapes=e}},{key:"text",get:function(){if(null!==this._cachedText)return this._cachedText||(this._cachedText=this.calculateTextContent()),this._cachedText},set:function(e){this._text=e}},{key:"getSubShapes",value:function(){return yr(this._shapes.values())}},{key:"getAncestorShapes",value:function(){for(var e=[],t=this.parent;t;)e.unshift(t),t=t.parent;return e}},{key:"getSectionNames",value:function(){return yr(this.sections.keys())}},{key:"getOwnSectionNames",value:function(){return yr(this._sections.keys())}},{key:"getSection",value:function(e){if(e===Ui.Geometry)throw new Error("Use getGeometry instead.");if(!Ui[e])throw new Error("Wrong section name: ".concat(e));var t=this._sections.get(e);return Array.isArray(t)&&0!==t.length?t[0]:null}},{key:"getComputedSection",value:function(e){if(e===Ui.Geometry)throw new Error("Use getGeometry instead.");if(!Ui[e])throw new Error("Wrong section name: ".concat(e));var t=this.sections.get(e);return Array.isArray(t)&&0!==t.length?t[0]:null}},{key:"getGeometry",value:function(){var e=this._sections.get(Ui.Geometry);return e||[]}},{key:"getComputedGeometry",value:function(){var e=this.sections.get(Ui.Geometry);return e||[]}},{key:"addSection",value:function(e){var t,n=Ca[e];if(void 0===n)return wa.log("Unhandled section name: ".concat(e)),null;if(this.getSection(e)&&n!==Ca.Geometry)return wa.log('Can not add a section "'.concat(e,'" as it already exists.')),this.getSection(e);var r=(sr(t={},Ri.Name,e),sr(t,"Row",[]),t),i=Bl.from({type:e,jxon:r,archive:this.archive});if(e===Ui.Geometry){var a=this.getComputedGeometry(),o=a.map(function(e){return e.index}).sort().pop();i.index=Number.isInteger(o)?o+1:0,this._sections.set(e,[].concat(yr(a),[i])),r[Ri.Id]=i.index.toString()}else this._sections.set(e,[i]);return this.jxon.Section.push(r),this.cacheSections(),i}},{key:"removeSection",value:function(t,e){var n=1<arguments.length&&void 0!==e?e:0,r=Ca[t];if(void 0!==r)if(r===Hi.Named){this.sections.delete(t);var i=this.jxon.Section.findIndex(function(e){return e[Ri.Name]===t});this.jxon.Section[i]&&this.jxon.Section.splice(i,1)}else{if(!Number.isInteger(n))throw new Error("Index has to be an integer.");var a=this.sections.get(t)||[];if(Array.isArray(a)&&!a[n])throw new Error("Index out of range.");a.splice(n,1),this.sections.set(t,a);var o=this.jxon.Section.findIndex(function(e){return e[Ri.Name]===t&&e[Ri.Id]===n.toString()});this.jxon.Section[o]&&this.jxon.Section.splice(o,1)}}},{key:"getText",value:function(){var e=this.text;return Array.isArray(e)&&0!==e.length?e[0].content.trim():""}},{key:"setText",value:function(e){e&&0<e.length&&(this.text=[{content:e}],this.jxon.Text=[{cp:{"@IX":"0"}},e])}},{key:"calculateTextContent",value:function(){var e=this.sections,t=Oh(this._text,e);if(t)return t;var n=this.masterShape;return n?Oh(n.text,e):null}},{key:"getDefaultSections",value:function(){var e=this.textStyle,t=this.archive.document.styleSheets,n=t.get(e);void 0===n&&wa.log("styleSheet undefined");var r=n.sections||new Map;return 0===e?r:Ih(t.get(0).sections,r,this)}},{key:"master",get:function(){return this._master?this._master:this._masterShape?this._masterShape.master:null}},{key:"getMaster",value:function(){return this.getRootShape().master}},{key:"tooltip",get:function(){var e="shapeId: ".concat(this.id)+"\nwidth: ".concat(this.cells.width)+"\nheight: ".concat(this.cells.height)+"\ntype: ".concat(this.type),t=this.masterShape;t&&(e+="\nmasterShapeId: ".concat(t.id),t.shapeId&&(e+=" (shapeId: ".concat(t.shapeId,")")));var n=this.master;return n&&(e+="\nmasterXml: ".concat(n.xmlPath.split("/").pop())),e+="\nshapeXml: ".concat(this.pageContent.page.xmlPath.split("/").pop()),this.isOneDimensional()&&(e+="\nisOneDimensional"),e}},{key:"textStyle",get:function(){if(void 0!==this._textStyle)return this._textStyle;if(this.masterShape&&void 0!==this.masterShape.textStyle)return this.masterShape.textStyle;var e=this.archive.document.documentSettings.defaultTextStyle;return void 0===e&&wa.log("defaultTextStyle undefined"),e},set:function(e){this._textStyle=e}},{key:"fillStyle",get:function(){if(void 0!==this._fillStyle)return this._fillStyle;if(this.masterShape&&void 0!==this.masterShape.fillStyle)return this.masterShape.fillStyle;var e=this.archive.document.documentSettings.defaultFillStyle;return void 0===e&&wa.log("defaultFillStyle undefined"),e},set:function(e){this._fillStyle=e}},{key:"lineStyle",get:function(){if(void 0!==this._lineStyle)return this._lineStyle;if(this.masterShape&&void 0!==this.masterShape.lineStyle)return this.masterShape.lineStyle;var e=this.archive.document.documentSettings.defaultLineStyle;return void 0===e&&wa.log("defaultLineStyle undefined"),e},set:function(e){this._lineStyle=e}},{key:"isOneDimensional",value:function(){return this.cells.hasEvery([Ki.beginX,Ki.beginY,Ki.endX,Ki.endY])}},{key:"isPrintable",value:function(){return!this.cells.nonPrinting}},{key:"getConnect",value:function(){return this.pageContent.connects.get(this.id)||null}},{key:"toElementAttributes",value:function(e){var t,n=this.getPageOrigin();switch(this.type){case Yi.Group:t=function l(e,t,n){var r=1<arguments.length&&void 0!==t?t:{},i=r.origin,a=void 0===i?{x:0,y:0}:i,o=r.prefix,u=void 0===o?"group":o,s=r.isRoot,c=void 0!==s&&s,h=2<arguments.length&&void 0!==n?n:{};if(h.ignoreNonPrinting&&!e.isPrintable())return null;var f=e.cells,p=e.shapes,g=f.width,d=f.height,v=f.locPinX,y=f.locPinY,m=f.pinX,S=f.pinY,C=f.angle,b=f.flipX,k=f.flipY,x=Uh(e,{origin:{x:0,y:d},prefix:u,isRoot:c},h);if(!x)return null;var w=x.markup,P=[],_=w.findIndex(function(e){return e.text});-1<_&&P.push.apply(P,yr(w.splice(_,1)));var T=x.attrs,A={x:a.x+m-v,y:a.y-S+y-d},L=Ce.V.createSVGMatrix();C&&(L=L.translate(v,y).rotate(C).translate(-v,-y)),b&&(L=L.flipX().translate(-g,0)),k&&(L=L.flipY().translate(0,-d));var M={width:g,height:d};return p.forEach(function(e,t){if(e&&(!h.ignoreSubShapeConnects||!e.getConnect())){var n,r="".concat(u).concat(t);if(n="Group"===e.type?l(e,{origin:{x:0,y:d},prefix:"".concat(r,"-")},h):Uh(e,{origin:{x:0,y:d},prefix:"".concat(r,"-")},h)){var i=n,a=i.markup,o=i.position,s=i.attrs;w.push({tagName:"g",selector:r,children:a,attributes:{transform:Ce.V.matrixToTransformString(L.translate(o.x,o.y))}}),"root"in s&&(s[r]=s.root,delete s.root),Ce.util.assign(T,s)}}}),{markup:[].concat(yr(w),P),attrs:T,position:A,size:M}}(this,{origin:n,isRoot:!0},e);break;case Yi.Shape:case Yi.Foreign:t=Uh(this,{origin:n},e);break;default:return null}return t.z=this.getPageZIndex(),t}},{key:"toElement",value:function(e){var t=0<arguments.length&&void 0!==e?e:{},n=t.importShape,r=void 0===n?Lc:n,i=t.ignoreNonPrinting,a=void 0===i||i,o=t.ignoreSubShapeConnects,s=void 0===o||o;return"function"!=typeof r?null:a&&!this.isPrintable()?null:r(this,{ignoreNonPrinting:a,ignoreSubShapeConnects:s})}}],[{key:"fromMaster",value:(n=rr(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.archive,e.next=3,r.getJxonAsync(t.xmlPath);case 3:return i=e.sent,qh(a=Ce.util.cloneDeep(i.Shapes.Shape),t),e.next=8,nh.call(r,a,Pi.Master,[]);case 8:return o=e.sent,e.next=11,n.getContent({overrideRels:!0});case 11:return s=e.sent,o.master=t,e.abrupt("return",new l(Zn({archive:r,pageContent:s},o)));case 14:case"end":return e.stop()}},e)})),function(e,t){return n.apply(this,arguments)})}]),l}();function qh(e,t){e&&(t?(e[Di.MasterId]=t.id.toString(),e[Ai.NameU]=t.nameU):e[Di.MasterShapeId]=e[Di.Id],e[Oi.Id]=Ce.util.uniqueId(),e.Cell=Kh(e.Cell),e.Section=function(e){return Array.isArray(e)?e.map(function(e){return e.Cell=Kh(e.Cell),e.Row=function(e){return Array.isArray(e)?e.map(function(e){return e.Cell=Kh(e.Cell),e}):void 0!==e?[e]:[]}(e.Row),e}):void 0!==e?[e]:[]}(e.Section),e.Shapes&&(Array.isArray(e.Shapes.Shape)?e.Shapes.Shape.forEach(function(e){return qh(e)}):qh(e.Shapes.Shape)))}function Kh(e){return Array.isArray(e)?e.filter(function(e){return e[_i.Formula]&&-1===e[_i.Formula].indexOf("!")}):void 0!==e?[e]:[]}function Qh(e){var t=e instanceof Array;t||(e=[e]);var n=document.createElement("div"),o=document.createElement("span");n.style.visibility="hidden",n.style.position="absolute",n.style.left="-9999px",n.style.top="0px",n.style.fontWeight="bold",n.style.fontSize="200px !important",o.appendChild(document.createTextNode("~iomwIOMW")),n.appendChild(o),document.body.appendChild(n);var s=[];return e.forEach(function(e,t){o.style.fontFamily="".concat(e,",").concat("monospace, monospace");var n=o.offsetWidth,r=o.offsetHeight;o.style.fontFamily="".concat(e,",").concat("sans-serif");var i=o.offsetWidth,a=o.offsetHeight;s[t]=n==i&&r==a}),document.body.removeChild(n),t||1!=s.length||(s=s[0]),s}function Zh(e){if(void 0===e)return 0;var t=ie(e),n=ae(t);if(t!==n)throw RangeError("Wrong length or index");return n}function $h(e){return[255&e]}function ef(e){return[255&e,e>>8&255]}function tf(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function nf(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function rf(e){return Rf(e,23,4)}function af(e){return Rf(e,52,8)}function of(e,t){Sf(e[wf],t,{get:function(){return Cf(this)[t]}})}function sf(e,t,n,r){var i=Zh(n),a=Cf(e);if(i+t>a.byteLength)throw If(Pf);var o=Cf(a.buffer).bytes,s=i+a.byteOffset,l=o.slice(s,s+t);return r?l:l.reverse()}function lf(e,t,n,r,i,a){var o=Zh(n),s=Cf(e);if(o+t>s.byteLength)throw If(Pf);for(var l=Cf(s.buffer).bytes,u=o+s.byteOffset,c=r(+i),h=0;h<t;h++)l[u+h]=c[a?h:t-h-1]}var uf=function(){function t(e){ir(this,t),e||wa.log("VisioPageContent can only be created using an instance of a Page.",{page:e}),this.page=e,this.rootShapes=new Map,this.shapes=new Map,this.connects=new Map,this.foreignShapes=new Map,this.linkShapes=new Map,this.elementShapes=new Map}var n;return or(t,[{key:"loadAsync",value:(n=rr(regeneratorRuntime.mark(function e(t){var r,n,i,a,o,s,l,u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.page,e.next=3,r.archive.getJxonAsync(r.xmlPath);case 3:return n=e.sent,e.next=6,nh.call(r.archive,n,Pi.Page,[],{structurePathEnrichObject:{pageId:r.id}});case 6:return i=e.sent,a=i.shapes,o=void 0===a?[]:a,s=i.connects,l=void 0===s?[]:s,e.next=10,r.getRelsMapCachedAsync(t);case 10:return e.next=12,r.getMastersFromRelsAsync();case 12:l.forEach(function(e){e.referencePageContent(u),u.connects.set(e.shapeId,e)}),yr(o.values()).forEach(function(e,t){var n=new Jh(Zn({archive:r.archive,masters:r.archive.document.masters,pageContent:u,xmlOrder:t},e));u.rootShapes.set(e.id,n),n.getConnect()||u.elementShapes.set(e.id,n)}),this.connects.forEach(function(e){var t=e.getShape();t&&u.linkShapes.set(t.id,t)});case 16:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"referenceShape",value:function(e){if(this.shapes.set(e.id,e),e.foreignData&&this.setForeignShape(e.foreignData,e),e.masterShape&&e.masterShape.foreignData){var t=e.masterShape;this.setForeignShape(t.foreignData,e,t)}this.referenceShapeInsideCellsDeep(e)}},{key:"setForeignShape",value:function(e,t,n){var r=e.targetFile.absolutePath;this.foreignShapes.has(r)||this.foreignShapes.set(r,[]),this.foreignShapes.get(r).push({foreignData:e,shape:t,master:n})}},{key:"referenceShapeInsideCellsDeep",value:function(t){var n=this;this.referenceShapeInsideCells(t._cells,t),t._sections.forEach(function(e){e.forEach(function(e){e&&e.rows&&e.rows.forEach(function(e){n.referenceShapeInsideCells(e.cells,t)})})})}},{key:"referenceShapeInsideCells",value:function(e,t){e&&(t instanceof Jh||wa.log("shape must be instance of Shape"),(e.shape=t).masterShape&&(e.parent=t.masterShape))}},{key:"toGraphCells",value:function(e){var t=0<arguments.length&&void 0!==e?e:{},n=t.importShape,r=void 0===n?Lc:n,i=t.importConnect,a=void 0===i?Mc:i,o=t.importLabels,s=void 0===o?Ic:o,l=t.importImage,u=void 0===l?Vc:l,c=t.ignoreNonPrinting,h=void 0===c||c,f=t.ignoreSubShapeConnects,p=void 0===f||f,g=t.onImagesLoad,d=void 0===g?null:g,v=new Map,y=new Map,m=new Map;this.getElementShapes().forEach(function(e){var t=e.toElement({importShape:r,ignoreNonPrinting:h,ignoreSubShapeConnects:p});t&&v.set(e.id,t)}),this.getLinkShapes().forEach(function(e){var t=e.getConnect().toLink(v,{importShape:r,importConnect:a,ignoreNonPrinting:h});if(t&&(y.set(e.id,t),t.isLink())){var n=e.getConnect().toLinkLabels(t,{importLabels:s});n&&m.set(e.id,n)}});var S=this.getForeignShapes().map(function(e){return e.map(function(e){return e.shape})}).flat().map(function(r){return rr(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=v.get(r.getRootShape().id)){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,r.getImage();case 5:if(n=e.sent){e.next=8;break}return e.abrupt("return",null);case 8:return e.abrupt("return",u(r,t,n));case 9:case"end":return e.stop()}},e)}))});return Promise.all(S.map(function(e){return e()})).then(function(e){"function"==typeof d&&d(e.filter(function(e){return null!==e}))}),[].concat(yr(v.values()),yr(y.values()),yr(m.values())).flat()}},{key:"getRootShapes",value:function(){return yr(this.rootShapes.values())}},{key:"getRootShape",value:function(e){return this.rootShapes.get(e)||null}},{key:"getShapes",value:function(){return yr(this.shapes.values())}},{key:"getShape",value:function(e){return this.shapes.get(e)||null}},{key:"getConnects",value:function(){return yr(this.connects.values())}},{key:"getConnect",value:function(e){return this.connects.get(e)||null}},{key:"getForeignShapes",value:function(){return yr(this.foreignShapes.values())}},{key:"getForeignShape",value:function(e){return this.foreignShapes.get(e)||null}},{key:"getLinkShapes",value:function(){return yr(this.linkShapes.values())}},{key:"getElementShapes",value:function(){return yr(this.elementShapes.values())}},{key:"getFonts",value:function(){var i=new Set;return this.shapes.forEach(function(e){var t=e.getComputedSection(Ui.Character);if(t){var n=t.getRow(0);if(n){var r=n.getCell(zi.Font).value;void 0===r||"Themed"===r||i.has(r)||i.add(r)}}}),yr(i.values())}},{key:"getUnsupportedFonts",value:function(){return this.getFonts().filter(function(e){return!Qh(e)})}}]),t}(),cf="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,hf=Math.abs,ff=Math.pow,pf=Math.floor,gf=Math.log,df=Math.LN2,vf=function(e,t,n){var r,i,a,o=new Array(n),s=8*n-t-1,l=(1<<s)-1,u=l>>1,c=23===t?ff(2,-24)-ff(2,-77):0,h=e<0||0===e&&1/e<0?1:0,f=0;for((e=hf(e))!=e||e===1/0?(i=e!=e?1:0,r=l):(r=pf(gf(e)/df),e*(a=ff(2,-r))<1&&(r--,a*=2),2<=(e+=1<=r+u?c/a:c*ff(2,1-u))*a&&(r++,a/=2),l<=r+u?(i=0,r=l):1<=r+u?(i=(e*a-1)*ff(2,t),r+=u):(i=e*ff(2,u-1)*ff(2,t),r=0));8<=t;o[f++]=255&i,i/=256,t-=8);for(r=r<<t|i,s+=t;0<s;o[f++]=255&r,r/=256,s-=8);return o[--f]|=128*h,o},yf=function(e,t){var n,r=e.length,i=8*r-t-1,a=(1<<i)-1,o=a>>1,s=i-7,l=r-1,u=e[l--],c=127&u;for(u>>=7;0<s;c=256*c+e[l],l--,s-=8);for(n=c&(1<<-s)-1,c>>=-s,s+=t;0<s;n=256*n+e[l],l--,s-=8);if(0===c)c=1-o;else{if(c===a)return n?NaN:u?-1/0:1/0;n+=ff(2,t),c-=o}return(u?-1:1)*n*ff(2,c-t)},mf=Ve.f,Sf=D.f,Cf=be.get,bf=be.set,kf="ArrayBuffer",xf="DataView",wf="prototype",Pf="Wrong index",_f=R[kf],Tf=_f,Af=R[xf],Lf=Af&&Af[wf],Mf=Object.prototype,If=R.RangeError,Rf=vf,Vf=yf;if(cf){if(!v(function(){_f(1)})||!v(function(){new _f(-1)})||v(function(){return new _f,new _f(1.5),new _f(NaN),_f.name!=kf})){for(var Ef,Df=(Tf=function(e){return Go(this,Tf),new _f(Zh(e))})[wf]=_f[wf],Ff=mf(_f),Of=0;Ff.length>Of;)(Ef=Ff[Of++])in Tf||F(Tf,Ef,_f[Ef]);Df.constructor=Tf}pn&&lo(Lf)!==Mf&&pn(Lf,Mf);var Nf=new Af(new Tf(2)),Bf=Lf.setInt8;Nf.setInt8(0,2147483648),Nf.setInt8(1,2147483649),!Nf.getInt8(0)&&Nf.getInt8(1)||Zo(Lf,{setInt8:function(e,t){Bf.call(this,e,t<<24>>24)},setUint8:function(e,t){Bf.call(this,e,t<<24>>24)}},{unsafe:!0})}else Tf=function(e){Go(this,Tf,kf);var t=Zh(e);bf(this,{bytes:Nh.call(new Array(t),0),byteLength:t}),V||(this.byteLength=t)},Af=function(e,t,n){Go(this,Af,xf),Go(e,Tf,xf);var r=Cf(e).byteLength,i=ie(t);if(i<0||r<i)throw If("Wrong offset");if(r<i+(n=void 0===n?r-i:ae(n)))throw If("Wrong length");bf(this,{buffer:e,byteLength:n,byteOffset:i}),V||(this.buffer=e,this.byteLength=n,this.byteOffset=i)},V&&(of(Tf,"byteLength"),of(Af,"buffer"),of(Af,"byteLength"),of(Af,"byteOffset")),Zo(Af[wf],{getInt8:function(e){return sf(this,1,e)[0]<<24>>24},getUint8:function(e){return sf(this,1,e)[0]},getInt16:function(e,t){var n=sf(this,2,e,1<arguments.length?t:void 0);return(n[1]<<8|n[0])<<16>>16},getUint16:function(e,t){var n=sf(this,2,e,1<arguments.length?t:void 0);return n[1]<<8|n[0]},getInt32:function(e,t){return nf(sf(this,4,e,1<arguments.length?t:void 0))},getUint32:function(e,t){return nf(sf(this,4,e,1<arguments.length?t:void 0))>>>0},getFloat32:function(e,t){return Vf(sf(this,4,e,1<arguments.length?t:void 0),23)},getFloat64:function(e,t){return Vf(sf(this,8,e,1<arguments.length?t:void 0),52)},setInt8:function(e,t){lf(this,1,e,$h,t)},setUint8:function(e,t){lf(this,1,e,$h,t)},setInt16:function(e,t,n){lf(this,2,e,ef,t,2<arguments.length?n:void 0)},setUint16:function(e,t,n){lf(this,2,e,ef,t,2<arguments.length?n:void 0)},setInt32:function(e,t,n){lf(this,4,e,tf,t,2<arguments.length?n:void 0)},setUint32:function(e,t,n){lf(this,4,e,tf,t,2<arguments.length?n:void 0)},setFloat32:function(e,t,n){lf(this,4,e,rf,t,2<arguments.length?n:void 0)},setFloat64:function(e,t,n){lf(this,8,e,af,t,2<arguments.length?n:void 0)}});ho(Tf,kf),ho(Af,xf);var Gf={ArrayBuffer:Tf,DataView:Af},Xf="ArrayBuffer",jf=Gf[Xf],zf=R[Xf];he({global:!0,forced:zf!==jf},{ArrayBuffer:jf}),$o(Xf);var Yf=Gf.ArrayBuffer,Uf=Gf.DataView,Wf=Yf.prototype.slice,Hf=v(function(){return!new Yf(2).slice(1,void 0).byteLength});he({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:Hf},{slice:function(e,t){if(void 0!==Wf&&void 0===t)return Wf.call(_(this),e);for(var n=_(this).byteLength,r=oe(e,n),i=oe(void 0===t?n:t,n),a=new(gi(this,Yf))(ae(i-r)),o=new Uf(this),s=new Uf(a),l=0;r<i;)s.setUint8(l++,o.getUint8(r++));return a}});function Jf(e){if(!I(e))return!1;var t=Fn(e);return f(up,t)||f(cp,t)}var qf,Kf=D.f,Qf=R.Int8Array,Zf=Qf&&Qf.prototype,$f=R.Uint8ClampedArray,ep=$f&&$f.prototype,tp=Qf&&lo(Qf),np=Zf&&lo(Zf),rp=Object.prototype,ip=rp.isPrototypeOf,ap=de("toStringTag"),op=O("TYPED_ARRAY_TAG"),sp=cf&&!!pn&&"Opera"!==Fn(R.opera),lp=!1,up={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},cp={BigInt64Array:8,BigUint64Array:8};for(qf in up)R[qf]||(sp=!1);if((!sp||"function"!=typeof tp||tp===Function.prototype)&&(tp=function(){throw TypeError("Incorrect invocation")},sp))for(qf in up)R[qf]&&pn(R[qf],tp);if((!sp||!np||np===rp)&&(np=tp.prototype,sp))for(qf in up)R[qf]&&pn(R[qf].prototype,np);if(sp&&lo(ep)!==np&&pn(ep,np),V&&!f(np,ap))for(qf in lp=!0,Kf(np,ap,{get:function(){return I(this)?this[op]:void 0}}),up)R[qf]&&F(R[qf],op,qf);function hp(e,t){var n=function(e){var t=ie(e);if(t<0)throw RangeError("The argument can't be less than 0");return t}(e);if(n%t)throw RangeError("Wrong offset");return n}function fp(e,t,n){var r,i,a,o,s,l,u=ge(e),c=arguments.length,h=1<c?t:void 0,f=void 0!==h,p=Fo(u);if(null!=p&&!Do(p))for(l=(s=p.call(u)).next,u=[];!(o=l.call(s)).done;)u.push(o.value);for(f&&2<c&&(h=pe(h,n,2)),i=ae(u.length),a=new(mp(this))(i),r=0;r<i;r++)a[r]=f?h(u[r],r):u[r];return a}var pp={NATIVE_ARRAY_BUFFER_VIEWS:sp,TYPED_ARRAY_TAG:lp&&op,aTypedArray:function(e){if(Jf(e))return e;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(e){if(pn){if(ip.call(tp,e))return e}else for(var t in up)if(f(up,qf)){var n=R[t];if(n&&(e===n||ip.call(n,e)))return e}throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(e,t,n){if(V){if(n)for(var r in up){var i=R[r];i&&f(i.prototype,e)&&delete i.prototype[e]}np[e]&&!n||ke(np,e,n?t:sp&&Zf[e]||t)}},exportTypedArrayStaticMethod:function(e,t,n){var r,i;if(V){if(pn){if(n)for(r in up)(i=R[r])&&f(i,e)&&delete i[e];if(tp[e]&&!n)return;try{return ke(tp,e,n?t:sp&&Qf[e]||t)}catch(e){}}for(r in up)!(i=R[r])||i[e]&&!n||ke(i,e,t)}},isView:function(e){if(!I(e))return!1;var t=Fn(e);return"DataView"===t||f(up,t)||f(cp,t)},isTypedArray:Jf,TypedArray:tp,TypedArrayPrototype:np},gp=pp.NATIVE_ARRAY_BUFFER_VIEWS,dp=R.ArrayBuffer,vp=R.Int8Array,yp=!gp||!v(function(){vp(1)})||!v(function(){new vp(-1)})||!Ko(function(e){new vp,new vp(null),new vp(1.5),new vp(e)},!0)||v(function(){return 1!==new vp(new dp(2),1,void 0).length}),mp=pp.aTypedArrayConstructor;r(function(e){function g(e,t){for(var n=0,r=t.length,i=new(o(e))(r);n<r;)i[n]=t[n++];return i}function t(e,t){m(e,t,{get:function(){return v(this)[t]}})}function d(e){var t;return e instanceof b||"ArrayBuffer"==(t=Fn(e))||"SharedArrayBuffer"==t}function r(e,t){return T(e)&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)}function n(e,t){return r(e,t=c(t,!0))?M(2,e[t]):a(e,t)}function i(e,t,n){return!(r(e,t=c(t,!0))&&I(n)&&f(n,"value"))||f(n,"get")||f(n,"set")||n.configurable||f(n,"writable")&&!n.writable||f(n,"enumerable")&&!n.enumerable?m(e,t,n):(e[t]=n.value,e)}var l=Ve.f,u=Qe.forEach,v=be.get,y=be.set,m=D.f,a=E.f,S=Math.round,C=R.RangeError,b=Gf.ArrayBuffer,k=Gf.DataView,x=pp.NATIVE_ARRAY_BUFFER_VIEWS,w=pp.TYPED_ARRAY_TAG,P=pp.TypedArray,_=pp.TypedArrayPrototype,o=pp.aTypedArrayConstructor,T=pp.isTypedArray,A="BYTES_PER_ELEMENT",L="Wrong length";V?(x||(E.f=n,D.f=i,t(_,"buffer"),t(_,"byteOffset"),t(_,"byteLength"),t(_,"length")),he({target:"Object",stat:!0,forced:!x},{getOwnPropertyDescriptor:n,defineProperty:i}),e.exports=function(e,t,i){function c(e,t){m(e,t,{get:function(){return function(e,t){var n=v(e);return n.view[r](t*h+n.byteOffset,!0)}(this,t)},set:function(e){return function(e,t,n){var r=v(e);i&&(n=(n=S(n))<0?0:255<n?255:255&n),r.view[a](t*h+r.byteOffset,n,!0)}(this,t,e)},enumerable:!0})}var h=e.match(/\d+$/)[0]/8,f=e+(i?"Clamped":"")+"Array",r="get"+e,a="set"+e,o=R[f],p=o,n=p&&p.prototype,s={};x?yp&&(p=t(function(e,t,n,r){return Go(e,p,f),cn(I(t)?d(t)?void 0!==r?new o(t,hp(n,h),r):void 0!==n?new o(t,hp(n,h)):new o(t):T(t)?g(p,t):fp.call(p,t):new o(Zh(t)),e,p)}),pn&&pn(p,P),u(l(o),function(e){e in p||F(p,e,o[e])}),p.prototype=n):(p=t(function(e,t,n,r){Go(e,p,f);var i,a,o,s=0,l=0;if(I(t)){if(!d(t))return T(t)?g(p,t):fp.call(p,t);i=t,l=hp(n,h);var u=t.byteLength;if(void 0===r){if(u%h)throw C(L);if((a=u-l)<0)throw C(L)}else if(u<(a=ae(r)*h)+l)throw C(L);o=a/h}else o=Zh(t),i=new b(a=o*h);for(y(e,{buffer:i,byteOffset:l,byteLength:a,length:o,view:new k(i)});s<o;)c(e,s++)}),pn&&pn(p,P),n=p.prototype=kt(_)),n.constructor!==p&&F(n,"constructor",p),w&&F(n,w,f),s[f]=p,he({global:!0,forced:p!=o,sham:!x},s),A in p||F(p,A,h),A in n||F(n,A,h),$o(f)}):e.exports=function(){}})("Uint8",function(r){return function(e,t,n){return r(this,e,t,n)}});var Sp=Math.min,Cp=[].copyWithin||function(e,t,n){var r=ge(this),i=ae(r.length),a=oe(e,i),o=oe(t,i),s=2<arguments.length?n:void 0,l=Sp((void 0===s?i:oe(s,i))-o,i-a),u=1;for(o<a&&a<o+l&&(u=-1,o+=l-1,a+=l-1);0<l--;)o in r?r[a]=r[o]:delete r[a],a+=u,o+=u;return r},bp=pp.aTypedArray;(0,pp.exportTypedArrayMethod)("copyWithin",function(e,t,n){return Cp.call(bp(this),e,t,2<arguments.length?n:void 0)});var kp=Qe.every,xp=pp.aTypedArray;(0,pp.exportTypedArrayMethod)("every",function(e,t){return kp(xp(this),e,1<arguments.length?t:void 0)});var wp=pp.aTypedArray;(0,pp.exportTypedArrayMethod)("fill",function(e){return Nh.apply(wp(this),arguments)});var Pp=Qe.filter,_p=pp.aTypedArray,Tp=pp.aTypedArrayConstructor;(0,pp.exportTypedArrayMethod)("filter",function(e,t){for(var n=Pp(_p(this),e,1<arguments.length?t:void 0),r=gi(this,this.constructor),i=0,a=n.length,o=new(Tp(r))(a);i<a;)o[i]=n[i++];return o});var Ap=Qe.find,Lp=pp.aTypedArray;(0,pp.exportTypedArrayMethod)("find",function(e,t){return Ap(Lp(this),e,1<arguments.length?t:void 0)});var Mp=Qe.findIndex,Ip=pp.aTypedArray;(0,pp.exportTypedArrayMethod)("findIndex",function(e,t){return Mp(Ip(this),e,1<arguments.length?t:void 0)});var Rp=Qe.forEach,Vp=pp.aTypedArray;(0,pp.exportTypedArrayMethod)("forEach",function(e,t){Rp(Vp(this),e,1<arguments.length?t:void 0)});var Ep=Le.includes,Dp=pp.aTypedArray;(0,pp.exportTypedArrayMethod)("includes",function(e,t){return Ep(Dp(this),e,1<arguments.length?t:void 0)});var Fp=Le.indexOf,Op=pp.aTypedArray;(0,pp.exportTypedArrayMethod)("indexOf",function(e,t){return Fp(Op(this),e,1<arguments.length?t:void 0)});function Np(){return Xp.call(Yp(this))}var Bp=de("iterator"),Gp=R.Uint8Array,Xp=Ao.values,jp=Ao.keys,zp=Ao.entries,Yp=pp.aTypedArray,Up=pp.exportTypedArrayMethod,Wp=Gp&&Gp.prototype[Bp],Hp=!!Wp&&("values"==Wp.name||null==Wp.name);Up("entries",function(){return zp.call(Yp(this))}),Up("keys",function(){return jp.call(Yp(this))}),Up("values",Np,!Hp),Up(Bp,Np,!Hp);var Jp=pp.aTypedArray,qp=[].join;(0,pp.exportTypedArrayMethod)("join",function(e){return qp.apply(Jp(this),arguments)});var Kp=Math.min,Qp=[].lastIndexOf,Zp=!!Qp&&1/[1].lastIndexOf(1,-0)<0,$p=Et("lastIndexOf"),eg=it("indexOf",{ACCESSORS:!0,1:0}),tg=Zp||!$p||!eg?function(e,t){if(Zp)return Qp.apply(this,arguments)||0;var n=u(this),r=ae(n.length),i=r-1;for(1<arguments.length&&(i=Kp(i,ie(t))),i<0&&(i=r+i);0<=i;i--)if(i in n&&n[i]===e)return i||0;return-1}:Qp,ng=pp.aTypedArray;(0,pp.exportTypedArrayMethod)("lastIndexOf",function(e){return tg.apply(ng(this),arguments)});var rg=Qe.map,ig=pp.aTypedArray,ag=pp.aTypedArrayConstructor;(0,pp.exportTypedArrayMethod)("map",function(e,t){return rg(ig(this),e,1<arguments.length?t:void 0,function(e,t){return new(ag(gi(e,e.constructor)))(t)})});var og=_s.left,sg=pp.aTypedArray;(0,pp.exportTypedArrayMethod)("reduce",function(e,t){return og(sg(this),e,arguments.length,1<arguments.length?t:void 0)});var lg=_s.right,ug=pp.aTypedArray;(0,pp.exportTypedArrayMethod)("reduceRight",function(e,t){return lg(ug(this),e,arguments.length,1<arguments.length?t:void 0)});var cg=pp.aTypedArray,hg=pp.exportTypedArrayMethod,fg=Math.floor;hg("reverse",function(){for(var e,t=cg(this).length,n=fg(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this});var pg=pp.aTypedArray;(0,pp.exportTypedArrayMethod)("set",function(e,t){pg(this);var n=hp(1<arguments.length?t:void 0,1),r=this.length,i=ge(e),a=ae(i.length),o=0;if(r<a+n)throw RangeError("Wrong length");for(;o<a;)this[n+o]=i[o++]},v(function(){new Int8Array(1).set({})}));var gg=pp.aTypedArray,dg=pp.aTypedArrayConstructor,vg=[].slice;(0,pp.exportTypedArrayMethod)("slice",function(e,t){for(var n=vg.call(gg(this),e,t),r=gi(this,this.constructor),i=0,a=n.length,o=new(dg(r))(a);i<a;)o[i]=n[i++];return o},v(function(){new Int8Array(1).slice()}));var yg=Qe.some,mg=pp.aTypedArray;(0,pp.exportTypedArrayMethod)("some",function(e,t){return yg(mg(this),e,1<arguments.length?t:void 0)});var Sg=pp.aTypedArray,Cg=[].sort;(0,pp.exportTypedArrayMethod)("sort",function(e){return Cg.call(Sg(this),e)});var bg=pp.aTypedArray;(0,pp.exportTypedArrayMethod)("subarray",function(e,t){var n=bg(this),r=n.length,i=oe(e,r);return new(gi(n,n.constructor))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,ae((void 0===t?r:oe(t,r))-i))});var kg=R.Int8Array,xg=pp.aTypedArray,wg=pp.exportTypedArrayMethod,Pg=[].toLocaleString,_g=[].slice,Tg=!!kg&&v(function(){Pg.call(new kg(1))});wg("toLocaleString",function(){return Pg.apply(Tg?_g.call(xg(this)):xg(this),arguments)},v(function(){return[1,2].toLocaleString()!=new kg([1,2]).toLocaleString()})||!v(function(){kg.prototype.toLocaleString.call([1,2])}));var Ag=pp.exportTypedArrayMethod,Lg=R.Uint8Array,Mg=Lg&&Lg.prototype||{},Ig=[].toString,Rg=[].join;v(function(){Ig.call({})})&&(Ig=function(){return Rg.call(this)});var Vg=Mg.toString!=Ig;Ag("toString",Ig,Vg);var Eg=function(){function t(e){ir(this,t),this._zipApi=e,this._index=Object.entries(this._zipApi.files).reduce(function(e,t){var n=dr(t,2),r=n[0],i=n[1];return e.set(r,i)},new Map),this.cache={jxons:new Map,images:new Map}}var n,r;return or(t,[{key:"getFileReference",value:function(e){return this._index.get(e)}},{key:"getJxonAsync",value:(r=rr(regeneratorRuntime.mark(function e(i){var a,o,s,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.cache.jxons.get(i))return wa.log("used cached copy of JXON: "+"%c".concat(i," "),"color: orange;"),e.abrupt("return",a);e.next=4;break;case 4:if(o=(new Date).getTime(),Dg(i),s=this.getFileReference(i)){e.next=9;break}return e.abrupt("return",null);case 9:return e.next=11,s.async("string");case 11:return l=e.sent,t=l,n=void 0,n=new DOMParser,r=n.parseFromString(t,"application/xml"),u=new Qc(r.documentElement,[Di.Text]),this.cache.jxons.set(i,u),wa.log("read XML and parse to JXON took: "+"".concat((new Date).getTime()-o,"ms %c").concat(i," "),"color: orange;"),e.abrupt("return",u);case 16:case"end":return e.stop()}var t,n,r},e,this)})),function(e){return r.apply(this,arguments)})},{key:"getImageAsync",value:(n=rr(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,l,u,c,h,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.cache.images.get(t))return wa.log("used cached copy of image: "+"%c".concat(t," "),"color: orange;"),e.abrupt("return",n);e.next=4;break;case 4:if(r=(new Date).getTime(),i=this.getFileReference(t)){e.next=8;break}return e.abrupt("return",null);case 8:return e.next=10,i.async("base64");case 10:return a=e.sent,o=/([^/]+\.(jpeg|png|[a-zA-Z]*))$/,s=t.match(o),l=dr(s,3),u=l[1],c=l[2],h="data:image/".concat(c,";base64,")+a,f={absolutePath:t,file:u,extension:c,base64:h},this.cache.images.set(t,f),wa.log("read image and encode to base64 took: "+"".concat((new Date).getTime()-r,"ms %c").concat(t," "),"color: orange;"),e.abrupt("return",f);case 18:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})}]),t}();function Dg(e){e&&/(\.xml|\.rels)$/.test(e)||wa.log("Can't convert to JXON (file extension doesn't match)",e)}function Fg(e){var t=e.relationshipOrArrayOfJxons,l=e.basePath,n=Ka(t);return n.forEach(function(e){}),n.reduce(function(e,t){var n=t[Li.Type];if(!Ii.hasOwnProperty(n))return wa.log('Unknown Relation Type "'.concat(n,'"'),{relationshipJxon:t}),e;var r=t[Li.Target],i=function(e,t,n){var r={0:/^(.*\/)[^/]?/,1:/^(.*\/)(.*\/)[^/]+$/,2:/^(.*\/)(.*\/)(.*\/)[^/]+$/}[2<arguments.length&&void 0!==n?n:0];return function(e){for(var t=e.split("/"),n=t.length-1;0<=n;n--){".."===t[n]&&(t.splice(n-1,2),n--)}return t.join("/")}("/"===t?e:t.match(r)[1]+e)}(r,l),a=cc(t[Li.Id]),o=Ii[n],s={id:a,targetFile:{relativePath:r,absolutePath:i},debugType:o};return e.has(o)||e.set(o,new Map),e.get(o).set(a,s),e},new Map)}function Og(e,t){var n=e.get(t);return n?function(e){1!==e.size&&wa.log("Is not single record JXON",{singleRecordRelationMap:e});return e.values().next().value}(n).targetFile.absolutePath:null}function Ng(){return Bg.apply(this,arguments)}function Bg(){return(Bg=rr(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getJxonAsync("_rels/.rels");case 2:return t=e.sent,e.abrupt("return",Fg({relationshipOrArrayOfJxons:t.Relationship,basePath:"/"}));case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function Gg(){return Xg.apply(this,arguments)}function Xg(){return(Xg=rr(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getJxonAsync("visio/_rels/document.xml.rels");case 2:return t=e.sent,e.abrupt("return",Fg({relationshipOrArrayOfJxons:t.Relationship,basePath:"visio/"}));case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}he({target:"Object",stat:!0},{fromEntries:function(e){var n={};return Bo(e,function(e,t){qt(n,e,t)},{AS_ENTRIES:!0}),n}});var jg=function(){lr(r,ys);var t,e,n=pr(r);function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set;return ir(this,r),t.add(Ki.rels),t.add(Ki.xmlPath),n.call(this,e,t)}return or(r,[{key:"getDefaultAttributes",value:function(){return Zn(Zn({},gr(ur(r.prototype),"getDefaultAttributes",this).call(this)),{},{rels:null,xmlPath:null})}},{key:"getRelsMapCachedAsync",value:(e=rr(regeneratorRuntime.mark(function e(){var t,n=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=0<n.length&&void 0!==n[0]?n[0]:{},this.xmlPath||wa.log("no xml path"),this.rels)return e.abrupt("return",this.rels);e.next=4;break;case 4:return e.next=6,this.getRelsMapAsync.call(this.archive,this.xmlPath,t);case 6:return this.rels=e.sent,e.abrupt("return",this.rels);case 8:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"getRelsMapAsync",value:(t=rr(regeneratorRuntime.mark(function e(t){var n,r,i,a,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(1<o.length&&void 0!==o[1]?o[1]:{}).overrideRels,r=t.replace(er(/^(.*?)((?:(?!\/)[\s\S])*?)$/,{basePath:1,filename:2}),"$<basePath>_rels/$<filename>.rels"),!n){e.next=11;break}if((a=this.document)&&a.masters&&a.masters.map){e.next=7;break}return e.abrupt("return",null);case 7:i={"@xmlns":wi.Relationships,Relationship:[]},a.masters.map.forEach(function(e,t){i.Relationship.push({"@Id":"rId".concat(t+1),"@Type":wi.VisioMasterRelationship,"@Target":e._xmlPath.replace("visio","..")})}),e.next=14;break;case 11:return e.next=13,this.getJxonAsync(r);case 13:i=e.sent;case 14:if(i){e.next=16;break}return e.abrupt("return",null);case 16:return e.abrupt("return",Fg({relationshipOrArrayOfJxons:i.Relationship,basePath:t}));case 17:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"rels",get:function(){return this._rels},set:function(e){this._rels=e}},{key:"xmlPath",get:function(){return this._xmlPath},set:function(e){this._xmlPath=e}}]),r}(),zg=function(){lr(n,jg);var t=pr(n);function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return ir(this,n),t.call(this,e,new Set([Ki.colors,Ki.relations,Ki.pages]))}return or(n,[{key:"getDefaultAttributes",value:function(){return Zn(Zn({},gr(ur(n.prototype),"getDefaultAttributes",this).call(this)),{},{_colors:null,_relations:null,_pages:null,documentSettings:null,faceNames:null,styleSheets:null,documentSheet:null,languageDependent:!0,masterShapesMap:new Map})}},{key:"getMasters",value:function(){return yr(this.masters.map.values())}},{key:"getMastersIdMap",value:function(){return Object.fromEntries(this.masters.map)}},{key:"getMastersNameMap",value:function(){return this.getMasters().reduce(function(e,t){return e[t.name]=t,e},{})}},{key:"getPages",value:function(){return this.pages.toArray()}},{key:"getPage",value:function(e){return this.pages.get(e)}},{key:"name",get:function(){var e=this.documentSheet;return this.languageDependent?e.name:e.nameU}},{key:"colors",get:function(){return this._colors},set:function(e){this._colors=e}},{key:"pages",get:function(){return this._pages},set:function(e){this._pages=e}},{key:"documentSettings",get:function(){return this._documentSettings},set:function(e){this._documentSettings=e}},{key:"faceNames",set:function(e){this._faceNames=e}},{key:"styleSheets",get:function(){return this._styleSheets},set:function(e){this._styleSheets=e}},{key:"documentSheet",get:function(){return this._documentSheet},set:function(e){this._documentSheet=e}}]),n}(),Yg=function(){lr(n,jg);var t=pr(n);function n(e){var i;return ir(this,n),i=t.call(this,e,new Set([Ki.pages])),Object.entries(e).forEach(function(e){var t=dr(e,2),n=t[0],r=t[1];return n="_".concat(n),i[n]=r}),i}return or(n,[{key:"getDefaultAttributes",value:function(){return Zn(Zn({},gr(ur(n.prototype),"getDefaultAttributes",this).call(this)),{},{pages:new Map})}},{key:"get",value:function(e){return this._pages.get(e)||null}},{key:"add",value:function(e){var t=this._pages.size;e.index=t,this._pages.set(e.id,e)}},{key:"toArray",value:function(){return yr(this._pages.values())}}]),n}();function Ug(){return Wg.apply(this,arguments)}function Wg(){return(Wg=rr(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,t){var n=new Image;n.onload=function(){e(n)},n.onerror=function(){t("Could not load image with given URL.",r)},n.src=r}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Hg(e){if("none"===e||"transparent"===e)return e;var t=document.createElement("canvas").getContext("2d");return t.fillStyle=e,t.fillStyle}he({target:"Number",stat:!0,forced:Number.parseInt!=Ys},{parseInt:Ys}),he({global:!0,forced:parseFloat!=xa},{parseFloat:xa});var Jg=/^rgba\(.*,(.+)\)/;function qg(e){if("string"!=typeof e)return!1;if("transparent"===e)return!0;var t=Jg.exec(e);if(!t)return!1;var n=dr(t,2)[1];return 0===parseFloat(n)}function Kg(e,r){var i=[];return e.segments.forEach(function(e){var t,n=[Ce.V.transformPoint(e.end,r)];switch(e.type){case"M":t="MoveTo";break;case"L":case"Z":t="LineTo";break;case"C":t="LineTo",(n=e.toPoints()).forEach(function(e,t){n[t]=Ce.V.transformPoint(e,r)})}n.forEach(function(e){i.push({"@IX":(i.length+1).toString(),"@T":t,Cell:[{"@N":zi.X,"@V":Da(e.x).toString()},{"@N":zi.Y,"@V":Da(e.y).toString()}]})})}),i}var Qg={G:!0,TITLE:!0,TSPAN:!0,TEXTPATH:!0};function Zg(){return $g.apply(this,arguments)}function $g(){return($g=rr(regeneratorRuntime.mark(function e(t,n,r,i,a){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("TEXT"!==(o=t.tagName())){e.next=5;break}td(t,n),e.next=11;break;case 5:if("IMAGE"===o)return e.next=8,nd(t,n,a);e.next=10;break;case 8:e.next=11;break;case 10:o in Qg||id(t,n,r,i);case 11:return ad(t,n),e.abrupt("return",n);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ed(e){var t=e.node.getBoundingClientRect(),n=t.width,r=t.height;return 0!==n||0!==r}function td(e,t){var n=e.node,r=Array.from(n.childNodes).map(function(e){return e.textContent}).join("\n");if(0!==r.length){t.Text={cp:{"@IX":"0","@textPlaceholder":r}};var i={"@N":Ui.Character,Row:[{"@IX":"0",Cell:[]}]},a=i.Row[0].Cell,o=e.attr("font-size");o&&a.push({"@N":zi.Size,"@V":Da(o).toString()});var s=e.attr("font-family");s&&a.push({"@N":zi.Font,"@V":s});var l=e.attr("fill");l&&("transparent"===l||a.push({"@N":zi.Color,"@V":Hg(l)})),t.Section.push(i),t.Cell.push({"@N":zi.LeftMargin,"@V":"0"},{"@N":zi.RightMargin,"@V":"0"},{"@N":zi.TopMargin,"@V":"0"},{"@N":zi.BottomMargin,"@V":"0"})}}function nd(){return rd.apply(this,arguments)}function rd(){return(rd=rr(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,l,u,c,h,f,p,g,d,v;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.attr("xlink:href")||t.attr("href")){e.next=3;break}return e.abrupt("return");case 3:return a=i,o="png",e.next=7,Ug(i);case 7:s=e.sent,(l=document.createElement("canvas")).width=s.width,l.height=s.height,l.getContext("2d").drawImage(s,0,0,s.width,s.height),e.prev=13,a=l.toDataURL("image/png"),e.next=25;break;case 17:if(e.prev=17,e.t0=e.catch(13),wa.log("Can not convert an image (".concat(i,") to data URI:"),e.t0),/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[\w\W]*?[^;])*),(.+)$/.test(i)){e.next=23;break}return e.abrupt("return",n);case 23:"image/svg+xml"===i.split(",")[0].split(":")[1].split(";")[0]&&(o="svg");case 25:u=r.jxon.Relationship.length+1,c="image".concat(u,".").concat(o),n.ForeignData={"@ForeignType":"Bitmap","@CompressionType":o.toUpperCase(),Rel:{"@r:id":"rId".concat(u.toString())}},n["@Type"]=Yi.Foreign,h=t.getBBox(),"none"!==t.attr("preserveAspectRatio")&&(f=h.width/s.width,p=h.height/s.height,g=f<=p?f:p,d=s.width*g,v=s.height*g,h=new Ce.g.Rect({x:(h.width-d)/2,y:(h.height-v)/2,width:d,height:v})),n.Cell.push({"@N":zi.ImgOffsetX,"@V":Da(h.x).toString()},{"@N":zi.ImgOffsetY,"@V":Da(h.y).toString()},{"@N":zi.ImgWidth,"@V":Da(h.width).toString()},{"@N":zi.ImgHeight,"@V":Da(h.height).toString()}),r.jxon.Relationship.push({"@Id":"rId".concat(u),"@Type":wi.DocumentImageRelationships,"@Target":"../media/".concat(c)}),r.data.push({name:c,url:a});case 34:case"end":return e.stop()}},e,null,[[13,17]])}))).apply(this,arguments)}function id(e,t,n,r){var i=n.model,a=e.node,o=i.isElement()&&n.el===a,s=o?new Ce.g.Rect(i.attributes.size):n.getNodeBoundingRect(a),l=r.scaleX,u=r.scaleY,c=Ce.V.createSVGMatrix().scale(l,u).translate(0,s.height).flipY();o||(c=c.translate(-s.x,-s.y));var h=Ce.V.normalizePathData(e.convertToPathData()),f=new Ce.g.Path(h),p=1,g={"@IX":p.toString(),"@N":Ui.Geometry,Cell:[],Row:Kg(f,c)};p++,function(e,t){var n=window.getComputedStyle(e.node),r=n.stroke,i=n.fill,a=t.Cell;i&&a.push({"@N":"NoFill","@V":"none"===i?"1":"0"});r&&a.push({"@N":"NoLine","@V":"0"})}(e,g),t.Section.push(g)}function ad(e,t){var n=window.getComputedStyle(e.node),r=n.stroke,i=n.fill,a=n.strokeWidth,o=t.Cell;"none"===i||i===qg(i)?o.push({"@N":"FillForegndTrans","@V":"1"}):o.push({"@N":"FillForegnd","@V":Hg(i)}),"none"===r||qg(r)?o.push({"@N":"LineColorTrans","@V":"1"}):o.push({"@N":"LineColor","@V":Hg(r)}),a&&o.push({"@N":"LineWeight","@V":String(Da(parseFloat(a)))})}function od(){return sd.apply(this,arguments)}function sd(){return(sd=rr(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.children();case 1:if(0<r.length)return i=r.shift(),e.next=5,n(i);e.next=9;break;case 5:if(!e.sent){e.next=7;break}r.unshift.apply(r,yr(i.children()));case 7:e.next=1;break;case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ld(){return ud.apply(this,arguments)}function ud(){return(ud=rr(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ed(t.vel)){e.next=2;break}return e.abrupt("return",null);case 2:if(t.model.isLink())return e.next=6,fd(t,n);e.next=9;break;case 6:return e.abrupt("return",e.sent);case 9:return e.next=11,cd(t,n);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function cd(){return hd.apply(this,arguments)}function hd(){return(hd=rr(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.model,i=r.getBBox(),a=i.center(),o=t.rotatableNode?0:r.angle(),s=Ce.V.createSVGMatrix().rotate(o),e.abrupt("return",gd(t,n,i,s,a));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function fd(){return pd.apply(this,arguments)}function pd(){return(pd=rr(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.getConnection().bbox(),i=Ce.V.createSVGMatrix().translate(-r.x,-r.y),e.abrupt("return",gd(t,n,r,i));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function gd(){return dd.apply(this,arguments)}function dd(){return(dd=rr(regeneratorRuntime.mark(function e(g,d,t,n,r){var i,a,o,s,l,u,c,v,y,m;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=g.paper,a=g.vel,o=i.getArea(),s=Ce.V.decomposeMatrix(n),l=md(a,t,o,{transformation:s,origin:r}),e.next=6,Zg(a,l,g,s,d);case 6:return u=e.sent,c=a.id,v=sr({},c,u),y=sr({},c,t),m={},e.next=13,od(a,function(){var t=rr(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,l,u,c,h,f,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(ed(t)){e.next=2;break}return e.abrupt("return",!1);case 2:if(n=t.node,r=Ce.V.ensureId(t),i=n.parentNode,a=i.id,o=y[a],s=v[a],l=m[a],u=t.getTransformToElement(i),l&&(u=l.multiply(u)),c=0===t.children().length,"G"!==t.tagName()){e.next=20;break}if(c)return e.abrupt("return",!1);e.next=16;break;case 16:return y[r]=o,v[r]=s,m[r]=u,e.abrupt("return",!0);case 20:return h=y[n.id]=g.getNodeBoundingRect(n),f=Ce.V.decomposeMatrix(u),p=md(t,h,o,{transformation:f}),e.next=25,Zg(t,p,g,f,d);case 25:return s.Shapes.Shape.push(p),c||(v[r]=p),e.abrupt("return",c);case 28:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}());case 13:return e.abrupt("return",u);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function vd(e){var t=e.model,n=e.paper;if(!t.isLink())throw new Error("Can not export dia.Element as a connection.");if(!ed(e.vel))return null;var r=e.getConnection();if(!r)return null;n.getArea();var i=r.bbox(),a=function(e,t){var n=e.vel,r=e.sourcePoint,i=e.targetPoint,a=e.paper,o=yd(n),s=a.getArea().height,l=new Ce.g.Point(r);l.y=s-l.y;var u=new Ce.g.Point(i);return u.y=s-u.y,o.Cell.unshift({"@N":zi.BeginX,"@V":"".concat(Da(l.x)),"@F":"_WALKGLUE(BegTrigger,EndTrigger,WalkPreference)"},{"@N":zi.BeginY,"@V":"".concat(Da(l.y)),"@F":"_WALKGLUE(BegTrigger,EndTrigger,WalkPreference)"},{"@N":zi.EndX,"@V":"".concat(Da(u.x)),"@F":"_WALKGLUE(EndTrigger,BegTrigger,WalkPreference)"},{"@N":zi.EndY,"@V":"".concat(Da(u.y)),"@F":"_WALKGLUE(EndTrigger,BegTrigger,WalkPreference)"},{"@N":zi.Width,"@V":"".concat(Da(u.x-l.x)),"@F":"GUARD(EndX-BeginX)"},{"@N":zi.Height,"@V":"".concat(Da(t.height)),"@F":"GUARD(".concat(Da(t.height),")")},{"@N":zi.Angle,"@V":"0","@F":"GUARD(0 deg)"},{"@N":zi.PinX,"@V":"".concat(Da((l.x+u.x)/2)),"@F":"GUARD((BeginX+EndX)/2))"},{"@N":zi.PinY,"@V":"".concat(Da((l.y+u.y)/2)),"@F":"GUARD((BeginY+EndY)/2)"},{"@N":zi.LocPinX,"@V":"".concat(Da((u.x-l.x)/2)),"@F":"GUARD(Width*0.5)"},{"@N":zi.LocPinY,"@V":"".concat(Da(t.height/2)),"@F":"GUARD(Height*0.5)"},{"@N":zi.FlipX,"@V":"0","@F":"GUARD(FALSE)"},{"@N":zi.FlipY,"@V":"0","@F":"GUARD(FALSE)"}),o}(e,i),o=Ce.V.createSVGMatrix().translate(0,i.height).flipY().translate(-i.x,-i.y),s={"@IX":"0","@N":Ui.Geometry,Cell:[{"@N":zi.NoFill,"@V":"1"},{"@N":zi.NoLine,"@V":"0"},{"@N":zi.NoShow,"@V":"0"},{"@N":zi.NoSnap,"@V":"0"},{"@N":zi.NoQuickDrag,"@V":"0"}],Row:Kg(r,o)};return a.Section.push(s),a}function yd(e){var t="G"===e.tagName()?Yi.Group:Yi.Shape;return{"@ID":Ce.util.uniqueId(),"@LineStyle":"3","@Type":t,Cell:[{"@N":zi.ResizeMode,"@V":"0"}],Section:[],Shapes:{Shape:[]}}}function md(e,t,n,r){var i=r.transformation,a=void 0===i?{}:i,o=r.origin,s=void 0===o?new Ce.g.Point(0,0):o,l=a.translateX,u=void 0===l?0:l,c=a.translateY,h=void 0===c?0:c,f=a.rotation,p=void 0===f?0:f,g=a.scaleX,d=void 0===g?1:g,v=a.scaleY,y=void 0===v?1:v,m=t.width,S=t.height,C=t.center();1===d&&1===y||(C.scale(d,y),m*=d,S*=y),0!==p&&C.rotate(s,-p);var b=new Ce.g.Point(m/2,S/2),k=new Ce.g.Point(u+C.x,n.height-(C.y+h)),x=yd(e);return x.Cell.unshift({"@N":zi.PinX,"@V":"".concat(Da(k.x))},{"@N":zi.PinY,"@V":"".concat(Da(k.y))},{"@N":zi.Width,"@V":"".concat(Da(m))},{"@N":zi.Height,"@V":"".concat(Da(S))},{"@N":zi.LocPinX,"@V":"".concat(Da(b.x))},{"@N":zi.LocPinY,"@V":"".concat(Da(b.y))},{"@N":zi.Angle,"@V":"".concat(Ce.g.toRad(-p))}),x}function Sd(){return Cd.apply(this,arguments)}function Cd(){return(Cd=rr(regeneratorRuntime.mark(function e(l,u,c,h,f,p){var g,d,v,y,m,S,C,b,k,x,w,P,_,T,A,L,M,I,R,V,E,D,F,O,N,B;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:g=l.model,d=new Map,v=g.getElements(),y="function"==typeof f,m={fromConnection:function(){var t=rr(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Td(t,d));case 1:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),fromNodes:function(){var t=rr(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",xd(t,h));case 1:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()},C=S=!1,e.prev=7,k=tr(v);case 9:return e.next=11,k.next();case 11:if(!(S=!(x=e.sent).done)){e.next=30;break}if(w=x.value,P=w.findView(l),_=void 0,y)return e.next=18,bd(P,c,f,m);e.next=21;break;case 18:_=e.sent,e.next=24;break;case 21:return e.next=23,xd(P,h);case 23:_=e.sent;case 24:if(_){e.next=26;break}return e.abrupt("continue",27);case 26:d.set(w.id,_);case 27:S=!1,e.next=9;break;case 30:e.next=36;break;case 32:e.prev=32,e.t0=e.catch(7),C=!0,b=e.t0;case 36:if(e.prev=36,e.prev=37,S&&null!=k.return)return e.next=41,k.return();e.next=41;break;case 41:if(e.prev=41,C)throw b;e.next=44;break;case 44:return e.finish(41);case 45:return e.finish(36);case 46:T=[],A=[],L=g.getLinks(),M="function"==typeof p,R=I=!1,e.prev=52,E=tr(L);case 54:return e.next=56,E.next();case 56:if(!(I=!(D=e.sent).done)){e.next=75;break}if(F=D.value,O=F.findView(l),N=void 0,M)return e.next=63,Pd(O,c,p,m);e.next=66;break;case 63:N=e.sent,e.next=67;break;case 66:N=Td(O,d);case 67:if(N){e.next=69;break}return e.abrupt("continue",72);case 69:t=F,n=d,s=a=void 0,r=N["@ID"].toString(),i=t.source(),a=n.get(i.id),o=t.target(),s=n.get(o.id),B=[{"@FromSheet":r,"@FromCell":zi.BeginX,"@FromPart":"3","@ToSheet":a?a["@ID"].toString():r,"@ToCell":a?zi.PinX:zi.EndX,"@ToPart":a?"3":"9"},{"@FromSheet":r,"@FromCell":zi.EndX,"@FromPart":"3","@ToSheet":s?s["@ID"].toString():r,"@ToCell":s?zi.PinX:zi.BeginX,"@ToPart":s?"3":"9"}],A.push.apply(A,yr(B)),T.push(N);case 72:I=!1,e.next=54;break;case 75:e.next=81;break;case 77:e.prev=77,e.t1=e.catch(52),R=!0,V=e.t1;case 81:if(e.prev=81,e.prev=82,I&&null!=E.return)return e.next=86,E.return();e.next=86;break;case 86:if(e.prev=86,R)throw V;e.next=89;break;case 89:return e.finish(86);case 90:return e.finish(81);case 91:return u.Shapes={Shape:[].concat(yr(d.values()),T)},u.Connects={Connect:[].concat(A)},e.abrupt("return",u);case 94:case"end":return e.stop()}var t,n,r,i,a,o,s},e,null,[[7,32,36,46],[37,,41,45],[52,77,81,91],[82,,86,90]])}))).apply(this,arguments)}function bd(){return kd.apply(this,arguments)}function kd(){return(kd=rr(regeneratorRuntime.mark(function e(t,n,r,i){var a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t,n,i);case 2:if(a=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",a.jxon);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function xd(){return wd.apply(this,arguments)}function wd(){return(wd=rr(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ld(t,n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Pd(){return _d.apply(this,arguments)}function _d(){return(_d=rr(regeneratorRuntime.mark(function e(t,n,r,i){var a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t,n,i);case 2:if(a=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return o=a.jxon,s=vd(t),["BeginX","BeginY","EndX","EndY"].forEach(function(t){var e=s.Cell.find(function(e){return e["@N"]===t});if(e){var n=o.Cell.findIndex(function(e){return e["@N"]===t});-1<n?o.Cell.splice(n,1,e):o.Cell.push(e)}}),e.abrupt("return",o);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Td(e,t){var n=e.model,r=vd(e);r["@Type"]=Yi.Shape;var i=n.source(),a=n.target(),o=t.get(i.id),s=t.get(a.id),l="".concat(o?"Sheet":"Dynamic connector",".").concat(o?o["@ID"]:r["@ID"]),u="".concat(s?"Sheet":"Dynamic connector",".").concat(s?s["@ID"]:r["@ID"]);return r.Cell.push({"@N":zi.BegTrigger,"@V":o?"2":"1","@F":"_XFTRIGGER(".concat(l,"!EventXFMod)")},{"@N":zi.EndTrigger,"@V":s?"2":"1","@F":"_XFTRIGGER(".concat(u,"!EventXFMod)")},{"@N":zi.ObjType,"@V":"2"}),r}var Ad={XML:"xml",IMAGE:"image"};function Ld(){return Md.apply(this,arguments)}function Md(){return(Md=rr(regeneratorRuntime.mark(function e(i,a){var o,s,l,u,c,h,f,p,g,d,v,y,m=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=(o=2<m.length&&void 0!==m[2]?m[2]:{}).exportElement,l=o.exportLink,u={},c=a.archive,h={data:[],jxon:{Relationship:[]}},e.t0=Ad.XML,e.next=7,Id(c);case 7:return e.t1=e.sent,u["docProps/custom.xml"]={type:e.t0,content:e.t1},f=a.fileName,e.t2=Ad.XML,e.next=13,Od(i,a,h,s,l);case 13:return e.t3=e.sent,u["visio/pages/".concat(f,".xml")]={type:e.t2,content:e.t3},e.t4=Ad.XML,e.next=18,Dd(i,a,c);case 18:return e.t5=e.sent,u["visio/pages/pages.xml"]={type:e.t4,content:e.t5},e.t6=Ad.XML,e.next=23,t=h.jxon,void 0,n=document.implementation.createDocument(wi.Relationships,"Relationships",null),r=th(t,n,{xmlns:wi.Relationships}),'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+(new XMLSerializer).serializeToString(r);case 23:return e.t7=e.sent,u["visio/pages/_rels/".concat(f,".xml.rels")]={type:e.t6,content:e.t7},e.next=27,c.getJxonAsync("[Content_Types].xml");case 27:p=e.sent,u["[Content_Types].xml"]={type:Ad.XML,content:Vd(p)},g=[],d=xr(h.data);try{for(y=function(){var a=v.value;g.push(new Promise(function(r,i){Ce.util.imageToDataUri(a.url,function(e,t){var n;e&&i();try{n=Ce.util.dataUriToBlob(t)}catch(e){wa.log("Can not convert an image to blob: ".concat(e))}n&&(u["visio/media/".concat(a.name)]={type:Ad.IMAGE,content:n}),r()})}))},d.s();!(v=d.n()).done;)y()}catch(e){d.e(e)}finally{d.f()}return e.abrupt("return",Promise.all(g).then(function(){return u}));case 33:case"end":return e.stop()}var t,n,r},e)}))).apply(this,arguments)}function Id(){return Rd.apply(this,arguments)}function Rd(){return(Rd=rr(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getJxonAsync("docProps/custom.xml");case 2:return n=e.sent,r=Math.max.apply(Math,n.property.map(function(e){return Number.parseInt(e["@pid"])})),i={"@fmtid":"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}","@pid":(r+1).toString(),"@name":"RecalcDocument","vt:bool":{keyValue:"true"}},n.property.push(i),a=document.implementation.createDocument(wi.CustomProperties,"Properties",null),o=th(n,a,{vt:wi.DocPropsVTypes}),s=(new XMLSerializer).serializeToString(o),e.abrupt("return",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+s);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Vd(){return Ed.apply(this,arguments)}function Ed(){return(Ed=rr(regeneratorRuntime.mark(function e(t){var n,r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.Default.map(function(e){return e["@Extension"]}),[{name:"emf",type:"image/x-emf"},{name:"png",type:"image/png"},{name:"gif",type:"image/gif"},{name:"jpeg",type:"image/jpeg"},{name:"svg",type:"image/svg+xml"}].forEach(function(e){-1===n.indexOf(e.name)&&t.Default.unshift({"@Extension":e.name,"@ContentType":e.type})}),r=document.implementation.createDocument(wi.ContentTypes,"Types",null),i=th(t,r,{xmlns:wi.ContentTypes}),a=(new XMLSerializer).serializeToString(i),e.abrupt("return",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+a);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Dd(){return Fd.apply(this,arguments)}function Fd(){return(Fd=rr(regeneratorRuntime.mark(function e(t,n,r){var i,a,o,s,l,u,c,h,f,p,g,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getJxonAsync("visio/pages/pages.xml");case 2:return i=e.sent,a=t.getArea(),Array.isArray(i.Page)||(i.Page=[i.Page]),(o=i.Page.find(function(e){return e["@ID"]===n.id.toString()}))?(s=o.PageSheet.Cell,l=s.findIndex(function(e){return e["@N"]===zi.PageWidth}),u=s.findIndex(function(e){return e["@N"]===zi.PageHeight}),c={"@N":zi.PageWidth,"@V":Da(a.width).toString()},Number.isNaN(l)?s.push(c):s[l]=c,h={"@N":zi.PageHeight,"@V":Da(a.height).toString()},Number.isNaN(u)?s.push(h):s[u]=h):wa.log("Page with id ".concat(n.id," was not found.")),f=document.implementation.createDocument(wi.Main,"Pages",null),p=th(i,f,{xmlns:wi.Main,r:wi.DocumentRelationships}),g=new XMLSerializer,d=g.serializeToString(p),e.abrupt("return",'<?xml version="1.0" encoding="utf-8"?>'+d);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Od(){return Nd.apply(this,arguments)}function Nd(){return(Nd=rr(regeneratorRuntime.mark(function e(t,n,r,i,a){var o,s,l,u,c,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.archive.getJxonAsync(n.xmlPath);case 2:return o=e.sent,e.next=5,Sd(t,o,n,r,i,a);case 5:return s=e.sent,l=document.implementation.createDocument(wi.Main,"PageContents",null),u=th(s,l,{xmlns:wi.Main,r:wi.DocumentRelationships}),c=new XMLSerializer,h=c.serializeToString(u).replace(/(<cp IX="0")(?: textPlaceholder="(.*?)")(\/>)/gm,function(){var e=Array.prototype.slice.call(arguments),t=e[1],n=e[2];return t+e[3]+n}),e.abrupt("return",'<?xml version="1.0" encoding="utf-8"?>'+h);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Bd=["pageSheet"],Gd=function(){lr(i,jg);var t,e,n,r=pr(i);function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return ir(this,i),r.call(this,e,new Set([Ki.pages,Ki.shapes,Ki.connects,Ki.foreignShapes,Ki.background,Ki.backPage]))}return or(i,[{key:"getDefaultAttributes",value:function(){return Zn(Zn({},gr(ur(i.prototype),"getDefaultAttributes",this).call(this)),{},{shapes:new Map,connects:new Map,pages:null,foreignShapes:new Map,allShapes:new Map,cache:new Map})}},{key:"setAttributes",value:function(e){var t=e.pageSheet,n=hr(e,Bd);gr(ur(i.prototype),"setAttributes",this).call(this,Zn({pageSheet:t},n)),t&&this.referenceInCells()}},{key:"referenceInCells",value:function(){var e=this.pageSheet,t=this.archive;e&&e.cells&&(e.cells.parent=t.document.pageSheet)}},{key:"getContent",value:(n=rr(regeneratorRuntime.mark(function e(){var t,n,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<r.length&&void 0!==r[0]?r[0]:{},n=new uf(this),e.next=4,n.loadAsync(t);case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"getMastersFromRelsAsync",value:(e=rr(regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.archive,n=t.document,r=n.masters,this.rels){e.next=5;break}return e.abrupt("return",null);case 5:if(i=this.rels.get(Mi.Master))return e.next=9,r.loadMasters(i);e.next=9;break;case 9:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"background",get:function(){return Boolean(this._background)}},{key:"backPage",get:function(){var e=this._backPage;return void 0===e?null:e}},{key:"width",get:function(){return this.pageSheet.cells.pageWidth}},{key:"height",get:function(){return this.pageSheet.cells.pageHeight}},{key:"pages",get:function(){return this._pages}},{key:"fileName",get:function(){return dr(/^visio\/pages\/(.*)\.xml$/gm.exec(this.xmlPath),2)[1]}},{key:"fromPaper",value:(t=rr(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,l=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=1<l.length&&void 0!==l[1]?l[1]:{}).exportElement,i=void 0===r?null:r,a=n.exportLink,o=void 0===a?null:a,e.next=3,Ld(t,this,{exportElement:i,exportLink:o});case 3:s=e.sent,this.archive.addEntries(s);case 5:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"printerPaperSize",get:function(){var e=this.pageSheet.cells,t=e.paperKind,n=e.printPageOrientation,r=this.constructor.getPrinterPaperSize(t),i=r.width,a=r.height;return 2===n?{width:a,height:i}:{width:i,height:a}}}],[{key:"getPrinterPaperSize",value:function(e){function t(e){return Ia(e,ji.MM)}function n(e){return Ia(e,ji.IN)}switch(e){default:case 0:case 1:case 2:return{width:n(8.5),height:n(11)};case 3:return{width:n(11),height:n(17)};case 4:return{width:n(17),height:n(11)};case 5:return{width:n(8.5),height:n(14)};case 6:return{width:n(5.5),height:n(8.5)};case 7:return{width:n(7.25),height:n(10.5)};case 8:return{width:t(297),height:t(420)};case 9:case 10:return{width:t(210),height:t(297)};case 11:return{width:t(148),height:t(210)};case 12:return{width:t(250),height:t(354)};case 13:return{width:t(182),height:t(257)};case 14:return{width:n(8.5),height:n(13)};case 15:return{width:t(215),height:t(275)};case 16:return{width:n(10),height:n(14)};case 17:return{width:n(11),height:n(17)};case 18:return{width:n(2),height:n(11)};case 19:return{width:n(3.875),height:n(8.875)};case 20:return{width:n(4.125),height:n(9.5)};case 21:return{width:n(4.5),height:n(10.375)};case 22:return{width:n(4),height:n(11)};case 23:return{width:n(5),height:n(11.5)};case 24:return{width:t(917),height:t(1297)};case 25:return{width:t(771),height:t(1090)};case 26:return{width:t(878),height:t(1242)};case 27:return{width:t(110),height:t(220)};case 28:return{width:t(162),height:t(229)};case 29:return{width:t(324),height:t(458)};case 30:return{width:t(229),height:t(324)};case 31:return{width:t(114),height:t(162)};case 32:return{width:t(114),height:t(229)};case 33:return{width:t(250),height:t(353)};case 34:return{width:t(176),height:t(250)};case 35:return{width:t(176),height:t(125)};case 36:return{width:t(110),height:t(230)};case 37:return{width:n(3.875),height:n(7.5)};case 38:return{width:n(3.625),height:n(6.5)};case 39:return{width:n(14.875),height:n(11)};case 40:return{width:n(8.5),height:n(12)};case 41:return{width:n(8.5),height:n(13)};case 42:return{width:t(250),height:t(353)};case 43:return{width:t(100),height:t(148)};case 44:return{width:n(9),height:n(11)};case 45:return{width:n(10),height:n(11)};case 46:return{width:n(15),height:n(11)};case 47:return{width:n(220),height:n(220)};case 50:return{width:n(9),height:n(12)};case 51:return{width:n(9),height:n(15)};case 52:return{width:n(11.69),height:n(18)};case 53:return{width:n(9.27),height:n(12.69)};case 54:return{width:n(8),height:n(11)};case 55:return{width:t(210),height:t(297)};case 56:return{width:n(9),height:n(12)};case 57:return{width:t(227),height:t(356)};case 58:return{width:t(305),height:t(487)};case 59:return{width:n(8.5),height:n(12.69)};case 60:return{width:t(210),height:t(330)};case 61:return{width:t(148),height:t(210)};case 62:return{width:t(182),height:t(257)};case 63:return{width:t(322),height:t(445)};case 64:return{width:t(174),height:t(235)};case 65:return{width:t(201),height:t(276)};case 66:return{width:t(420),height:t(594)};case 67:return{width:t(297),height:t(420)};case 68:return{width:t(322),height:t(445)}}}}]),i}();function Xd(e,t){return jd.apply(this,arguments)}function jd(){return(jd=rr(regeneratorRuntime.mark(function e(t,n){var r,i,a,o,s,l,u,c,h=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=2<h.length&&void 0!==h[2]?h[2]:[],i=Pi.Page,a=r.concat(Os(i,t,r)),e.next=5,nh.call(this,t,i,a);case 5:return o=e.sent,s=n.rels.get(Pi.Page),l=o._rel,u=s.get(l).targetFile.absolutePath,c=new Gd(Zn({archive:this,pages:n,xmlPath:u},o)),e.abrupt("return",c);case 11:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var zd=["shapes"],Yd=function(){lr(r,ys);var n=pr(r);function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set;return ir(this,r),t.add("cells"),t.add("sections"),n.call(this,e,t)}return or(r,[{key:"setAttributes",value:function(e){var t=e.shapes,n=hr(e,zd);gr(ur(r.prototype),"setAttributes",this).call(this,n),t&&this.master.initMasterSubshapes(t,this)}},{key:"cells",get:function(){return this._cells},set:function(e){this._cells=e}},{key:"sections",get:function(){return this._sections},set:function(e){this._sections=e}}]),r}(),Ud=["shapes"],Wd=["id"],Hd=function(){lr(r,jg);var n=pr(r);function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set;return ir(this,r),t.add("cells"),t.add("sections"),t.add("id"),t.add("name"),t.add("icon"),n.call(this,e,t)}return or(r,[{key:"setAttributes",value:function(e){var t=e.shapes,n=hr(e,Ud);gr(ur(r.prototype),"setAttributes",this).call(this,n),n.cells&&this.referenceMasterShapeInsideCellsDeep(this),t&&this.initMasterSubshapes(t,this)}},{key:"setMasterContents",value:function(e){var t=e.shapes;if(1<t.size)this.initMasterSubshapes(t,this);else{var n=yr(t.values())[0],r=n.id,i=hr(n,Wd);this.setAttributes(Zn({masterAndShape:!0,shapeId:r},i)),this.masterContentsSet=!0}}},{key:"initMasterSubshapes",value:function(e,r){var i=this;r.masterShapes||(r.masterShapes=new Map),this.masterShapesMap||(this.masterShapesMap=new Map),e.forEach(function(e,t){var n=new Yd(Zn({archive:i.archive,master:i,masterId:i.id},e));i.referenceMasterShapeInsideCellsDeep(n),r.masterShapes.set(t,n),i.masterShapesMap.set(t,n)})}},{key:"referenceMasterShapeInsideCellsDeep",value:function(t){var n=this;t._cells&&this.referenceMasterShapeInsideCells(t._cells,t),this._sections&&this._sections.forEach(function(e){e.forEach(function(e){e.rows&&e.rows.forEach(function(e){e.cells&&n.referenceMasterShapeInsideCells(e.cells,t)})})})}},{key:"referenceMasterShapeInsideCells",value:function(e,t){e.masterShape=t}},{key:"cells",get:function(){return this._cells},set:function(e){this._cells=e}},{key:"sections",get:function(){return this._sections},set:function(e){this._sections=e}},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"getIconBase64",value:function(){return this._icon&&this._icon.base64?"data:image/png;base64,".concat(this._icon.base64):null}}]),r}(),Jd=function(){lr(i,jg);var t,r=pr(i);function i(e,t){var n;return ir(this,i),(n=r.call(this,e,t)).map=new Map,n}return or(i,[{key:"add",value:function(e){var t=e.id,n=e._rel,r=this.getRelById(n);r.masterId=t;var i=r.targetFile.absolutePath,a=new Hd(Zn({archive:this.archive,masters:this,xmlPath:i,masterContentsSet:!1},e));return this.map.set(t,a),a}},{key:"getRelById",value:function(e){return this.rels.get(Pi.Master).get(e)}},{key:"addIntoById",value:function(e,t){this.map.get(e).setMasterContents(Zn({},t))}},{key:"getIdByPath",value:function(t){var e=yr(this.rels.get(Pi.Master).values()).find(function(e){return e.targetFile.absolutePath===t});return e||wa.log("Unknown master"),e.masterId}},{key:"get",value:function(e){return this.map.get(e)}},{key:"loadMasters",value:(t=rr(regeneratorRuntime.mark(function e(t){var n,r,i,a,o,s,l,u,c,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.archive,r=xr(t.entries()),e.prev=2,r.s();case 4:if((i=r.n()).done){e.next=20;break}if(a=dr(i.value,2),o=a[1],s=o.targetFile.absolutePath,l=this.getIdByPath(s),(u=this.get(l)).masterContentsSet)return e.abrupt("continue",18);e.next=11;break;case 11:return e.next=13,n.getJxonAsync(s);case 13:return c=e.sent,e.next=16,nh.call(n,c,Pi.Master,[],{structurePathEnrichObject:{masterId:l}});case 16:h=e.sent,u.setMasterContents(h);case 18:e.next=4;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(2),r.e(e.t0);case 25:return e.prev=25,r.f(),e.finish(25);case 28:case"end":return e.stop()}},e,this,[[2,22,25,28]])})),function(e){return t.apply(this,arguments)})}]),i}();function qd(){return Kd.apply(this,arguments)}function Kd(){return(Kd=rr(regeneratorRuntime.mark(function e(){var r,i,a,o,s,l,u,c,h,f,p,g,d,v,y,m,S,C,b,k,x,w,P,_,T,A=this,L=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=(r=0<L.length&&void 0!==L[0]?L[0]:{}).topRelationsMap,a=void 0===i?this.topRelationsMap:i,o=r.documentRelationsMap,s=void 0===o?this.documentRelationsMap:o,l=r.getJxonAsync,u=void 0===l?function(){return A.getJxonAsync.apply(A,arguments)}:l,e.next=3,u(Og(a,Mi.document));case 3:return c=e.sent,t=c,n=xi.Main,wi.hasOwnProperty(n)||wa.log('Unknown xmlSchemaKey "'.concat(n,'"'),{jxonTree:t}),n===xi.DrawingML&&t["@xmlns:a"]===wi.DrawingML||n===xi.Theme&&t["@xmlns:vt"]===wi.Theme||(t.hasOwnProperty("@xmlns")&&t["@xmlns"]||wa.log('"@xmlns" attribute not found',{jxonTree:t}),t["@xmlns"]!==wi[n]&&wa.log('Unexpected schema actual: "'.concat(t["@xmlns"],'" ')+'(expected "'.concat(wi[n],'")'))),[Os(Pi.Document,c,[])],this.document=new zg({archive:this}),(h=c[Ni.Colors])&&this.document.setAttributes({colors:mc(h)},new Set([Ki.colors])),e.next=11,nh.call(this,c,Pi.Document,[]);case 11:return f=e.sent,this.document.setAttributes(f),this.document.pageSheet={debug:"dummyPageSheet",cells:this.document.styleSheets.get(0).cells},p=Og(s,Mi.Pages),this.document.pages=new Yg({archive:this,xmlPath:p}),e.next=18,this.document.pages.getRelsMapCachedAsync();case 18:return e.next=20,u(p);case 20:g=e.sent,d=Ka(g.Page),v=xr(d),e.prev=23,v.s();case 25:if((y=v.n()).done){e.next=33;break}return m=y.value,e.next=29,Xd.call(this,m,this.document.pages);case 29:S=e.sent,this.document.pages.add(S);case 31:e.next=25;break;case 33:e.next=38;break;case 35:e.prev=35,e.t0=e.catch(23),v.e(e.t0);case 38:return e.prev=38,v.f(),e.finish(38);case 41:if(C=Og(s,Mi.Masters))return b=this.document.masters=new Jd({archive:this,xmlPath:C}),e.next=46,this.document.masters.getRelsMapCachedAsync();e.next=69;break;case 46:return e.next=48,u(C);case 48:k=e.sent,x=Ka(k.Master),w=xr(x),e.prev=51,w.s();case 53:if((P=w.n()).done){e.next=61;break}return _=P.value,e.next=57,nh.call(this,_,Pi.Master,[]);case 57:T=e.sent,b.add(T);case 59:e.next=53;break;case 61:e.next=66;break;case 63:e.prev=63,e.t1=e.catch(51),w.e(e.t1);case 66:return e.prev=66,w.f(),e.finish(66);case 69:return e.abrupt("return",this.document);case 70:case"end":return e.stop()}var t,n},e,this,[[23,35,38,41],[51,63,66,69]])}))).apply(this,arguments)}var Qd={array:"array",arraybuffer:"arraybuffer",base64:"base64",binarystring:"binarystring",blob:"blob",uint8array:"uint8array"},Zd=function(){function e(){ir(this,e),this.document=null,this.source=null,this.zip=null,this.jxonAsync=null,this.topRelationsMap=null,this.documentRelationsMap=null}var t,n,r,i,a,o,s;return or(e,[{key:"load",value:(s=rr(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof ArrayBuffer)return n=new l,e.next=4,n.loadAsync(t);e.next=18;break;case 4:return r=e.sent,this.source=t,this.zip=r,this.jxonAsync=new Eg(r),e.next=10,Ng.call(this);case 10:return this.topRelationsMap=e.sent,e.next=13,Gg.call(this);case 13:return this.documentRelationsMap=e.sent,e.next=16,qd.call(this);case 16:e.next=19;break;case 18:throw new Error("Not an instance of ArrayBuffer.");case 19:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"getJxonAsync",value:(o=rr(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.jxonAsync.getJxonAsync(t));case 1:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"getImageAsync",value:(a=rr(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.jxonAsync.getImageAsync(t));case 1:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"toVSDX",value:(i=rr(regeneratorRuntime.mark(function e(){var t,n,r,i,a,o,s=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=0<s.length&&void 0!==s[0]?s[0]:{}).type,(i=r=void 0===n?"blob":n)&&Qd[r]&&(a=l.support,(o=a.hasOwnProperty(r))&&a[r]||!o?i=Qd[r]:wa.log('Browser does not support export type: "'.concat(r,'", using Blob as fallback.'))),e.abrupt("return",this.zip.generateAsync(Zn(Zn({},t),{},{type:i})));case 5:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"addEntries",value:function(e){for(var t in e)e.hasOwnProperty(t)&&this.zip.file(t,e[t].content)}}],[{key:"fromURL",value:(r=rr(regeneratorRuntime.mark(function e(i){var a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof i||""===i)throw new Error("Missing parameter");e.next=2;break;case 2:return e.abrupt("return",new Promise(function(n,t){var r=new XMLHttpRequest;r.open("GET",i,!0),r.setRequestHeader("Content-Type","application/vnd-ms-visio.drawing;charset=utf-8"),r.responseType="blob",r.onerror=function(){t(new Error("Failed to load file ".concat(i,", status: ").concat(r.status," (").concat(r.statusText,")")))},r.onload=function(){if(200===r.status){var e=new FileReader;e.onload=function(e){var t=e.target.result;n(a.fromArrayBuffer(t))},e.onerror=function(){t(new Error("Error occurred reading file: ".concat(i)))},e.readAsArrayBuffer(r.response)}else t(new Error("Failed to load file ".concat(i,", status: ").concat(r.status," (").concat(r.statusText,")")))},r.send()}));case 3:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)})},{key:"fromArrayBuffer",value:(n=rr(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new this,e.next=3,n.load(t);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"fromBase64",value:(t=rr(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.fromArrayBuffer(new Uint8Array(yr(atob(t)).map(function(e){return e.charCodeAt(0)}))));case 1:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})}]),e}();var $d={fromPixels:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:ji.IN;switch(void 0!==e&&t||wa.log("Value and target unit type are required to convert a pixel value."),e=Number.parseFloat(e),Number.isNaN(e)&&wa.log("fromPixels requires a numeric value."),t){case ji.IN:case ji.IN_F:case ji.DL:case ji.DP:return Da(e);case ji.DT:case ji.PT:return function(e){return 72*Da(e)}(e);case ji.MM:return Ea(e);case ji.CM:return function(e){return Ea(e)/10}(e);default:return wa.log('Unsupported numeric unit type "'.concat(Fa(t),'" ("').concat(t,'")')),e}},toPixels:Ia,isFontAvailable:Qh},ev={VisioRowType:Ji,VisioSectionType:Ui,VisioCellName:zi,VisioUnitType:ji};e.VisioArchive=Zd,e.VisioConnect=Ec,e.VisioDocument=zg,e.VisioElement=Tc,e.VisioIndexedSection=Gl,e.VisioLink=Ac,e.VisioNamedSection=Xl,e.VisioPage=Gd,e.VisioPageContent=uf,e.VisioPages=Yg,e.VisioRow=Fl,e.VisioSection=Bl,e.VisioShape=Jh,e.VisioSheetObject=bs,e.config=Rs,e.debug=wa,e.types=ev,e.util=$d,Object.defineProperty(e,"__esModule",{value:!0});var tv,nv=["w5kXw4QgPsOiw4c=","wotvwpAYNHA/","wqnDssKBTnMcwr4TOMKxMy8H","wqnDvsKSw4gBwpnDrQ==","wrBhw7pnw48=","w5wcwo7Dv1PDn0DCl8KV","wqrDscKLS3IVwrgTPcKz","w5rCicKJw5zDmVnCm8OlwovCg8Ohw4fDscKPwrEvw7trw63CvsKqPwAYw6XCscOSPsKlw7c6wobCn8KkHHRvwqzCvcKlQldsAsOXwqnDsMK/T8KkNsKtwo/CpiTChDRwEnZgQl/DsMOqwqg1w7JBw5Q1B3dMQsKJwqpzw6ghIMKrw7/CsjJtwqNpw7XDucO5HW8="];tv=nv,function(e){for(;--e;)tv.push(tv.shift())}(219);var rv,iv,av,ov=function(e,t){var n,r=nv[e-=0];if(void 0===ov.kMiqXK){(n=function(){var t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(e){t=window}return t}()).atob||(n.atob=function(e){for(var t,n,r=String(e).replace(/=+$/,""),i="",a=0,o=0;n=r.charAt(o++);~n&&(t=a%4?64*t+n:n,a++%4)&&(i+=String.fromCharCode(255&t>>(-2*a&6))))n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return i});ov.Zzkffu=function(e,t){for(var n,r,i=[],a=0,o="",s="",l=0,u=(e=atob(e)).length;l<u;l++)s+="%"+("00"+e.charCodeAt(l).toString(16)).slice(-2);for(e=decodeURIComponent(s),r=0;r<256;r++)i[r]=r;for(r=0;r<256;r++)a=(a+i[r]+t.charCodeAt(r%t.length))%256,n=i[r],i[r]=i[a],i[a]=n;for(var c=a=r=0;c<e.length;c++)a=(a+i[r=(r+1)%256])%256,n=i[r],i[r]=i[a],i[a]=n,o+=String.fromCharCode(e.charCodeAt(c)^i[(i[r]+i[a])%256]);return o},ov.dxolOO={},ov.kMiqXK=!0}var i=ov.dxolOO[e];return void 0===i?(void 0===ov.qrpUbO&&(ov.qrpUbO=!0),r=ov.Zzkffu(r,t),ov.dxolOO[e]=r):r=i,r};rv=new Date(parseInt(ov("0x0","eup8"))),iv=parseInt(ov("0x4","eup8")),av=ov("0x5","HU9i"),ov("0x3","my^a")!=typeof window&&iv&&!isNaN(iv)&&rv&&!isNaN(rv[ov("0x6","AFFo")]())&&rv[ov("0x1","c$vz")]()+iv-(new Date)[ov("0x7","R$Y(")]()<=0&&window[ov("0x2","x^aI")](av)});